<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FEAT: kernel/geometry/parti_iterative.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">FEAT<span id="projectnumber">&#160;3</span>
   </div>
   <div id="projectbrief">Finite Element Analysis Toolbox</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('parti__iterative_8hpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">parti_iterative.hpp</div></div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// FEAT3: Finite Element Analysis Toolbox, Version 3</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">// Copyright (C) 2010 - 2023 by Stefan Turek &amp; the FEAT group</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">// FEAT3 is released under the GNU General Public License version 3,</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">// see the file &#39;copyright.txt&#39; in the top level directory for details.</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span> </div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#pragma once</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#ifndef KERNEL_GEOMETRY_PARTI_ITERATIVE_HPP</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#define KERNEL_GEOMETRY_PARTI_ITERATIVE_HPP 1</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span> </div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#include &lt;<a class="code" href="base__header_8hpp.html">kernel/base_header.hpp</a>&gt;</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &lt;kernel/adjacency/graph.hpp&gt;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &lt;kernel/geometry/conformal_mesh.hpp&gt;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &lt;<a class="code" href="assertion_8hpp.html">kernel/util/assertion.hpp</a>&gt;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &lt;kernel/util/random.hpp&gt;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &lt;kernel/util/dist.hpp&gt;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &lt;kernel/util/mutable_priority_queue.hpp&gt;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &lt;kernel/util/time_stamp.hpp&gt;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span> </div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;list&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span> </div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_f_e_a_t.html">FEAT</a></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span>{</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>  <span class="keyword">namespace </span>Geometry</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>  {</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>    <span class="keyword">namespace </span>Intern</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>    {</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno"><a class="line" href="struct_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_item.html">   29</a></span>      <span class="keyword">struct </span><a class="code hl_struct" href="struct_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_item.html">PartiIterativeItem</a></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>      {</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> patch; <span class="comment">//to which center does this cell belong</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> distance; <span class="comment">//distance to the nearest center</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span> </div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>        <a class="code hl_struct" href="struct_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_item.html">PartiIterativeItem</a>() :</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>          distance(std::numeric_limits&lt;Index&gt;::max())</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>        {</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>        }</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>      };</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span> </div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Shape_, <span class="keywordtype">int</span> num_coords_, <span class="keyword">typename</span> Coord_&gt;</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>        std::vector&lt;Index&gt; parti_iterative_distance(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> start, <a class="code hl_class" href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html">ConformalMesh&lt;Shape_, num_coords_, Coord_&gt;</a> &amp; mesh, <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> num_patches)</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>        {</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>        <span class="keyword">typedef</span> <a class="code hl_class" href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html">ConformalMesh&lt;Shape_, num_coords_, Coord_&gt;</a> MeshType;</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>        <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">int</span> facet_dim = MeshType::shape_dim-1;</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; facet_idx = mesh.template get_index_set&lt;MeshType::shape_dim, facet_dim&gt;();</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>        <span class="comment">// nachbar zu zelle i sind neighbors[i][j] mit j = 0 bis faced_idx.get_num_indices() und neighbors != ~Index(0)</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>        <span class="keyword">auto</span>&amp; neighbors = mesh.<a class="code hl_function" href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html#a4c4399b27dbe97b7be031498c96fe5dd">get_neighbors</a>();</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span> </div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> num_elems(mesh.<a class="code hl_function" href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html#a86fdc99499d0c2c40b8af4ef0acccae1">get_num_elements</a>());</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span> </div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>        <span class="comment">// the list that shall contain our computed distance results</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>        std::vector&lt;Index&gt; distances(num_elems, std::numeric_limits&lt;Index&gt;::max());</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>        distances.at(start) = <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(0);</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>        <span class="comment">// the &#39;queue&#39; of nodes that have not yet been visited</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>        <span class="comment">// the priorities are sorted from max to min, thus we need to use the inverse distance as the key, resulting in the lowest distance being at the front of the queue</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>        <a class="code hl_class" href="class_f_e_a_t_1_1mutable__priority__queue.html">FEAT::mutable_priority_queue&lt;Index, Index&gt;</a> pending_nodes;</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> i(0) ; i &lt; num_elems ; ++i)</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>        {</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>          pending_nodes.insert(i, 0);</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>        }</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>        pending_nodes.update(start, std::numeric_limits&lt;Index&gt;::max());</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span> </div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> exploration_threshold = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#ae63636287332e32875ca28780966a810">Math::max</a>(</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>            <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(<a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a564d69313ee91de438926de491613096">Math::pow</a>(<span class="keywordtype">double</span>(num_elems), <span class="keywordtype">double</span>(1) / <span class="keywordtype">double</span>(MeshType::shape_dim)) + 1),</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>            num_elems / num_patches);</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>        exploration_threshold = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#ae63636287332e32875ca28780966a810">Math::max</a>(exploration_threshold, <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(2));</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span> </div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span> </div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>        <span class="keywordflow">while</span> (pending_nodes.size() &gt; 0)</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>        {</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> next_node = pending_nodes.front_value();</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> next_distance = std::numeric_limits&lt;Index&gt;::max() - pending_nodes.front_key();</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>          <span class="comment">// remove current node from queue of unvisited nodes</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>          pending_nodes.pop();</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>          <span class="comment">//abort exploration if we have already reached a hopefully large enough portion of the mesh</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>          <span class="keywordflow">if</span> (next_distance != std::numeric_limits&lt;Index&gt;::max() &amp;&amp; next_distance &gt; exploration_threshold)</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>          {</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>            <span class="keywordflow">return</span> distances;</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>          }</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span> </div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>          <span class="comment">//update all neighbors</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j(0) ; j &lt; facet_idx.get_num_indices() ; ++j)</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>          {</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>            <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> other_cell(neighbors[next_node][j]);</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>            <span class="comment">//update neighbor cell distance, if neighbor exists and neighbor is in the queue of pending nodes</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>            <span class="keywordflow">if</span> (other_cell != ~<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(0) &amp;&amp; pending_nodes.count(other_cell) &gt; 0)</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>            {</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>              <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> new_distance = distances.at(next_node) + 1;</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>              <span class="keywordflow">if</span> (distances.at(other_cell) &gt; new_distance)</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>              {</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>                distances.at(other_cell) = new_distance;</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>                pending_nodes.update(other_cell, std::numeric_limits&lt;Index&gt;::max() - new_distance);</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>              }</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>            }</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>          }</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>        }</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>        <span class="keywordflow">return</span> distances;</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>      }</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span> </div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Shape_, <span class="keywordtype">int</span> num_coords_, <span class="keyword">typename</span> Coord_&gt;</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html">  101</a></span>      <span class="keyword">class </span><a class="code hl_class" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html">PartiIterativeIndividual</a></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>      {</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>        <span class="keyword">public</span>: <span class="comment">//TODO write getter for cells per rank and make all member variables private</span></div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#acb368a48402a47af1f89174b51436724">  105</a></span><span class="comment"></span>        <span class="keyword">typedef</span> <a class="code hl_class" href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html">ConformalMesh&lt;Shape_, num_coords_, Coord_&gt;</a> <a class="code hl_typedef" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#acb368a48402a47af1f89174b51436724">MeshType</a>;</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a747ac01114bb315c095cbf915080557d">  107</a></span>        <a class="code hl_class" href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html">MeshType</a>&amp; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a747ac01114bb315c095cbf915080557d">_mesh</a>;</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#ac9578182f787f55cbd1e3f001527f4f7">  109</a></span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#ac9578182f787f55cbd1e3f001527f4f7">_num_patches</a>;</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a9fb1720242b28e8b6bbb3677247c7630">  111</a></span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a9fb1720242b28e8b6bbb3677247c7630">_num_elems</a>;</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a25dad35b5a056a554241ded9fc84f491">  113</a></span>        std::vector&lt;std::set&lt;Index&gt;&gt; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a25dad35b5a056a554241ded9fc84f491">_cells_per_patch</a>;</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a61d1a43689ebe18f93ddb0353f0829c8">  115</a></span>        std::set&lt;Index&gt; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a61d1a43689ebe18f93ddb0353f0829c8">_centers</a>;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0761c944ff4250351de69b6185cbe06a">  117</a></span>        std::vector&lt;std::set&lt;Index&gt;&gt; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0761c944ff4250351de69b6185cbe06a">_boundary_cells</a>;</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0d79271c4d0b9630493946c35e2bc7fe">  119</a></span>        std::vector&lt;Index&gt; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0d79271c4d0b9630493946c35e2bc7fe">_patch_per_cell</a>;</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#aa9308c72415e035cc04c22b92ced9006">  121</a></span>        std::vector&lt;Index&gt; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#aa9308c72415e035cc04c22b92ced9006">_boundary_size_per_patch</a>;</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span> </div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>        <span class="keyword">public</span>:</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span> </div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a60260cff122bc637cc2df579d270e26e">  134</a></span>        <span class="keyword">explicit</span> <a class="code hl_function" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a60260cff122bc637cc2df579d270e26e">PartiIterativeIndividual</a>(<a class="code hl_class" href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html">MeshType</a>&amp; mesh, <a class="code hl_class" href="class_f_e_a_t_1_1_random.html">Random</a> &amp; rng, <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> num_patches) :</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a747ac01114bb315c095cbf915080557d">_mesh</a>(mesh),</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#ac9578182f787f55cbd1e3f001527f4f7">_num_patches</a>(num_patches),</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a9fb1720242b28e8b6bbb3677247c7630">_num_elems</a>(mesh.get_num_elements()),</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a25dad35b5a056a554241ded9fc84f491">_cells_per_patch</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#ac9578182f787f55cbd1e3f001527f4f7">_num_patches</a>),</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0761c944ff4250351de69b6185cbe06a">_boundary_cells</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#ac9578182f787f55cbd1e3f001527f4f7">_num_patches</a>),</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0d79271c4d0b9630493946c35e2bc7fe">_patch_per_cell</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a9fb1720242b28e8b6bbb3677247c7630">_num_elems</a>),</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#aa9308c72415e035cc04c22b92ced9006">_boundary_size_per_patch</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#ac9578182f787f55cbd1e3f001527f4f7">_num_patches</a>)</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>        {</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>          <a class="code hl_define" href="assertion_8hpp.html#af5c647b0786db55f57452bfc26726bde">XASSERT</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#ac9578182f787f55cbd1e3f001527f4f7">_num_patches</a> &gt; <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(0));</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>          <a class="code hl_define" href="assertion_8hpp.html#af5c647b0786db55f57452bfc26726bde">XASSERT</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a9fb1720242b28e8b6bbb3677247c7630">_num_elems</a> &gt;= <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#ac9578182f787f55cbd1e3f001527f4f7">_num_patches</a>);</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span> </div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>          <span class="comment">// List of cells with informations regarding the partitioning layout</span></div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>          std::vector&lt;Intern::PartiIterativeItem&gt; items;</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span> </div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>          <span class="keywordtype">bool</span> bad_centers(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>          <span class="keywordflow">while</span> (bad_centers)</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>          {</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>            bad_centers = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>            <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a61d1a43689ebe18f93ddb0353f0829c8">_centers</a>.clear();</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>            items.clear();</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>            items.resize(<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a9fb1720242b28e8b6bbb3677247c7630">_num_elems</a>);</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span> </div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>            <span class="comment">// find randomly num_patches different cells as cluster centers</span></div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>            <span class="keywordflow">while</span>(<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a61d1a43689ebe18f93ddb0353f0829c8">_centers</a>.size() &lt; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#ac9578182f787f55cbd1e3f001527f4f7">_num_patches</a>)</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>            {</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>              <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> cell = rng(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(0), <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a9fb1720242b28e8b6bbb3677247c7630">_num_elems</a> - 1);</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>              <span class="keywordflow">if</span> (<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a61d1a43689ebe18f93ddb0353f0829c8">_centers</a>.count(cell) == 0)</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>                <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a61d1a43689ebe18f93ddb0353f0829c8">_centers</a>.insert(cell);</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>            }</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span> </div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>            <span class="comment">// create distance list from each center and assign items the distance and patch of the nearest center</span></div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>            <span class="keyword">auto</span> center_iterator = <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a61d1a43689ebe18f93ddb0353f0829c8">_centers</a>.begin();</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> patch(0) ; patch &lt; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#ac9578182f787f55cbd1e3f001527f4f7">_num_patches</a> ; ++patch, ++center_iterator)</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>            {</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>              <span class="keyword">auto</span> distance_list = Intern::parti_iterative_distance(*center_iterator, mesh, <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#ac9578182f787f55cbd1e3f001527f4f7">_num_patches</a>);</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>              <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> node(0) ; node &lt; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a9fb1720242b28e8b6bbb3677247c7630">_num_elems</a> ; ++node)</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>              {</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>                <span class="keywordflow">if</span>(distance_list.at(node) &lt; items.at(node).distance)</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>                {</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>                  items.at(node).distance = distance_list.at(node);</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>                  items.at(node).patch = patch;</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>                }</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>              }</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>            }</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span> </div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>            <span class="comment">//check for max uint values in items list, i.e. we did not reach every cell</span></div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> node(0) ; node &lt; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a9fb1720242b28e8b6bbb3677247c7630">_num_elems</a> ; ++node)</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>            {</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>              bad_centers &amp;= (items.at(node).distance == std::numeric_limits&lt;Index&gt;::max());</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>            }</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>          }</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span> </div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>          <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> i(0) ; i &lt; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a9fb1720242b28e8b6bbb3677247c7630">_num_elems</a> ; ++i)</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>          {</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>            <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a25dad35b5a056a554241ded9fc84f491">_cells_per_patch</a>.at(items.at(i).patch).insert(i);</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>          }</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span> </div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>          <span class="comment">//setup cell-&gt;patch mapping</span></div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>          <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> patch(0) ; patch &lt; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#ac9578182f787f55cbd1e3f001527f4f7">_num_patches</a> ; ++patch)</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>          {</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> cell : <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a25dad35b5a056a554241ded9fc84f491">_cells_per_patch</a>.at(patch))</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>            {</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>              <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0d79271c4d0b9630493946c35e2bc7fe">_patch_per_cell</a>.at(cell) = patch;</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>            }</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>          }</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span> </div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span> </div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>          <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">int</span> facet_dim = <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html#a33664d7b2c317f199537dd5e1d76cae9">MeshType::shape_dim</a>-1;</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; facet_idx = mesh.template get_index_set&lt;MeshType::shape_dim, facet_dim&gt;();</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>          <span class="comment">// nachbar zu zelle i sind neighbors[i][j] mit j = 0 bis faced_idx.get_num_indices() und neighbors != ~Index(0)</span></div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>          <span class="keyword">auto</span>&amp; neighbors = mesh.<a class="code hl_function" href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html#a4c4399b27dbe97b7be031498c96fe5dd">get_neighbors</a>();</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span> </div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>          <span class="comment">//setup boundary cells</span></div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>          <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> patch(0) ; patch &lt; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#ac9578182f787f55cbd1e3f001527f4f7">_num_patches</a> ; ++patch)</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>          {</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> cell : <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a25dad35b5a056a554241ded9fc84f491">_cells_per_patch</a>.at(patch))</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>            {</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j(0) ; j &lt; facet_idx.get_num_indices() ; ++j)</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>              {</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>                <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> other_cell(neighbors[cell][j]);</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>                <span class="comment">// if neighbor exists and is not in our own patch</span></div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>                <span class="keywordflow">if</span> (other_cell != ~<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(0) &amp;&amp; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0d79271c4d0b9630493946c35e2bc7fe">_patch_per_cell</a>.at(other_cell) != patch)</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>                {</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>                  <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0761c944ff4250351de69b6185cbe06a">_boundary_cells</a>.at(patch).insert(cell);</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>                }</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>              }</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>            }</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>          }</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span> </div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>          <a class="code hl_function" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a66028afbc5cabaa417815e9aba7a7420">update_boundary_size</a>();</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span> </div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>          <span class="comment">//TODO anzahl nachbar patches fuer fitness noetig ???</span></div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>        }</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span> </div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a50f8bbffd00e3650a9d25b4ff66fb39c">  230</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a50f8bbffd00e3650a9d25b4ff66fb39c">mutate</a>(<a class="code hl_class" href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html">MeshType</a>&amp; mesh, <a class="code hl_class" href="class_f_e_a_t_1_1_random.html">Random</a> &amp; rng, <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> mutation_max)</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>        {</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>          <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">int</span> facet_dim = <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html#a33664d7b2c317f199537dd5e1d76cae9">MeshType::shape_dim</a>-1;</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; facet_idx = mesh.template get_index_set&lt;MeshType::shape_dim, facet_dim&gt;();</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>          <span class="comment">// nachbar zu zelle i sind neighbors[i][j] mit j = 0 bis faced_idx.get_num_indices() und neighbors != ~Index(0)</span></div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>          <span class="keyword">auto</span>&amp; neighbors = mesh.<a class="code hl_function" href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html#a4c4399b27dbe97b7be031498c96fe5dd">get_neighbors</a>();</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span> </div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> mutation_count(0);</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> tries(0);</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>          <span class="comment">//iterate over every cell at the boundaries</span></div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>          <span class="keywordflow">while</span> (tries &lt; 10*mutation_max &amp;&amp; mutation_count &lt; mutation_max)</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>          {</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>            ++tries;</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span> </div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>            <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> patch(rng(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(0), <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#ac9578182f787f55cbd1e3f001527f4f7">_num_patches</a> - 1));</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0761c944ff4250351de69b6185cbe06a">_boundary_cells</a>.at(patch).size() == 0)</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>              <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a25dad35b5a056a554241ded9fc84f491">_cells_per_patch</a>.at(patch).size() == 1)</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>              <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span> </div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>            <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> rng_cell_idx = rng(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(0), <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0761c944ff4250351de69b6185cbe06a">_boundary_cells</a>.at(patch).size() - 1));</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>            <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> counter(0);</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>            <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> cell(*(<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0761c944ff4250351de69b6185cbe06a">_boundary_cells</a>.at(patch).begin()));</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>            <span class="comment">//choose cell randomly from current boundary set</span></div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span><span class="comment"></span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> it(<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0761c944ff4250351de69b6185cbe06a">_boundary_cells</a>.at(patch).begin()) ; counter != rng_cell_idx ; ++counter, ++it)</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>            {</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>              cell = *it;</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>            }</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span> </div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>            <span class="comment">// list of neighbor cells in other patches</span></div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>            std::list&lt;Index&gt; trans_patch_neighbors;</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j(0) ; j &lt; facet_idx.get_num_indices() ; ++j)</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>            {</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>              <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> other_cell(neighbors[cell][j]);</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>              <span class="comment">// if neighbor exists and is not in our own patch</span></div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>              <span class="keywordflow">if</span> (other_cell != ~<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(0) &amp;&amp; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0d79271c4d0b9630493946c35e2bc7fe">_patch_per_cell</a>.at(other_cell) != patch)</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>              {</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>                trans_patch_neighbors.push_back(other_cell);</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>              }</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>            }</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span> </div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>            <span class="comment">//check if any neighbor has a smaller patch</span></div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>            <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> smallest_patch(patch);</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>            <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> smallest_size = <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a25dad35b5a056a554241ded9fc84f491">_cells_per_patch</a>.at(patch).size());</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> neighbor : trans_patch_neighbors)</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>            {</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>              <span class="keywordflow">if</span> (<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a25dad35b5a056a554241ded9fc84f491">_cells_per_patch</a>.at(<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0d79271c4d0b9630493946c35e2bc7fe">_patch_per_cell</a>.at(neighbor)).size() &lt; smallest_size)</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>              {</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>                smallest_size = <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a25dad35b5a056a554241ded9fc84f491">_cells_per_patch</a>.at(<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0d79271c4d0b9630493946c35e2bc7fe">_patch_per_cell</a>.at(neighbor)).size());</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>                smallest_patch = <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0d79271c4d0b9630493946c35e2bc7fe">_patch_per_cell</a>.at(neighbor);</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>              }</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>            }</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span> </div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>            <span class="keywordflow">if</span> (smallest_patch == patch)</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>              <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span> </div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>            <span class="comment">//build up list of neighbors in the same (old) patch</span></div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>            std::list&lt;Index&gt; in_patch_neighbors;</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j(0) ; j &lt; facet_idx.get_num_indices() ; ++j)</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>            {</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>              <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> other_cell(neighbors[cell][j]);</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>              <span class="comment">// if neighbor exists and is in our own patch</span></div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>              <span class="keywordflow">if</span> (other_cell != ~<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(0) &amp;&amp; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0d79271c4d0b9630493946c35e2bc7fe">_patch_per_cell</a>.at(other_cell) == patch)</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>              {</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>                in_patch_neighbors.push_back(other_cell);</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>              }</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>            }</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>            <span class="comment">//check if we would isolate one of our neighbors completly and abort</span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>            <span class="comment">//i.e. our neighbor from the same patch has only us as a link to its patch</span></div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>            <span class="keywordtype">bool</span> neighbor_missing = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> neighbor : in_patch_neighbors)</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>            {</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>              <span class="keywordtype">bool</span> other_neighbor = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j(0) ; j &lt; facet_idx.get_num_indices() ; ++j)</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>              {</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>                <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> other_cell(neighbors[neighbor][j]);</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>                <span class="keywordflow">if</span> (other_cell != ~<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(0) &amp;&amp; other_cell != cell &amp;&amp; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0d79271c4d0b9630493946c35e2bc7fe">_patch_per_cell</a>.at(other_cell) == patch)</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>                {</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>                  other_neighbor = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>                  <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>                }</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>              }</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>              <span class="keywordflow">if</span> (other_neighbor == <span class="keyword">false</span>)</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>                neighbor_missing = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>            }</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>            <span class="keywordflow">if</span> (neighbor_missing)</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>              <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span> </div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>            <span class="comment">//found new patch for our cell, update structures</span></div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>            <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0d79271c4d0b9630493946c35e2bc7fe">_patch_per_cell</a>.at(cell) = smallest_patch;</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>            <a class="code hl_define" href="assertion_8hpp.html#af5c647b0786db55f57452bfc26726bde">XASSERT</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a25dad35b5a056a554241ded9fc84f491">_cells_per_patch</a>.at(patch).count(cell) &gt; 0);</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>            <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a25dad35b5a056a554241ded9fc84f491">_cells_per_patch</a>.at(patch).erase(cell);</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>            <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a25dad35b5a056a554241ded9fc84f491">_cells_per_patch</a>.at(smallest_patch).insert(cell);</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>            <a class="code hl_define" href="assertion_8hpp.html#af5c647b0786db55f57452bfc26726bde">XASSERT</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0761c944ff4250351de69b6185cbe06a">_boundary_cells</a>.at(patch).count(cell) &gt; 0);</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>            <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0761c944ff4250351de69b6185cbe06a">_boundary_cells</a>.at(patch).erase(cell);</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>            <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0761c944ff4250351de69b6185cbe06a">_boundary_cells</a>.at(smallest_patch).insert(cell);</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span> </div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>            <span class="comment">//update neighbor cells in other patch if they loose their boundary property due to our patch switch</span></div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> neighbor : trans_patch_neighbors)</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>            {</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>              <span class="comment">//update only cells in common new patch</span></div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>              <span class="keywordflow">if</span> (<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0d79271c4d0b9630493946c35e2bc7fe">_patch_per_cell</a>.at(neighbor) != smallest_patch)</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span> </div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>              <span class="keywordtype">bool</span> boundary(<span class="keyword">false</span>);</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j(0) ; j &lt; facet_idx.get_num_indices() ; ++j)</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>              {</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>                <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> other_cell(neighbors[neighbor][j]);</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>                <span class="keywordflow">if</span> (other_cell != ~<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(0) &amp;&amp; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0d79271c4d0b9630493946c35e2bc7fe">_patch_per_cell</a>.at(other_cell) != smallest_patch)</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>                {</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>                  boundary = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>                  <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>                }</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>              }</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span> </div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>              <span class="keywordflow">if</span> (! boundary)</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>                <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0761c944ff4250351de69b6185cbe06a">_boundary_cells</a>.at(smallest_patch).erase(neighbor);</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>            }</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span> </div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>            <span class="comment">//update our own patchs neighbors to become a boundary cell</span></div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> neighbor : in_patch_neighbors)</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>            {</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>              <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0761c944ff4250351de69b6185cbe06a">_boundary_cells</a>.at(patch).insert(neighbor);</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>            }</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span> </div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>            <span class="comment">//we mutate successfully</span></div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>            ++mutation_count;</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>          }</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>          <a class="code hl_function" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a66028afbc5cabaa417815e9aba7a7420">update_boundary_size</a>();</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>        }</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span> </div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a66028afbc5cabaa417815e9aba7a7420">  363</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a66028afbc5cabaa417815e9aba7a7420">update_boundary_size</a>()</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>        {</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>          <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">int</span> facet_dim = <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html#a33664d7b2c317f199537dd5e1d76cae9">MeshType::shape_dim</a>-1;</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; facet_idx = <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a747ac01114bb315c095cbf915080557d">_mesh</a>.template get_index_set&lt;MeshType::shape_dim, facet_dim&gt;();</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>          <span class="keyword">auto</span>&amp; neighbors = <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a747ac01114bb315c095cbf915080557d">_mesh</a>.<a class="code hl_function" href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html#a4c4399b27dbe97b7be031498c96fe5dd">get_neighbors</a>();</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span> </div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>          <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> patch(0) ; patch &lt; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#ac9578182f787f55cbd1e3f001527f4f7">_num_patches</a> ; ++patch)</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>          {</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>            <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> sum(0);</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> cell : <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0761c944ff4250351de69b6185cbe06a">_boundary_cells</a>.at(patch))</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>            {</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j(0) ; j &lt; facet_idx.get_num_indices() ; ++j)</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>              {</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>                <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> other_cell(neighbors[cell][j]);</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>                <span class="keywordflow">if</span> (other_cell != ~<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(0) &amp;&amp; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0d79271c4d0b9630493946c35e2bc7fe">_patch_per_cell</a>.at(other_cell) != patch)</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>                {</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>                  ++sum;</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>                }</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>              }</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>            }</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>            <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#aa9308c72415e035cc04c22b92ced9006">_boundary_size_per_patch</a>.at(patch) = sum;</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>          }</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>        }</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span> </div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> get_boundary_size()<span class="keyword"> const</span></div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span><span class="keyword">        </span>{</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> sum(0);</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>          <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> patch(0) ; patch &lt; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#ac9578182f787f55cbd1e3f001527f4f7">_num_patches</a> ; ++patch)</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>          {</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>            sum += get_boundary_size(patch);</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>          }</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>          <span class="keywordflow">return</span> sum;</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>        }</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span> </div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> get_boundary_size(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> patch)<span class="keyword"> const</span></div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span><span class="keyword">        </span>{</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#aa9308c72415e035cc04c22b92ced9006">_boundary_size_per_patch</a>.at(patch);</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>        }</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span> </div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> get_boundary_deviation()<span class="keyword"> const</span></div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span><span class="keyword">        </span>{</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> min(std::numeric_limits&lt;Index&gt;::max());</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> max(0);</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>          <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> patch(0) ; patch &lt; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#ac9578182f787f55cbd1e3f001527f4f7">_num_patches</a> ; ++patch)</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>          {</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>            <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> patches_boundary_size(get_boundary_size(patch));</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>            min = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a737d301e1e32f502778181d09b408407">Math::min</a>(patches_boundary_size, min);</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>            max = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#ae63636287332e32875ca28780966a810">Math::max</a>(patches_boundary_size, max);</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>          }</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>          <span class="keywordflow">return</span> <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#ae63636287332e32875ca28780966a810">max</a> - <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a737d301e1e32f502778181d09b408407">min</a>;</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>        }</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span> </div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> get_cell_deviation()<span class="keyword"> const</span></div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span><span class="keyword">        </span>{</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a737d301e1e32f502778181d09b408407">min</a>(std::numeric_limits&lt;Index&gt;::max());</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#ae63636287332e32875ca28780966a810">max</a>(0);</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>          <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> patch(0) ; patch &lt; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#ac9578182f787f55cbd1e3f001527f4f7">_num_patches</a> ; ++patch)</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>          {</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>            <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a737d301e1e32f502778181d09b408407">min</a> = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a737d301e1e32f502778181d09b408407">Math::min</a>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a25dad35b5a056a554241ded9fc84f491">_cells_per_patch</a>.at(patch).size()), min);</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>            <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#ae63636287332e32875ca28780966a810">max</a> = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#ae63636287332e32875ca28780966a810">Math::max</a>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a25dad35b5a056a554241ded9fc84f491">_cells_per_patch</a>.at(patch).size()), max);</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>          }</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>          <span class="keywordflow">return</span> <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#ae63636287332e32875ca28780966a810">max</a> - <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a737d301e1e32f502778181d09b408407">min</a>;</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>        }</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>      };</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span> </div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T_&gt;</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>      <span class="keywordtype">bool</span> parti_iterative_compare_cell_deviation_simple(<span class="keyword">const</span> T_ &amp; first, <span class="keyword">const</span> T_ &amp; second)</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>      {</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>        <span class="keywordflow">if</span> (first.get_cell_deviation() != second.get_cell_deviation())</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>          <span class="keywordflow">return</span> first.get_cell_deviation() &lt; second.get_cell_deviation();</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (first.get_boundary_deviation() != second.get_boundary_deviation() )</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>          <span class="keywordflow">return</span> first.get_boundary_deviation() &lt; second.get_boundary_deviation();</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>          <span class="keywordflow">return</span> first.get_boundary_size() &lt; second.get_boundary_size();</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>      }</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span> </div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T_&gt;</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>      <span class="keywordtype">bool</span> parti_iterative_compare_cell_deviation(<span class="keyword">const</span> T_ &amp; first, <span class="keyword">const</span> T_ &amp; second)</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>      {</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>        <span class="keywordflow">if</span> (first.get_cell_deviation() != second.get_cell_deviation())</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>          <span class="keywordflow">return</span> first.get_cell_deviation() &lt; second.get_cell_deviation() &amp;&amp; first.get_boundary_size() &lt;= second.get_boundary_size() + 1;</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (first.get_boundary_deviation() != second.get_boundary_deviation() )</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>          <span class="keywordflow">return</span> first.get_boundary_deviation() &lt; second.get_boundary_deviation() &amp;&amp; first.get_boundary_size() &lt;= second.get_boundary_size() + 1;</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>          <span class="keywordflow">return</span> first.get_boundary_size() &lt; second.get_boundary_size();</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>      }</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>    }</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Mesh_&gt;</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative.html">  452</a></span>    <span class="keyword">class </span><a class="code hl_class" href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative.html">PartiIterative</a>;</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span> </div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Shape_, <span class="keywordtype">int</span> num_coords_, <span class="keyword">typename</span> Coord_&gt;</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html">  466</a></span>    <span class="keyword">class </span><a class="code hl_class" href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative.html">PartiIterative</a>&lt;<a class="code hl_class" href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html">ConformalMesh</a>&lt;Shape_, num_coords_, Coord_&gt;&gt;</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>    {</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>      <span class="keyword">private</span>:</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#a4d81a35eda3a71acae7e737238c94da0">  470</a></span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#a4d81a35eda3a71acae7e737238c94da0">_num_elems</a>;</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#a1fa2531f9dc9f7ddb8e77610858b21d5">  472</a></span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#a1fa2531f9dc9f7ddb8e77610858b21d5">_num_ranks</a>;</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#ae2882dd92fb5adb8aeb379cc45ce42d7">  474</a></span>        <span class="keyword">const</span> <a class="code hl_class" href="class_f_e_a_t_1_1_dist_1_1_comm.html">Dist::Comm</a> &amp; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#ae2882dd92fb5adb8aeb379cc45ce42d7">_comm</a>;</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#a9dc0aee3c79f8e005906eccdfa8d1631">  476</a></span>        std::list&lt;Geometry::Intern::PartiIterativeIndividual&lt;Shape_, num_coords_, Coord_&gt;&gt; <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#a9dc0aee3c79f8e005906eccdfa8d1631">_population</a>;</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#a32e53d41c353971fa1793d185c7b3b5f">  478</a></span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> <a class="code hl_variable" href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#a32e53d41c353971fa1793d185c7b3b5f">_num_patches</a>;</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span> </div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>      <span class="keyword">public</span>:</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#a853bc079ab4ad50be0578daa6d3f0b0c">  482</a></span>      <span class="keyword">typedef</span> <a class="code hl_class" href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html">ConformalMesh&lt;Shape_, num_coords_, Coord_&gt;</a> <a class="code hl_typedef" href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#a853bc079ab4ad50be0578daa6d3f0b0c">MeshType</a>;</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span> </div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#a326bd59be905adb62a3a9e9144f80f4b">  499</a></span>      <span class="keyword">explicit</span> <a class="code hl_function" href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#a326bd59be905adb62a3a9e9144f80f4b">PartiIterative</a>(<a class="code hl_class" href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html">MeshType</a>&amp; mesh, <span class="keyword">const</span> <a class="code hl_class" href="class_f_e_a_t_1_1_dist_1_1_comm.html">Dist::Comm</a> &amp; comm, <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> num_patches, <span class="keywordtype">double</span> time_init, <span class="keywordtype">double</span> time_mutate) :</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>        _num_elems(mesh.get_num_elements()),</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>        _num_ranks(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(comm.size())),</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>        _comm(comm),</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>        _num_patches(num_patches)</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>      {</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>        <a class="code hl_typedef" href="class_f_e_a_t_1_1_random.html#a88bd61dd0b3c6bcf6244be6a4792af1b">Random::SeedType</a> seed(<a class="code hl_typedef" href="class_f_e_a_t_1_1_random.html#a88bd61dd0b3c6bcf6244be6a4792af1b">Random::SeedType</a>(time(<span class="keyword">nullptr</span>)));</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>        <a class="code hl_class" href="class_f_e_a_t_1_1_random.html">Random</a> rng(seed + <a class="code hl_typedef" href="class_f_e_a_t_1_1_random.html#a88bd61dd0b3c6bcf6244be6a4792af1b">Random::SeedType</a>(comm.<a class="code hl_function" href="class_f_e_a_t_1_1_dist_1_1_comm.html#ad7da25b2899eeb6824431b778fc16866">rank</a>()));</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span> </div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>        mesh.<a class="code hl_function" href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html#af39adec2ab6113e24d134a21710c23ec">fill_neighbors</a>();</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span> </div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>        {</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>          <a class="code hl_class" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html">Geometry::Intern::PartiIterativeIndividual&lt;Shape_, num_coords_, Coord_&gt;</a> indi(mesh, rng, _num_patches);</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>          _population.push_back(indi);</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>        }</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span> </div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>        <a class="code hl_class" href="class_f_e_a_t_1_1_time_stamp.html">TimeStamp</a> at;</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>        <span class="keywordflow">while</span>(at.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#acf9b99b31a28aab047aa3a5d06400f54">elapsed_now</a>() &lt; time_init)</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>        {</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>          <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> i(0) ; i &lt; 10 ; ++i)</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>          {</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>            <a class="code hl_class" href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html">Geometry::Intern::PartiIterativeIndividual&lt;Shape_, num_coords_, Coord_&gt;</a> indi(mesh, rng, _num_patches);</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>            _population.push_back(indi);</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>          }</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>          _population.sort(Geometry::Intern::parti_iterative_compare_cell_deviation_simple&lt;<span class="keyword">typename</span> <span class="keyword">decltype</span>(_population)::value_type&gt;);</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>          <span class="keywordflow">while</span> (_population.size() &gt; 10)</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>            _population.pop_back();</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>        }</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span> </div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>        <span class="comment">//std::cout&lt;&lt;&quot;pre: &quot;&lt;&lt;_population.back().get_cell_deviation()&lt;&lt;&quot; &quot; &lt;&lt;_population.back().get_boundary_deviation()&lt;&lt;&quot; &quot; &lt;&lt; _population.back().get_boundary_size()&lt;&lt;std::endl;</span></div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span> </div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>        <span class="comment">//mutate each of the 10 individuals and store the top 10 fittest of all in _population</span></div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>        at.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#a0a91ce5a9de136d7db0affac4218cf85">stamp</a>();</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>        <span class="keywordflow">while</span>(at.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#acf9b99b31a28aab047aa3a5d06400f54">elapsed_now</a>() &lt; time_mutate)</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>        {</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>          std::list&lt;<span class="keyword">typename</span> <span class="keyword">decltype</span>(_population)::value_type&gt; mutations;</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>          <span class="keywordflow">for</span> (<span class="keyword">auto</span> it(_population.begin()) ; it != _population.end() ; ++it)</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>          {</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>            <span class="keyword">auto</span> indi(*it);</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>            indi.mutate(mesh, rng, 5);</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>            mutations.push_back(indi);</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>          }</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>          mutations.sort(Geometry::Intern::parti_iterative_compare_cell_deviation&lt;<span class="keyword">typename</span> <span class="keyword">decltype</span>(_population)::value_type&gt;);</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>          _population.merge(mutations, Geometry::Intern::parti_iterative_compare_cell_deviation&lt;<span class="keyword">typename</span> <span class="keyword">decltype</span>(_population)::value_type&gt;);</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>          <span class="keywordflow">while</span> (_population.size() &gt; 20)</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>            _population.pop_back();</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>        }</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span> </div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>        _population.sort(Geometry::Intern::parti_iterative_compare_cell_deviation&lt;<span class="keyword">typename</span> <span class="keyword">decltype</span>(_population)::value_type&gt;);</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>        <span class="keywordflow">while</span> (_population.size() &gt; 1)</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>          _population.pop_back();</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span> </div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>        <span class="comment">//std::cout&lt;&lt;_population.back().get_cell_deviation()&lt;&lt;&quot; &quot; &lt;&lt;_population.back().get_boundary_deviation()&lt;&lt;&quot; &quot; &lt;&lt; _population.back().get_boundary_size()&lt;&lt;std::endl;</span></div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>      }</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span> </div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#ab874cda34ecf50c62612b33940b68b75">  560</a></span>      <a class="code hl_class" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html">Adjacency::Graph</a> <a class="code hl_function" href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#ab874cda34ecf50c62612b33940b68b75">build_elems_at_rank</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>        <span class="keyword">auto</span>&amp; indi = _population.front();</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span> </div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> own_cell_deviation = indi.get_cell_deviation();</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> lowest_cell_deviation(std::numeric_limits&lt;Index&gt;::max());</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> own_boundary_deviation = indi.get_boundary_deviation();</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> lowest_boundary_deviation(std::numeric_limits&lt;Index&gt;::max());</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> own_boundary_size = indi.get_boundary_size();</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> lowest_boundary_size(std::numeric_limits&lt;Index&gt;::max());</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> lowest_rank(0);</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> * all_cell_deviation = <span class="keyword">new</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>[_num_ranks];</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> * all_boundary_deviation = <span class="keyword">new</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>[_num_ranks];</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> * all_boundary_size = <span class="keyword">new</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>[_num_ranks];</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>        _comm.<a class="code hl_function" href="class_f_e_a_t_1_1_dist_1_1_comm.html#ae9173a34ad99f80c73ae7f7a262a63fa">allgather</a>(&amp;own_cell_deviation, 1, all_cell_deviation, 1);</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>        _comm.<a class="code hl_function" href="class_f_e_a_t_1_1_dist_1_1_comm.html#ae9173a34ad99f80c73ae7f7a262a63fa">allgather</a>(&amp;own_boundary_deviation, 1, all_boundary_deviation, 1);</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>        _comm.<a class="code hl_function" href="class_f_e_a_t_1_1_dist_1_1_comm.html#ae9173a34ad99f80c73ae7f7a262a63fa">allgather</a>(&amp;own_boundary_size, 1, all_boundary_size, 1);</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> i(0) ; i &lt; _num_ranks ; ++i)</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>        {</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>          <span class="keywordflow">if</span> (all_cell_deviation[i] &lt; lowest_cell_deviation)</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>          {</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>            lowest_cell_deviation = all_cell_deviation[i];</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>            lowest_boundary_deviation = all_boundary_deviation[i];</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>            lowest_boundary_size = all_boundary_size[i];</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>            lowest_rank = i;</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>          }</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (all_cell_deviation[i] == lowest_cell_deviation &amp;&amp; all_boundary_deviation[i] &lt; lowest_boundary_deviation)</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>          {</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>            lowest_cell_deviation = all_cell_deviation[i];</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>            lowest_boundary_deviation = all_boundary_deviation[i];</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>            lowest_boundary_size = all_boundary_size[i];</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>            lowest_rank = i;</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>          }</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (all_cell_deviation[i] == lowest_cell_deviation &amp;&amp; all_boundary_deviation[i] == lowest_boundary_deviation &amp;&amp; all_boundary_size[i] &lt; lowest_boundary_size)</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>          {</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>            lowest_cell_deviation = all_cell_deviation[i];</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>            lowest_boundary_deviation = all_boundary_deviation[i];</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>            lowest_boundary_size = all_boundary_size[i];</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>            lowest_rank = i;</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>          }</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>        }</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>        <span class="keyword">delete</span>[] all_cell_deviation;</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>        <span class="keyword">delete</span>[] all_boundary_deviation;</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>        <span class="keyword">delete</span>[] all_boundary_size;</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span> </div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>        <span class="keywordtype">int</span> _rank = _comm.<a class="code hl_function" href="class_f_e_a_t_1_1_dist_1_1_comm.html#ad7da25b2899eeb6824431b778fc16866">rank</a>();</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>        <span class="keywordflow">if</span> (_rank == (<span class="keywordtype">int</span>)lowest_rank)</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>        {</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>          <span class="comment">//std::cout&lt;&lt;&quot;selected: &quot; &lt;&lt; _population.front().get_cell_deviation()&lt;&lt;&quot; &quot; &lt;&lt;_population.front().get_boundary_deviation()&lt;&lt;&quot; &quot; &lt;&lt; _population.front().get_boundary_size()&lt;&lt;std::endl;</span></div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>          <a class="code hl_class" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html">Adjacency::Graph</a> graph(_num_patches, _num_elems, _num_elems);</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>* ptr = graph.<a class="code hl_function" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#a8a87e6dd2f0db7f8aa95c2ba2dda2c71">get_domain_ptr</a>();</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>* idx = graph.<a class="code hl_function" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#aa21920504d75a3b75324da3de9ae24b7">get_image_idx</a>();</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span> </div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>          <span class="comment">// build pointer array</span></div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>          ptr[0] = 0;</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>          <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> i(0); i &lt; _num_patches; ++i)</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>          {</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>            ptr[i+1] = <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(indi._cells_per_patch.at(i).size()) + ptr[i];</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>          }</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span> </div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>          <span class="comment">// build index array</span></div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> counter(0);</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>          <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> rank(0) ; rank &lt; _num_patches ; ++rank)</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>          {</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> cell : indi._cells_per_patch.at(rank))</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>            {</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>              idx[counter] = cell;</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>              ++counter;</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>            }</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>          }</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>          _comm.<a class="code hl_function" href="class_f_e_a_t_1_1_dist_1_1_comm.html#a065144405c5833ce42addeef33a4e9ab">bcast</a>(graph.<a class="code hl_function" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#a8a87e6dd2f0db7f8aa95c2ba2dda2c71">get_domain_ptr</a>(), _num_patches + 1, _rank);</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>          _comm.<a class="code hl_function" href="class_f_e_a_t_1_1_dist_1_1_comm.html#a065144405c5833ce42addeef33a4e9ab">bcast</a>(graph.<a class="code hl_function" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#aa21920504d75a3b75324da3de9ae24b7">get_image_idx</a>(), _num_elems, _rank);</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>          <span class="keywordflow">return</span> graph;</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>        }</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>        {</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> * domain_ptr = <span class="keyword">new</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>[_num_patches + 1];</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>          _comm.<a class="code hl_function" href="class_f_e_a_t_1_1_dist_1_1_comm.html#a065144405c5833ce42addeef33a4e9ab">bcast</a>(domain_ptr, _num_patches + 1, (<span class="keywordtype">int</span>)lowest_rank);</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> * image_idx = <span class="keyword">new</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>[_num_elems];</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>          _comm.<a class="code hl_function" href="class_f_e_a_t_1_1_dist_1_1_comm.html#a065144405c5833ce42addeef33a4e9ab">bcast</a>(image_idx, _num_elems, (<span class="keywordtype">int</span>)lowest_rank);</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>          <a class="code hl_class" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html">Adjacency::Graph</a> graph(_num_patches, _num_elems, _num_elems, domain_ptr, image_idx);</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>          <span class="keyword">delete</span>[] domain_ptr;</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>          <span class="keyword">delete</span>[] image_idx;</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>          <span class="keywordflow">return</span> graph;</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>        }</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>      }</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>    }; <span class="comment">// class PartiIterative</span></div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>  } <span class="comment">// namespace Geometry</span></div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>} <span class="comment">// namespace FEAT</span></div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span> </div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span><span class="preprocessor">#endif </span><span class="comment">// KERNEL_GEOMETRY_PARTI_ITERATIVE_HPP</span></div>
<div class="ttc" id="aassertion_8hpp_html"><div class="ttname"><a href="assertion_8hpp.html">assertion.hpp</a></div></div>
<div class="ttc" id="aassertion_8hpp_html_af5c647b0786db55f57452bfc26726bde"><div class="ttname"><a href="assertion_8hpp.html#af5c647b0786db55f57452bfc26726bde">XASSERT</a></div><div class="ttdeci">#define XASSERT(expr)</div><div class="ttdoc">Assertion macro definition.</div><div class="ttdef"><b>Definition:</b> <a href="assertion_8hpp_source.html#l00183">assertion.hpp:183</a></div></div>
<div class="ttc" id="abase__header_8hpp_html"><div class="ttname"><a href="base__header_8hpp.html">base_header.hpp</a></div><div class="ttdoc">FEAT Kernel base header.</div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_adjacency_1_1_graph_html"><div class="ttname"><a href="class_f_e_a_t_1_1_adjacency_1_1_graph.html">FEAT::Adjacency::Graph</a></div><div class="ttdoc">Adjacency Graph implementation.</div><div class="ttdef"><b>Definition:</b> <a href="graph_8hpp_source.html#l00034">graph.hpp:35</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_adjacency_1_1_graph_html_a8a87e6dd2f0db7f8aa95c2ba2dda2c71"><div class="ttname"><a href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#a8a87e6dd2f0db7f8aa95c2ba2dda2c71">FEAT::Adjacency::Graph::get_domain_ptr</a></div><div class="ttdeci">Index * get_domain_ptr()</div><div class="ttdoc">Returns the domain pointer array.</div><div class="ttdef"><b>Definition:</b> <a href="graph_8hpp_source.html#l00342">graph.hpp:342</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_adjacency_1_1_graph_html_aa21920504d75a3b75324da3de9ae24b7"><div class="ttname"><a href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#aa21920504d75a3b75324da3de9ae24b7">FEAT::Adjacency::Graph::get_image_idx</a></div><div class="ttdeci">Index * get_image_idx()</div><div class="ttdoc">Returns the image node index array.</div><div class="ttdef"><b>Definition:</b> <a href="graph_8hpp_source.html#l00357">graph.hpp:357</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_dist_1_1_comm_html"><div class="ttname"><a href="class_f_e_a_t_1_1_dist_1_1_comm.html">FEAT::Dist::Comm</a></div><div class="ttdoc">Communicator class.</div><div class="ttdef"><b>Definition:</b> <a href="dist_8hpp_source.html#l01350">dist.hpp:1351</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_dist_1_1_comm_html_a065144405c5833ce42addeef33a4e9ab"><div class="ttname"><a href="class_f_e_a_t_1_1_dist_1_1_comm.html#a065144405c5833ce42addeef33a4e9ab">FEAT::Dist::Comm::bcast</a></div><div class="ttdeci">void bcast(void *buffer, std::size_t count, const Datatype &amp;datatype, int root) const</div><div class="ttdoc">Blocking broadcast.</div><div class="ttdef"><b>Definition:</b> <a href="dist_8cpp_source.html#l00541">dist.cpp:541</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_dist_1_1_comm_html_ad7da25b2899eeb6824431b778fc16866"><div class="ttname"><a href="class_f_e_a_t_1_1_dist_1_1_comm.html#ad7da25b2899eeb6824431b778fc16866">FEAT::Dist::Comm::rank</a></div><div class="ttdeci">int rank() const</div><div class="ttdoc">Returns the rank of this process in this communicator.</div><div class="ttdef"><b>Definition:</b> <a href="dist_8hpp_source.html#l01496">dist.hpp:1496</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_dist_1_1_comm_html_ae9173a34ad99f80c73ae7f7a262a63fa"><div class="ttname"><a href="class_f_e_a_t_1_1_dist_1_1_comm.html#ae9173a34ad99f80c73ae7f7a262a63fa">FEAT::Dist::Comm::allgather</a></div><div class="ttdeci">void allgather(const void *sendbuf, std::size_t sendcount, const Datatype &amp;sendtype, void *recvbuf, std::size_t recvcount, const Datatype &amp;recvtype) const</div><div class="ttdoc">Blocking gather-to-all.</div><div class="ttdef"><b>Definition:</b> <a href="dist_8cpp_source.html#l00577">dist.cpp:577</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_conformal_mesh_html"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html">FEAT::Geometry::ConformalMesh</a></div><div class="ttdoc">Conformal mesh class template.</div><div class="ttdef"><b>Definition:</b> <a href="conformal__mesh_8hpp_source.html#l00043">conformal_mesh.hpp:44</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_conformal_mesh_html_a33664d7b2c317f199537dd5e1d76cae9"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html#a33664d7b2c317f199537dd5e1d76cae9">FEAT::Geometry::ConformalMesh::shape_dim</a></div><div class="ttdeci">static constexpr int shape_dim</div><div class="ttdoc">shape dimension</div><div class="ttdef"><b>Definition:</b> <a href="conformal__mesh_8hpp_source.html#l00064">conformal_mesh.hpp:64</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_conformal_mesh_html_a4c4399b27dbe97b7be031498c96fe5dd"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html#a4c4399b27dbe97b7be031498c96fe5dd">FEAT::Geometry::ConformalMesh::get_neighbors</a></div><div class="ttdeci">IndexSet&lt; shape_dim, shape_dim-1 &gt;::Type &amp; get_neighbors()</div><div class="ttdef"><b>Definition:</b> <a href="conformal__mesh_8hpp_source.html#l00496">conformal_mesh.hpp:496</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_conformal_mesh_html_a86fdc99499d0c2c40b8af4ef0acccae1"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html#a86fdc99499d0c2c40b8af4ef0acccae1">FEAT::Geometry::ConformalMesh::get_num_elements</a></div><div class="ttdeci">Index get_num_elements() const</div><div class="ttdoc">Returns the number of elements.</div><div class="ttdef"><b>Definition:</b> <a href="conformal__mesh_8hpp_source.html#l00280">conformal_mesh.hpp:280</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_conformal_mesh_html_af39adec2ab6113e24d134a21710c23ec"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html#af39adec2ab6113e24d134a21710c23ec">FEAT::Geometry::ConformalMesh::fill_neighbors</a></div><div class="ttdeci">void fill_neighbors()</div><div class="ttdoc">Fills the neighbor index set.</div><div class="ttdef"><b>Definition:</b> <a href="conformal__mesh_8hpp_source.html#l00482">conformal_mesh.hpp:482</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual_html"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html">FEAT::Geometry::Intern::PartiIterativeIndividual</a></div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00101">parti_iterative.hpp:102</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual_html_a0761c944ff4250351de69b6185cbe06a"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0761c944ff4250351de69b6185cbe06a">FEAT::Geometry::Intern::PartiIterativeIndividual::_boundary_cells</a></div><div class="ttdeci">std::vector&lt; std::set&lt; Index &gt; &gt; _boundary_cells</div><div class="ttdoc">List of boundary cells per patch.</div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00117">parti_iterative.hpp:117</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual_html_a0d79271c4d0b9630493946c35e2bc7fe"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a0d79271c4d0b9630493946c35e2bc7fe">FEAT::Geometry::Intern::PartiIterativeIndividual::_patch_per_cell</a></div><div class="ttdeci">std::vector&lt; Index &gt; _patch_per_cell</div><div class="ttdoc">mapping of cell to patch number</div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00119">parti_iterative.hpp:119</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual_html_a25dad35b5a056a554241ded9fc84f491"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a25dad35b5a056a554241ded9fc84f491">FEAT::Geometry::Intern::PartiIterativeIndividual::_cells_per_patch</a></div><div class="ttdeci">std::vector&lt; std::set&lt; Index &gt; &gt; _cells_per_patch</div><div class="ttdoc">Mapping of patches to cells assigned to each patch.</div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00113">parti_iterative.hpp:113</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual_html_a50f8bbffd00e3650a9d25b4ff66fb39c"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a50f8bbffd00e3650a9d25b4ff66fb39c">FEAT::Geometry::Intern::PartiIterativeIndividual::mutate</a></div><div class="ttdeci">void mutate(MeshType &amp;mesh, Random &amp;rng, Index mutation_max)</div><div class="ttdoc">mutate individuum - let cells switch to smaller patches</div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00230">parti_iterative.hpp:230</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual_html_a60260cff122bc637cc2df579d270e26e"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a60260cff122bc637cc2df579d270e26e">FEAT::Geometry::Intern::PartiIterativeIndividual::PartiIterativeIndividual</a></div><div class="ttdeci">PartiIterativeIndividual(MeshType &amp;mesh, Random &amp;rng, Index num_patches)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00134">parti_iterative.hpp:134</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual_html_a61d1a43689ebe18f93ddb0353f0829c8"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a61d1a43689ebe18f93ddb0353f0829c8">FEAT::Geometry::Intern::PartiIterativeIndividual::_centers</a></div><div class="ttdeci">std::set&lt; Index &gt; _centers</div><div class="ttdoc">List of cluster centers: cell id for each patch.</div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00115">parti_iterative.hpp:115</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual_html_a66028afbc5cabaa417815e9aba7a7420"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a66028afbc5cabaa417815e9aba7a7420">FEAT::Geometry::Intern::PartiIterativeIndividual::update_boundary_size</a></div><div class="ttdeci">void update_boundary_size()</div><div class="ttdoc">update boundary size per patch from _boundary_cells structure</div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00363">parti_iterative.hpp:363</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual_html_a747ac01114bb315c095cbf915080557d"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a747ac01114bb315c095cbf915080557d">FEAT::Geometry::Intern::PartiIterativeIndividual::_mesh</a></div><div class="ttdeci">MeshType &amp; _mesh</div><div class="ttdoc">our mesh</div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00107">parti_iterative.hpp:107</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual_html_a9fb1720242b28e8b6bbb3677247c7630"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#a9fb1720242b28e8b6bbb3677247c7630">FEAT::Geometry::Intern::PartiIterativeIndividual::_num_elems</a></div><div class="ttdeci">const Index _num_elems</div><div class="ttdoc">number of elements in input mesh</div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00111">parti_iterative.hpp:111</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual_html_aa9308c72415e035cc04c22b92ced9006"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#aa9308c72415e035cc04c22b92ced9006">FEAT::Geometry::Intern::PartiIterativeIndividual::_boundary_size_per_patch</a></div><div class="ttdeci">std::vector&lt; Index &gt; _boundary_size_per_patch</div><div class="ttdoc">boundary size per patch, must be updated via update_boundary_size method</div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00121">parti_iterative.hpp:121</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual_html_ac9578182f787f55cbd1e3f001527f4f7"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#ac9578182f787f55cbd1e3f001527f4f7">FEAT::Geometry::Intern::PartiIterativeIndividual::_num_patches</a></div><div class="ttdeci">const Index _num_patches</div><div class="ttdoc">number of desired patches</div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00109">parti_iterative.hpp:109</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual_html_acb368a48402a47af1f89174b51436724"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_individual.html#acb368a48402a47af1f89174b51436724">FEAT::Geometry::Intern::PartiIterativeIndividual::MeshType</a></div><div class="ttdeci">ConformalMesh&lt; Shape_, num_coords_, Coord_ &gt; MeshType</div><div class="ttdoc">our mesh type</div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00105">parti_iterative.hpp:105</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4_html_a1fa2531f9dc9f7ddb8e77610858b21d5"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#a1fa2531f9dc9f7ddb8e77610858b21d5">FEAT::Geometry::PartiIterative&lt; ConformalMesh&lt; Shape_, num_coords_, Coord_ &gt; &gt;::_num_ranks</a></div><div class="ttdeci">const Index _num_ranks</div><div class="ttdoc">number of usable ranks</div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00472">parti_iterative.hpp:472</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4_html_a326bd59be905adb62a3a9e9144f80f4b"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#a326bd59be905adb62a3a9e9144f80f4b">FEAT::Geometry::PartiIterative&lt; ConformalMesh&lt; Shape_, num_coords_, Coord_ &gt; &gt;::PartiIterative</a></div><div class="ttdeci">PartiIterative(MeshType &amp;mesh, const Dist::Comm &amp;comm, Index num_patches, double time_init, double time_mutate)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00499">parti_iterative.hpp:499</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4_html_a32e53d41c353971fa1793d185c7b3b5f"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#a32e53d41c353971fa1793d185c7b3b5f">FEAT::Geometry::PartiIterative&lt; ConformalMesh&lt; Shape_, num_coords_, Coord_ &gt; &gt;::_num_patches</a></div><div class="ttdeci">const Index _num_patches</div><div class="ttdoc">number of desired patches</div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00478">parti_iterative.hpp:478</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4_html_a4d81a35eda3a71acae7e737238c94da0"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#a4d81a35eda3a71acae7e737238c94da0">FEAT::Geometry::PartiIterative&lt; ConformalMesh&lt; Shape_, num_coords_, Coord_ &gt; &gt;::_num_elems</a></div><div class="ttdeci">const Index _num_elems</div><div class="ttdoc">number of elements in input mesh</div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00470">parti_iterative.hpp:470</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4_html_a853bc079ab4ad50be0578daa6d3f0b0c"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#a853bc079ab4ad50be0578daa6d3f0b0c">FEAT::Geometry::PartiIterative&lt; ConformalMesh&lt; Shape_, num_coords_, Coord_ &gt; &gt;::MeshType</a></div><div class="ttdeci">ConformalMesh&lt; Shape_, num_coords_, Coord_ &gt; MeshType</div><div class="ttdoc">our mesh type</div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00482">parti_iterative.hpp:482</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4_html_a9dc0aee3c79f8e005906eccdfa8d1631"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#a9dc0aee3c79f8e005906eccdfa8d1631">FEAT::Geometry::PartiIterative&lt; ConformalMesh&lt; Shape_, num_coords_, Coord_ &gt; &gt;::_population</a></div><div class="ttdeci">std::list&lt; Geometry::Intern::PartiIterativeIndividual&lt; Shape_, num_coords_, Coord_ &gt; &gt; _population</div><div class="ttdoc">Our population.</div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00476">parti_iterative.hpp:476</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4_html_ab874cda34ecf50c62612b33940b68b75"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#ab874cda34ecf50c62612b33940b68b75">FEAT::Geometry::PartiIterative&lt; ConformalMesh&lt; Shape_, num_coords_, Coord_ &gt; &gt;::build_elems_at_rank</a></div><div class="ttdeci">Adjacency::Graph build_elems_at_rank() const</div><div class="ttdoc">Returns the Elements-at-Rank graph of the partitioning.</div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00560">parti_iterative.hpp:560</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4_html_ae2882dd92fb5adb8aeb379cc45ce42d7"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative_3_01_conformal_mesh_3_01_shape___00_01num__coords___00_01_coord___01_4_01_4.html#ae2882dd92fb5adb8aeb379cc45ce42d7">FEAT::Geometry::PartiIterative&lt; ConformalMesh&lt; Shape_, num_coords_, Coord_ &gt; &gt;::_comm</a></div><div class="ttdeci">const Dist::Comm &amp; _comm</div><div class="ttdoc">Our communicator.</div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00474">parti_iterative.hpp:474</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_parti_iterative_html"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_parti_iterative.html">FEAT::Geometry::PartiIterative</a></div><div class="ttdoc">Iterative-Partitioner class template declaration.</div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00452">parti_iterative.hpp:452</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_random_html"><div class="ttname"><a href="class_f_e_a_t_1_1_random.html">FEAT::Random</a></div><div class="ttdoc">Pseudo-Random Number Generator.</div><div class="ttdef"><b>Definition:</b> <a href="random_8hpp_source.html#l00055">random.hpp:56</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_random_html_a88bd61dd0b3c6bcf6244be6a4792af1b"><div class="ttname"><a href="class_f_e_a_t_1_1_random.html#a88bd61dd0b3c6bcf6244be6a4792af1b">FEAT::Random::SeedType</a></div><div class="ttdeci">std::uint64_t SeedType</div><div class="ttdoc">seed type</div><div class="ttdef"><b>Definition:</b> <a href="random_8hpp_source.html#l00059">random.hpp:59</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_time_stamp_html"><div class="ttname"><a href="class_f_e_a_t_1_1_time_stamp.html">FEAT::TimeStamp</a></div><div class="ttdoc">Time stamp class.</div><div class="ttdef"><b>Definition:</b> <a href="time__stamp_8hpp_source.html#l00055">time_stamp.hpp:56</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_time_stamp_html_a0a91ce5a9de136d7db0affac4218cf85"><div class="ttname"><a href="class_f_e_a_t_1_1_time_stamp.html#a0a91ce5a9de136d7db0affac4218cf85">FEAT::TimeStamp::stamp</a></div><div class="ttdeci">TimeStamp &amp; stamp()</div><div class="ttdoc">Stamps the current time-stamp.</div><div class="ttdef"><b>Definition:</b> <a href="time__stamp_8hpp_source.html#l00081">time_stamp.hpp:81</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_time_stamp_html_acf9b99b31a28aab047aa3a5d06400f54"><div class="ttname"><a href="class_f_e_a_t_1_1_time_stamp.html#acf9b99b31a28aab047aa3a5d06400f54">FEAT::TimeStamp::elapsed_now</a></div><div class="ttdeci">double elapsed_now() const</div><div class="ttdoc">Calculates the time elapsed between the time stamp and now.</div><div class="ttdef"><b>Definition:</b> <a href="time__stamp_8hpp_source.html#l00123">time_stamp.hpp:123</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1mutable__priority__queue_html"><div class="ttname"><a href="class_f_e_a_t_1_1mutable__priority__queue.html">FEAT::mutable_priority_queue</a></div><div class="ttdef"><b>Definition:</b> <a href="mutable__priority__queue_8hpp_source.html#l00055">mutable_priority_queue.hpp:55</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_math_html_a564d69313ee91de438926de491613096"><div class="ttname"><a href="namespace_f_e_a_t_1_1_math.html#a564d69313ee91de438926de491613096">FEAT::Math::pow</a></div><div class="ttdeci">T_ pow(T_ x, T_ y)</div><div class="ttdoc">Returns x raised to the power of y.</div><div class="ttdef"><b>Definition:</b> <a href="math_8hpp_source.html#l00593">math.hpp:593</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_math_html_a737d301e1e32f502778181d09b408407"><div class="ttname"><a href="namespace_f_e_a_t_1_1_math.html#a737d301e1e32f502778181d09b408407">FEAT::Math::min</a></div><div class="ttdeci">T_ min(T_ a, T_ b)</div><div class="ttdoc">Returns the minimum of two values.</div><div class="ttdef"><b>Definition:</b> <a href="math_8hpp_source.html#l00120">math.hpp:120</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_math_html_ae63636287332e32875ca28780966a810"><div class="ttname"><a href="namespace_f_e_a_t_1_1_math.html#ae63636287332e32875ca28780966a810">FEAT::Math::max</a></div><div class="ttdeci">T_ max(T_ a, T_ b)</div><div class="ttdoc">Returns the maximum of two values.</div><div class="ttdef"><b>Definition:</b> <a href="math_8hpp_source.html#l00134">math.hpp:134</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_html"><div class="ttname"><a href="namespace_f_e_a_t.html">FEAT</a></div><div class="ttdoc">FEAT namespace.</div><div class="ttdef"><b>Definition:</b> <a href="adjactor_8hpp_source.html#l00013">adjactor.hpp:14</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_html_aea15318a59381180ea8b771242a3bbe1"><div class="ttname"><a href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">FEAT::Index</a></div><div class="ttdeci">std::uint64_t Index</div><div class="ttdoc">Index data type.</div><div class="ttdef"><b>Definition:</b> <a href="base__header_8hpp_source.html#l00118">base_header.hpp:118</a></div></div>
<div class="ttc" id="astruct_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_item_html"><div class="ttname"><a href="struct_f_e_a_t_1_1_geometry_1_1_intern_1_1_parti_iterative_item.html">FEAT::Geometry::Intern::PartiIterativeItem</a></div><div class="ttdef"><b>Definition:</b> <a href="parti__iterative_8hpp_source.html#l00029">parti_iterative.hpp:30</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_dc43877d82dd332f9fb2071fcca799d6.html">kernel</a></li><li class="navelem"><a class="el" href="dir_db5a6010996256d141ba9905bf0e6601.html">geometry</a></li><li class="navelem"><b>parti_iterative.hpp</b></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>

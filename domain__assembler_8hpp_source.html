<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FEAT: kernel/assembly/domain_assembler.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">FEAT<span id="projectnumber">&#160;3</span>
   </div>
   <div id="projectbrief">Finite Element Analysis Toolbox</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('domain__assembler_8hpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">domain_assembler.hpp</div></div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// FEAT3: Finite Element Analysis Toolbox, Version 3</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">// Copyright (C) 2010 - 2023 by Stefan Turek &amp; the FEAT group</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">// FEAT3 is released under the GNU General Public License version 3,</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">// see the file &#39;copyright.txt&#39; in the top level directory for details.</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span> </div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#pragma once</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#ifndef KERNEL_ASSEMBLY_DOMAIN_ASSEMBLER_HPP</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#define KERNEL_ASSEMBLY_DOMAIN_ASSEMBLER_HPP 1</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span> </div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">// includes, FEAT</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &lt;kernel/assembly/asm_traits.hpp&gt;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &lt;kernel/adjacency/graph.hpp&gt;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &lt;kernel/adjacency/coloring.hpp&gt;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &lt;kernel/util/thread.hpp&gt;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment">// includes, system</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span> </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_f_e_a_t.html">FEAT</a></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>{</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span>  <span class="keyword">namespace </span>Assembly</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span>  {</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno"><a class="line" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0">   31</a></span>    <span class="keyword">enum class</span> <a class="code hl_enumeration" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0">ThreadingStrategy</a></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>    {</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>      <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0a2bd9c0ed00116be1258e0cc66617d7c8">automatic</a> = 0,</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span> </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>      <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0add5c07036f2975ff4bce568b6511d3bc">single</a>,</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span> </div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>      <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0a9442e6482c63def4c35bc13b704c52e2">layered</a>,</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span> </div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>      <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0a3c5097fb5c0edb92db17a1740f6ae4bf">layered_sorted</a>,</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span> </div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>      <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0a028f0749e1b6a005abdfb9a3975d8c32">colored</a></div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    }; <span class="comment">// enum class ThreadingStrategy</span></div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span> </div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span><span class="preprocessor">#ifdef DOXYGEN</span></div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job.html">  169</a></span>    <span class="keyword">class </span><a class="code hl_class" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job.html">DomainAssemblyJob</a></div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>    {</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>    <span class="keyword">public</span>:</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html">  240</a></span>      <span class="keyword">class </span><a class="code hl_class" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html">Task</a></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>      {</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>      <span class="keyword">public</span>:</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#ac46bb91fd5d6dc1421bb283a6ad174ab">  247</a></span>        <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#ac46bb91fd5d6dc1421bb283a6ad174ab">need_scatter</a> = <span class="keyword">true</span> or <span class="keyword">false</span>;</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span> </div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#ad92d9f4174acb3afcd1b2d2863de7f4b">  253</a></span>        <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#ad92d9f4174acb3afcd1b2d2863de7f4b">need_combine</a> = <span class="keyword">true</span> or <span class="keyword">false</span>;</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span> </div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#a720e1b6f35f6999414249ac3f0a23399">  268</a></span>        <span class="keyword">explicit</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#a720e1b6f35f6999414249ac3f0a23399">Task</a>(<a class="code hl_class" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job.html">DomainAssemblyJob</a>&amp; job);</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span> </div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#a8d4786529216d37b6dc44fdcacde9232">  284</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#a8d4786529216d37b6dc44fdcacde9232">prepare</a>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> cell);</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span> </div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#a4d64a2f88bf0f02202465bcc89fa4261">  297</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#a4d64a2f88bf0f02202465bcc89fa4261">assemble</a>();</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span> </div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#abb595bc13b8b96870cf565e60276324f">  316</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#abb595bc13b8b96870cf565e60276324f">scatter</a>();</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span> </div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#a1b1086ca0cde0b36f53977a570dc4ec0">  329</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#a1b1086ca0cde0b36f53977a570dc4ec0">finish</a>();</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span> </div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#a39c463c5d4e1cf69b60ff25791b01d24">  347</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#a39c463c5d4e1cf69b60ff25791b01d24">combine</a>();</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>      }; <span class="comment">// class Task</span></div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>    }; <span class="comment">// class DomainAssemblyJob</span></div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span><span class="preprocessor">#endif </span><span class="comment">// DOXYGEN</span></div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span> </div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Trafo_&gt;</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html">  392</a></span>    <span class="keyword">class </span><a class="code hl_class" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html">DomainAssembler</a></div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>    {</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>    <span class="keyword">public</span>:</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a58d5aa8077dfda5ac492209158fa505a">  396</a></span>      <span class="keyword">typedef</span> Trafo_ <a class="code hl_typedef" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a58d5aa8077dfda5ac492209158fa505a">TrafoType</a>;</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#ac6751d9ac3d3ed696cf232ba936ea7c6">  398</a></span>      <span class="keyword">typedef</span> <span class="keyword">typename</span> TrafoType::MeshType <a class="code hl_typedef" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#ac6751d9ac3d3ed696cf232ba936ea7c6">MeshType</a>;</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a7379d2d7b9c483e5b0858c12b0c8667f">  400</a></span>      <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a7379d2d7b9c483e5b0858c12b0c8667f">shape_dim</a> = MeshType::shape_dim;</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span> </div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html">  408</a></span>      <span class="keyword">class </span><a class="code hl_class" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html">ThreadStats</a></div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>      {</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>      <span class="keyword">public</span>:</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#abc34165675fed90258a75252edd5e994">  412</a></span>        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#abc34165675fed90258a75252edd5e994">micros_total</a>;</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a5e3857c0104fc4e9dd6d0ca768b9f984">  414</a></span>        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a5e3857c0104fc4e9dd6d0ca768b9f984">micros_assemble</a>;</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a4e6c2653407e45f8deb835154fbb9f00">  416</a></span>        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a4e6c2653407e45f8deb835154fbb9f00">micros_wait</a>;</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span> </div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>      <span class="keyword">public</span>:</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>        <a class="code hl_class" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html">ThreadStats</a>() :</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#abc34165675fed90258a75252edd5e994">micros_total</a>(0ll),</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a5e3857c0104fc4e9dd6d0ca768b9f984">micros_assemble</a>(0ll),</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a4e6c2653407e45f8deb835154fbb9f00">micros_wait</a>(0ll)</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>        {</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>        }</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span> </div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>        <span class="keywordtype">void</span> reset()</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>        {</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#abc34165675fed90258a75252edd5e994">micros_total</a> = 0ll;</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a5e3857c0104fc4e9dd6d0ca768b9f984">micros_assemble</a> = 0ll;</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a4e6c2653407e45f8deb835154fbb9f00">micros_wait</a> = 0ll;</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>        }</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span> </div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>        ThreadStats&amp; operator+=(<span class="keyword">const</span> ThreadStats&amp; other)</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>        {</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#abc34165675fed90258a75252edd5e994">micros_total</a>    += other.micros_total;</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a5e3857c0104fc4e9dd6d0ca768b9f984">micros_assemble</a> += other.micros_assemble;</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a4e6c2653407e45f8deb835154fbb9f00">micros_wait</a>     += other.micros_wait;</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>          <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>        }</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>      }; <span class="comment">// class ThreatStats</span></div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span> </div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>    <span class="keyword">protected</span>:</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>      <span class="keyword">class </span>DegreeCompare</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>      {</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>      <span class="keyword">public</span>:</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>        <span class="keyword">const</span> Adjacency::Graph&amp; _graph;</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>        <span class="keyword">explicit</span> DegreeCompare(<span class="keyword">const</span> Adjacency::Graph&amp; graph) : _graph(graph) {}</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>        <span class="keywordtype">bool</span> operator()(Index i, Index j)<span class="keyword"> const </span>{<span class="keywordflow">return</span> _graph.degree(i) &lt; _graph.degree(j);}</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>      }; <span class="comment">// class DegreeCompare</span></div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span><span class="comment"></span> </div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Job_&gt;</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html">  461</a></span>      <span class="keyword">class </span><a class="code hl_class" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html">Worker</a></div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>      {</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>      <span class="keyword">private</span>:</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a5c43ef61662dbdd926992534e980fabb">  465</a></span>        <span class="keyword">typedef</span> <span class="keyword">typename</span> Job_::Task <a class="code hl_typedef" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a5c43ef61662dbdd926992534e980fabb">TaskType</a>;</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a3ebfb66456e82cd06cb78ff2ded7f025">  467</a></span>        Job_&amp; <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a3ebfb66456e82cd06cb78ff2ded7f025">_job</a>;</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a6f45cd82464703d591a0674a338da36f">  469</a></span>        <span class="keyword">const</span> std::size_t <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a6f45cd82464703d591a0674a338da36f">_my_id</a>, _num_workers;</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a41a9c6631a6d102d60d7b7a5843a732c">  471</a></span>        <span class="keyword">const</span> <a class="code hl_enumeration" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0">ThreadingStrategy</a> <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a41a9c6631a6d102d60d7b7a5843a732c">_strategy</a>;</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#ad7858fa7e0b0b2f2cf14fdf013ce562c">  473</a></span>        std::mutex&amp; <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#ad7858fa7e0b0b2f2cf14fdf013ce562c">_thread_mutex</a>;</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a158f6a90654968ec2e376604d2fed531">  475</a></span>        <a class="code hl_class" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html">ThreadStats</a>&amp; <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a158f6a90654968ec2e376604d2fed531">_thread_stats</a>;</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a98363fbb9e28f811af53b2cadbcd2982">  477</a></span>        std::vector&lt;ThreadFence&gt;&amp; <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a98363fbb9e28f811af53b2cadbcd2982">_thread_fences</a>;</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a7cea8a1b49feec96e91097449c38aeff">  479</a></span>        <span class="keyword">const</span> std::vector&lt;Index&gt;&amp; <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a7cea8a1b49feec96e91097449c38aeff">_element_indices</a>;</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a3dd738db616b61bb35ac67a7ba66e840">  481</a></span>        <span class="keyword">const</span> std::vector&lt;Index&gt;&amp; <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a3dd738db616b61bb35ac67a7ba66e840">_color_elements</a>;</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a40f3ec50bbc13b56b2d19547a096a57a">  483</a></span>        <span class="keyword">const</span> std::vector&lt;Index&gt;&amp; <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a40f3ec50bbc13b56b2d19547a096a57a">_layer_elements</a>;</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a33174b5572f53b2ccd7262070fe104a9">  485</a></span>        <span class="keyword">const</span> std::vector&lt;Index&gt;&amp; <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a33174b5572f53b2ccd7262070fe104a9">_thread_layers</a>;</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span> </div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>      <span class="keyword">public</span>:</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a7a3eadfca1c65a7dfd114fc8d66cdfb3">  526</a></span>        <span class="keyword">explicit</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a7a3eadfca1c65a7dfd114fc8d66cdfb3">Worker</a>(Job_&amp; job, std::size_t <span class="keywordtype">id</span>, std::size_t num_workers,</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>          <a class="code hl_enumeration" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0">ThreadingStrategy</a> strategy,</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>          <a class="code hl_class" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html">ThreadStats</a>&amp; thread_stats,</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>          std::mutex&amp; thread_mutex,</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>          std::vector&lt;ThreadFence&gt;&amp; thread_fences,</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>          <span class="keyword">const</span> std::vector&lt;Index&gt;&amp; element_indices,</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>          <span class="keyword">const</span> std::vector&lt;Index&gt;&amp; color_elements,</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>          <span class="keyword">const</span> std::vector&lt;Index&gt;&amp; layer_elements,</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>          <span class="keyword">const</span> std::vector&lt;Index&gt;&amp; thread_layers) :</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a3ebfb66456e82cd06cb78ff2ded7f025">_job</a>(job),</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a6f45cd82464703d591a0674a338da36f">_my_id</a>(id),</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>          _num_workers(num_workers),</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a41a9c6631a6d102d60d7b7a5843a732c">_strategy</a>(strategy),</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#ad7858fa7e0b0b2f2cf14fdf013ce562c">_thread_mutex</a>(thread_mutex),</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a158f6a90654968ec2e376604d2fed531">_thread_stats</a>(thread_stats),</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a98363fbb9e28f811af53b2cadbcd2982">_thread_fences</a>(thread_fences),</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a7cea8a1b49feec96e91097449c38aeff">_element_indices</a>(element_indices),</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a3dd738db616b61bb35ac67a7ba66e840">_color_elements</a>(color_elements),</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a40f3ec50bbc13b56b2d19547a096a57a">_layer_elements</a>(layer_elements),</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a33174b5572f53b2ccd7262070fe104a9">_thread_layers</a>(thread_layers)</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>        {</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>        }</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span> </div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a1d06c26574b4d4ce9f9f4e4a7e43b70f">  550</a></span>        <span class="keyword">virtual</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a1d06c26574b4d4ce9f9f4e4a7e43b70f">~Worker</a>()</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>        {</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>        }</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span> </div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a3790a118b6d01186f38d1795230c2a86">  559</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a3790a118b6d01186f38d1795230c2a86">operator()</a>()</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>        {</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>          <span class="keywordtype">bool</span> okay = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span> </div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>          <a class="code hl_class" href="class_f_e_a_t_1_1_time_stamp.html">TimeStamp</a> stamp_total;</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span> </div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>          <span class="comment">// put everything in a try-catch block</span></div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>          <span class="keywordflow">try</span></div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>          {</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>            <span class="comment">// create the task</span></div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>            std::unique_ptr&lt;TaskType&gt; task(<span class="keyword">new</span> <a class="code hl_typedef" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a5c43ef61662dbdd926992534e980fabb">TaskType</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a3ebfb66456e82cd06cb78ff2ded7f025">_job</a>));</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span> </div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>            <span class="comment">// choose the appropriate work function for this task</span></div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>            <span class="keywordflow">if</span>(this-&gt;_num_workers &lt;= std::size_t(1))</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>            {</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>              <span class="comment">// we only have 1 thread</span></div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>              okay = this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#ac90604b33bbbacc4bcd7b3c4cf7cbf59">_work_single</a>(std::move(task));</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>            }</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!task-&gt;need_scatter)</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>            {</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>              <span class="comment">// we have multiple threads, but the task does not need to scatter</span></div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>              okay = this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a8a1b5dba822d17637b9a672a6b823a74">_work_no_scatter</a>(std::move(task));</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>            }</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(this-&gt;_strategy == <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0a028f0749e1b6a005abdfb9a3975d8c32">ThreadingStrategy::colored</a>)</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>            {</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>              <span class="comment">// multiple threads and colored threading strategy</span></div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>              okay = this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a9f74c65039325a799b41e73b365ba82f">_work_colored</a>(std::move(task));</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>            }</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>            {</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>              <span class="comment">// multiple threads and layered threading strategy</span></div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>              okay = this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a4679d65fa3c031cfd82ddc2f025eaab1">_work_layered</a>(std::move(task));</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>            }</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>          }</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>          <span class="keywordflow">catch</span>(...)</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>          {</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>            okay = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>          }</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span> </div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>          <span class="comment">// if something went wrong, then we&#39;ll notify the master</span></div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>          <span class="comment">// thread by setting our worker thread fence&#39;s status to false.</span></div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>          <span class="keywordflow">if</span>(!okay)</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>          {</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>            this-&gt;_thread_fences.at(this-&gt;_my_id).open(<span class="keyword">false</span>);</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>          }</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span> </div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>          <span class="comment">// update timing statistics</span></div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>          this-&gt;_thread_stats.<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#abc34165675fed90258a75252edd5e994">micros_total</a> += stamp_total.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#af0d1fdd8e82363a860ea7c19f987701e">elapsed_micros_now</a>();</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>        }</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span> </div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>      <span class="keyword">protected</span>:</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#ac90604b33bbbacc4bcd7b3c4cf7cbf59">  618</a></span>        <span class="keywordtype">bool</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#ac90604b33bbbacc4bcd7b3c4cf7cbf59">_work_single</a>(std::unique_ptr&lt;TaskType&gt; task)</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>        {</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>          <a class="code hl_define" href="assertion_8hpp.html#afa48e2beb6db8fae75edc24466481965">XASSERTM</a>(this-&gt;_my_id == std::size_t(0), <span class="stringliteral">&quot;invalid threading strategy&quot;</span>);</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>          <a class="code hl_define" href="assertion_8hpp.html#afa48e2beb6db8fae75edc24466481965">XASSERTM</a>(this-&gt;_num_workers &lt;= std::size_t(1), <span class="stringliteral">&quot;invalid threading strategy&quot;</span>);</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span> </div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> elem_beg = <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(0);</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> elem_end = <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(this-&gt;_element_indices.size());</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span> </div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>          <span class="comment">// create assembly time stamp</span></div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>          <a class="code hl_class" href="class_f_e_a_t_1_1_time_stamp.html">TimeStamp</a> stamp_asm;</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span> </div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>          <span class="comment">// loop over all elements in this thread&#39;s layers</span></div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>          <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> elem(elem_beg); elem &lt; elem_end; ++elem)</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>          {</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>            <span class="comment">// prepare task</span></div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>            task-&gt;prepare(this-&gt;_element_indices.at(elem));</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span> </div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>            <span class="comment">// assemble task</span></div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>            task-&gt;assemble();</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span> </div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>            <span class="comment">// scatter</span></div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>            <span class="keywordflow">if</span>(task-&gt;need_scatter)</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>              task-&gt;scatter();</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span> </div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>            <span class="comment">// finish</span></div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>            task-&gt;finish();</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>          }</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span> </div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>          <span class="comment">// finalize the assembly</span></div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>          <span class="keywordflow">if</span>(task-&gt;need_combine)</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>            task-&gt;combine();</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span> </div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>          <span class="comment">// save elapsed time</span></div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>          this-&gt;_thread_stats.<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a5e3857c0104fc4e9dd6d0ca768b9f984">micros_assemble</a> += stamp_asm.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#af0d1fdd8e82363a860ea7c19f987701e">elapsed_micros_now</a>();</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span> </div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>          <span class="comment">// delete task object</span></div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>          task.reset();</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span> </div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>          <span class="comment">// okay, we&#39;re done here</span></div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>        }</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span> </div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a8a1b5dba822d17637b9a672a6b823a74">  669</a></span>        <span class="keywordtype">bool</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a8a1b5dba822d17637b9a672a6b823a74">_work_no_scatter</a>(std::unique_ptr&lt;TaskType&gt; task)</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>        {</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>          <a class="code hl_define" href="assertion_8hpp.html#afa48e2beb6db8fae75edc24466481965">XASSERTM</a>(this-&gt;_num_workers &gt; std::size_t(1), <span class="stringliteral">&quot;invalid threading strategy&quot;</span>);</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span> </div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> elem_beg = <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(((this-&gt;_my_id-1u) * this-&gt;_element_indices.size()) / this-&gt;_num_workers);</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> elem_end = <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(((this-&gt;_my_id   ) * this-&gt;_element_indices.size()) / this-&gt;_num_workers);</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span> </div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>          <span class="comment">// create assembly time stamp</span></div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>          <a class="code hl_class" href="class_f_e_a_t_1_1_time_stamp.html">TimeStamp</a> stamp_asm, stamp_wait;</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span> </div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>          <span class="comment">// loop over all elements in this thread&#39;s layers</span></div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>          <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> elem(elem_beg); elem &lt; elem_end; ++elem)</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>          {</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>            <span class="comment">// prepare task</span></div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>            task-&gt;prepare(this-&gt;_element_indices.at(elem));</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span> </div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>            <span class="comment">// assemble task</span></div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>            task-&gt;assemble();</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span> </div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>            <span class="comment">// finish</span></div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>            task-&gt;finish();</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>          }</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span> </div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>          <span class="comment">// do we have to combine the assembly?</span></div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>          <span class="keywordflow">if</span>(task-&gt;need_combine)</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>          {</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>            <span class="comment">// start waiting stamp and update assembly time before opening the fence</span></div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>            this-&gt;_thread_stats.<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a5e3857c0104fc4e9dd6d0ca768b9f984">micros_assemble</a> += stamp_wait.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#a0a91ce5a9de136d7db0affac4218cf85">stamp</a>().<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#aa13f6c5955f4b04dc00ff264b9a0f842">elapsed_micros</a>(stamp_asm);</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span> </div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>            <span class="comment">// acquire lock for the thread mutex</span></div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>            std::unique_lock&lt;std::mutex&gt; lock(this-&gt;_thread_mutex);</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span> </div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>            <span class="comment">// start assembly stamp and update waiting time</span></div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>            this-&gt;_thread_stats.<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a4e6c2653407e45f8deb835154fbb9f00">micros_wait</a> += stamp_asm.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#a0a91ce5a9de136d7db0affac4218cf85">stamp</a>().<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#aa13f6c5955f4b04dc00ff264b9a0f842">elapsed_micros</a>(stamp_wait);</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span> </div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>            <span class="comment">// combine the assembly</span></div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>            task-&gt;combine();</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>          }</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span> </div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>          <span class="comment">// save elapsed time</span></div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>          this-&gt;_thread_stats.<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a5e3857c0104fc4e9dd6d0ca768b9f984">micros_assemble</a> += stamp_asm.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#af0d1fdd8e82363a860ea7c19f987701e">elapsed_micros_now</a>();</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span> </div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>          <span class="comment">// delete task object</span></div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>          task.reset();</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span> </div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>          <span class="comment">// okay, we&#39;re done here</span></div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>        }</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span> </div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a4679d65fa3c031cfd82ddc2f025eaab1">  726</a></span>        <span class="keywordtype">bool</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a4679d65fa3c031cfd82ddc2f025eaab1">_work_layered</a>(std::unique_ptr&lt;TaskType&gt; task)</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>        {</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> elem_beg = <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(0);</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> elem_end = <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(this-&gt;_element_indices.size());</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> elem_fence_open = <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">~Index</a>(0);</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> elem_fence_wait = <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">~Index</a>(0);</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span> </div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>          <a class="code hl_class" href="class_f_e_a_t_1_1_time_stamp.html">TimeStamp</a> stamp_asm, stamp_wait;</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span> </div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>          <span class="comment">// multi-threaded assembly ?</span></div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>          <span class="keywordflow">if</span>(this-&gt;_my_id &gt; 0u)</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>          {</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>            <span class="comment">// first and last element for this thread</span></div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>            elem_beg = this-&gt;_layer_elements.at(this-&gt;_thread_layers.at(<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a6f45cd82464703d591a0674a338da36f">_my_id</a>-1));</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>            elem_end = this-&gt;_layer_elements.at(this-&gt;_thread_layers.at(<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a6f45cd82464703d591a0674a338da36f">_my_id</a>));</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span> </div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>            <span class="comment">// last element of first layer: open fence of previous thread</span></div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>            <span class="keywordflow">if</span>(this-&gt;_my_id &gt; 1u)</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>              elem_fence_open = this-&gt;_layer_elements.at(this-&gt;_thread_layers.at(<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a6f45cd82464703d591a0674a338da36f">_my_id</a>-1) + 1u) - 1u;</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span> </div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>            <span class="comment">// first element of last layer: wait for fence of next thread</span></div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>            <span class="keywordflow">if</span>(this-&gt;_my_id &lt; this-&gt;_num_workers)</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>              elem_fence_wait = this-&gt;_layer_elements.at(this-&gt;_thread_layers.at(<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a6f45cd82464703d591a0674a338da36f">_my_id</a>) - 1u);</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span> </div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>            <span class="comment">// make sure that we do not enter a deadlock</span></div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>            <span class="keywordflow">if</span>((elem_fence_open != ~<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(0)) &amp;&amp; (elem_fence_wait != ~<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(0)))</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>            {</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>              <span class="comment">// note that this case should never happen, because it should be prevented</span></div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>              <span class="comment">// by the DomainAssembler::_build_thread_layer() function</span></div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>              <a class="code hl_define" href="assertion_8hpp.html#afa48e2beb6db8fae75edc24466481965">XASSERTM</a>(elem_fence_open &lt; elem_fence_wait, <span class="stringliteral">&quot;potential deadlock detected&quot;</span>);</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>            }</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>          }</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span> </div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>          stamp_wait.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#a0a91ce5a9de136d7db0affac4218cf85">stamp</a>();</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span> </div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>          <span class="comment">// wait for start fence to open</span></div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>          <span class="keywordflow">if</span>(!this-&gt;_thread_fences.front().wait())</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span> </div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>          this-&gt;_thread_stats.<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a4e6c2653407e45f8deb835154fbb9f00">micros_wait</a> += stamp_wait.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#af0d1fdd8e82363a860ea7c19f987701e">elapsed_micros_now</a>();</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span> </div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>          <span class="comment">// start assembly stamp</span></div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>          stamp_asm.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#a0a91ce5a9de136d7db0affac4218cf85">stamp</a>();</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span> </div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>          <span class="comment">// loop over all elements in this thread&#39;s layers</span></div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>          <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> elem(elem_beg); elem &lt; elem_end; ++elem)</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>          {</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>            <span class="comment">// prepare task</span></div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>            task-&gt;prepare(this-&gt;_element_indices.at(elem));</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span> </div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>            <span class="comment">// assemble task</span></div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>            task-&gt;assemble();</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span> </div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>            <span class="comment">// do we have to scatter?</span></div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>            <span class="keywordflow">if</span>(task-&gt;need_scatter)</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>            {</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>              <span class="comment">// first element of last layer?</span></div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>              <span class="keywordflow">if</span>(elem == elem_fence_wait)</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>              {</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>                <span class="comment">// start waiting stamp and update assembly time before waiting for the fence</span></div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>                this-&gt;_thread_stats.<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a5e3857c0104fc4e9dd6d0ca768b9f984">micros_assemble</a> += stamp_wait.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#a0a91ce5a9de136d7db0affac4218cf85">stamp</a>().<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#aa13f6c5955f4b04dc00ff264b9a0f842">elapsed_micros</a>(stamp_asm);</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span> </div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>                <span class="comment">// wait for next thread to finish its first layer</span></div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>                <span class="keywordflow">if</span>(!this-&gt;_thread_fences.at(this-&gt;_my_id+1).wait())</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>                  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span> </div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>                <span class="comment">// start assembly stamp and update waiting time</span></div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>                this-&gt;_thread_stats.<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a4e6c2653407e45f8deb835154fbb9f00">micros_wait</a> += stamp_asm.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#a0a91ce5a9de136d7db0affac4218cf85">stamp</a>().<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#aa13f6c5955f4b04dc00ff264b9a0f842">elapsed_micros</a>(stamp_wait);</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>              }</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span> </div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>              <span class="comment">// perform the scatter</span></div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>              task-&gt;scatter();</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span> </div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>              <span class="comment">// last element of first layer?</span></div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>              <span class="keywordflow">if</span>(elem == elem_fence_open)</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>              {</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>                <span class="comment">// start waiting stamp and update assembly time before opening the fence</span></div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>                this-&gt;_thread_stats.<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a5e3857c0104fc4e9dd6d0ca768b9f984">micros_assemble</a> += stamp_wait.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#a0a91ce5a9de136d7db0affac4218cf85">stamp</a>().<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#aa13f6c5955f4b04dc00ff264b9a0f842">elapsed_micros</a>(stamp_asm);</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span> </div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>                <span class="comment">// signal the previous thread that we have finished our first layer</span></div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>                this-&gt;_thread_fences.at(this-&gt;_my_id).open(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span> </div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>                <span class="comment">// start assembly stamp and update waiting time</span></div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>                this-&gt;_thread_stats.<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a4e6c2653407e45f8deb835154fbb9f00">micros_wait</a> += stamp_asm.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#a0a91ce5a9de136d7db0affac4218cf85">stamp</a>().<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#aa13f6c5955f4b04dc00ff264b9a0f842">elapsed_micros</a>(stamp_wait);</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>              }</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>            }</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span> </div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>            <span class="comment">// finish</span></div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>            task-&gt;finish();</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>          }</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span> </div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>          <span class="comment">// do we have to combine the assembly?</span></div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>          <span class="keywordflow">if</span>(task-&gt;need_combine)</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>          {</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>            <span class="comment">// start waiting stamp and update assembly time before opening the fence</span></div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>            this-&gt;_thread_stats.<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a5e3857c0104fc4e9dd6d0ca768b9f984">micros_assemble</a> += stamp_wait.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#a0a91ce5a9de136d7db0affac4218cf85">stamp</a>().<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#aa13f6c5955f4b04dc00ff264b9a0f842">elapsed_micros</a>(stamp_asm);</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span> </div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>            <span class="comment">// acquire lock for the thread mutex</span></div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>            std::unique_lock&lt;std::mutex&gt; lock(this-&gt;_thread_mutex);</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span> </div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>            <span class="comment">// start assembly stamp and update waiting time</span></div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>            this-&gt;_thread_stats.<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a4e6c2653407e45f8deb835154fbb9f00">micros_wait</a> += stamp_asm.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#a0a91ce5a9de136d7db0affac4218cf85">stamp</a>().<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#aa13f6c5955f4b04dc00ff264b9a0f842">elapsed_micros</a>(stamp_wait);</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span> </div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>            <span class="comment">// combine the assembly</span></div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>            task-&gt;combine();</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>          }</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span> </div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>          <span class="comment">// update assembly time</span></div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>          this-&gt;_thread_stats.<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a5e3857c0104fc4e9dd6d0ca768b9f984">micros_assemble</a> += stamp_asm.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#af0d1fdd8e82363a860ea7c19f987701e">elapsed_micros_now</a>();</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span> </div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>          <span class="comment">// delete task object</span></div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>          task.reset();</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span> </div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>          <span class="comment">// okay, we&#39;re done here</span></div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>        }</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span> </div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a9f74c65039325a799b41e73b365ba82f">  851</a></span>        <span class="keywordtype">bool</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a9f74c65039325a799b41e73b365ba82f">_work_colored</a>(std::unique_ptr&lt;TaskType&gt; task)</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>        {</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>          <a class="code hl_class" href="class_f_e_a_t_1_1_time_stamp.html">TimeStamp</a> stamp_asm, stamp_wait;</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span> </div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>          <span class="comment">// loop over all layers/colors</span></div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>          <span class="keywordflow">for</span>(std::size_t icol(0); icol+1u &lt; this-&gt;_color_elements.size(); ++icol)</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>          {</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>            <span class="comment">// get number of elements for this color</span></div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>            <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> color_offs = this-&gt;_color_elements.at(icol);</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>            <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> color_size = this-&gt;_color_elements.at(icol+1u) - this-&gt;_color_elements.at(icol);</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span> </div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>            <span class="comment">// first/last element to assemble on for this thread</span></div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>            <span class="comment">// note: it is perfectly valid that elem_beg = elem_end if the current color has less</span></div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>            <span class="comment">// elements than there are worker threads available; in this case the corresponding</span></div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>            <span class="comment">// worker threads simply do not assemble anything for this color</span></div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>            <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> elem_beg = <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(0);</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>            <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> elem_end = color_size;</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>            <span class="keywordflow">if</span>(this-&gt;_my_id &gt; 0u)</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>            {</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>              elem_beg = (color_size * <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(this-&gt;_my_id-1)) / <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(this-&gt;_num_workers);</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>              elem_end = (color_size * <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(this-&gt;_my_id  )) / <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(this-&gt;_num_workers);</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>            }</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span> </div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>            <span class="comment">// start waiting stamp and update assembly time before waiting for the fence</span></div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>            this-&gt;_thread_stats.<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a5e3857c0104fc4e9dd6d0ca768b9f984">micros_assemble</a> += stamp_wait.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#a0a91ce5a9de136d7db0affac4218cf85">stamp</a>().<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#aa13f6c5955f4b04dc00ff264b9a0f842">elapsed_micros</a>(stamp_asm);</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span> </div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>            <span class="comment">// wait for start signal</span></div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>            <span class="keywordflow">if</span>(!this-&gt;_thread_fences.front().wait())</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>              <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span> </div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>            <span class="comment">// start assembly stamp and update waiting time</span></div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>            this-&gt;_thread_stats.<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a4e6c2653407e45f8deb835154fbb9f00">micros_wait</a> += stamp_asm.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#a0a91ce5a9de136d7db0affac4218cf85">stamp</a>().<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#aa13f6c5955f4b04dc00ff264b9a0f842">elapsed_micros</a>(stamp_wait);</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span> </div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>            <span class="comment">// loop over all elements</span></div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>            <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> elem(elem_beg); elem &lt; elem_end; ++elem)</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>            {</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>              <span class="comment">// prepare task</span></div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>              task-&gt;prepare(this-&gt;_element_indices.at(color_offs + elem));</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span> </div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>              <span class="comment">// assemble task</span></div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>              task-&gt;assemble();</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span> </div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>              <span class="comment">// scatter</span></div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>              task-&gt;scatter();</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span> </div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>              <span class="comment">// finish</span></div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>              task-&gt;finish();</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>            }</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span> </div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>            <span class="comment">// start waiting stamp and update assembly time before waiting for the fence</span></div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>            this-&gt;_thread_stats.<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a5e3857c0104fc4e9dd6d0ca768b9f984">micros_assemble</a> += stamp_wait.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#a0a91ce5a9de136d7db0affac4218cf85">stamp</a>().<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#aa13f6c5955f4b04dc00ff264b9a0f842">elapsed_micros</a>(stamp_asm);</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span> </div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>            <span class="comment">// notify master that we&#39;re ready</span></div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>            this-&gt;_thread_fences.at(this-&gt;_my_id).open(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span> </div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>            <span class="comment">// wait for end signal</span></div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>            <span class="keywordflow">if</span>(!this-&gt;_thread_fences.back().wait())</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>              <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span> </div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>            <span class="comment">// notify master that we&#39;re ready</span></div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>            this-&gt;_thread_fences.at(this-&gt;_my_id).open(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span> </div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>            <span class="comment">// start assembly stamp and update waiting time</span></div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>            this-&gt;_thread_stats.<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a4e6c2653407e45f8deb835154fbb9f00">micros_wait</a> += stamp_asm.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#a0a91ce5a9de136d7db0affac4218cf85">stamp</a>().<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#aa13f6c5955f4b04dc00ff264b9a0f842">elapsed_micros</a>(stamp_wait);</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>          } <span class="comment">// next color layer</span></div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span> </div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>          <span class="comment">// do we have to combine the assembly?</span></div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>          <span class="keywordflow">if</span>(task-&gt;need_combine)</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>          {</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>            <span class="comment">// start waiting stamp and update assembly time before opening the fence</span></div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>            this-&gt;_thread_stats.<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a5e3857c0104fc4e9dd6d0ca768b9f984">micros_assemble</a> += stamp_wait.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#a0a91ce5a9de136d7db0affac4218cf85">stamp</a>().<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#aa13f6c5955f4b04dc00ff264b9a0f842">elapsed_micros</a>(stamp_asm);</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span> </div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>            <span class="comment">// acquire lock for the thread mutex</span></div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>            std::unique_lock&lt;std::mutex&gt; lock(this-&gt;_thread_mutex);</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span> </div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>            <span class="comment">// start assembly stamp and update waiting time</span></div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>            this-&gt;_thread_stats.<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a4e6c2653407e45f8deb835154fbb9f00">micros_wait</a> += stamp_asm.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#a0a91ce5a9de136d7db0affac4218cf85">stamp</a>().<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#aa13f6c5955f4b04dc00ff264b9a0f842">elapsed_micros</a>(stamp_wait);</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span> </div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>            <span class="comment">// combine the assembly</span></div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>            task-&gt;combine();</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>          }</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span> </div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>          <span class="comment">// update assembly time</span></div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>          this-&gt;_thread_stats.<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a5e3857c0104fc4e9dd6d0ca768b9f984">micros_assemble</a> += stamp_asm.<a class="code hl_function" href="class_f_e_a_t_1_1_time_stamp.html#af0d1fdd8e82363a860ea7c19f987701e">elapsed_micros_now</a>();</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span> </div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>          <span class="comment">// delete task object</span></div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>          task.reset();</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span> </div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>          <span class="comment">// okay</span></div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>        }</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>      }; <span class="comment">// template class Worker&lt;Job_&gt;</span></div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span> </div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>    <span class="keyword">protected</span>:</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a3a9104e680713b95e2c4399a348f4b97">  946</a></span>      <span class="keyword">const</span> <a class="code hl_typedef" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a58d5aa8077dfda5ac492209158fa505a">TrafoType</a>&amp; <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a3a9104e680713b95e2c4399a348f4b97">_trafo</a>;</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#af9c5bc1b90e084fa6676a8ba2adc61e1">  948</a></span>      <a class="code hl_class" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html">Adjacency::Graph</a> <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#af9c5bc1b90e084fa6676a8ba2adc61e1">_verts_at_elem</a>;</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a1a500a4341d701b0f9897c116f81073e">  950</a></span>      <a class="code hl_class" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html">Adjacency::Graph</a> <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a1a500a4341d701b0f9897c116f81073e">_elems_at_vert</a>;</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a047dfbc486082bbf11e5421b4c556a18">  952</a></span>      <a class="code hl_class" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html">Adjacency::Graph</a> <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a047dfbc486082bbf11e5421b4c556a18">_elem_neighbors</a>;</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a32f18bbbbdf44c393f5e0e1a0a1f8c98">  954</a></span>      std::vector&lt;char&gt; <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a32f18bbbbdf44c393f5e0e1a0a1f8c98">_element_mask</a>;</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a02f792b58a245b019acb44ee6c513527">  956</a></span>      std::vector&lt;Index&gt; <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a02f792b58a245b019acb44ee6c513527">_element_indices</a>;</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#aa0ebc9afcf0c675c66ec3ed328faf312">  958</a></span>      std::vector&lt;Index&gt; <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#aa0ebc9afcf0c675c66ec3ed328faf312">_color_elements</a>;</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a82a5b63e7c2d06e6546af610c00c98f6">  960</a></span>      std::vector&lt;Index&gt; <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a82a5b63e7c2d06e6546af610c00c98f6">_layer_elements</a>;</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a24bc437160a8b5f9dc58332c475a68cb">  962</a></span>      std::vector&lt;Index&gt; <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a24bc437160a8b5f9dc58332c475a68cb">_thread_layers</a>;</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a1925bec919cdbc7be597f9a9b94fda9a">  964</a></span>      std::vector&lt;ThreadFence&gt; <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a1925bec919cdbc7be597f9a9b94fda9a">_thread_fences</a>;</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a8096ae609313c8bac0e9b8812563ad91">  966</a></span>      std::vector&lt;ThreadStats&gt; <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a8096ae609313c8bac0e9b8812563ad91">_thread_stats</a>;</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a268f4111b0be792a9518ef480bac8e22">  968</a></span>      std::vector&lt;std::thread&gt; <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a268f4111b0be792a9518ef480bac8e22">_threads</a>;</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a207982e2e27facae34b98565a901ea30">  970</a></span>      std::mutex <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a207982e2e27facae34b98565a901ea30">_thread_mutex</a>;</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a7be4351570f5479fc5122163cc687f70">  972</a></span>      <a class="code hl_enumeration" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0">ThreadingStrategy</a> <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a7be4351570f5479fc5122163cc687f70">_strategy</a>;</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a1d90dc34a47c2ed8248163fcd29f6cb3">  974</a></span>      std::size_t <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a1d90dc34a47c2ed8248163fcd29f6cb3">_max_worker_threads</a>;</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a81e7a1b5e7628c0e2e7d0b4eaf7a83b9">  976</a></span>      std::size_t <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a81e7a1b5e7628c0e2e7d0b4eaf7a83b9">_num_worker_threads</a>;</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a4895550bd235f0b177d44c84d8cdf04a">  978</a></span>      <span class="keywordtype">bool</span> <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a4895550bd235f0b177d44c84d8cdf04a">_compiled</a>;</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span> </div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>    <span class="keyword">public</span>:</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a8d4f46837749d60d6fbffe567543e196">  987</a></span>      <span class="keyword">explicit</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a8d4f46837749d60d6fbffe567543e196">DomainAssembler</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a58d5aa8077dfda5ac492209158fa505a">TrafoType</a>&amp; trafo) :</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a3a9104e680713b95e2c4399a348f4b97">_trafo</a>(trafo),</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#af9c5bc1b90e084fa6676a8ba2adc61e1">_verts_at_elem</a>(),</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a1a500a4341d701b0f9897c116f81073e">_elems_at_vert</a>(),</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a047dfbc486082bbf11e5421b4c556a18">_elem_neighbors</a>(),</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a32f18bbbbdf44c393f5e0e1a0a1f8c98">_element_mask</a>(trafo.get_mesh().get_num_elements(), 0),</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a02f792b58a245b019acb44ee6c513527">_element_indices</a>(),</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#aa0ebc9afcf0c675c66ec3ed328faf312">_color_elements</a>(),</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a82a5b63e7c2d06e6546af610c00c98f6">_layer_elements</a>(),</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a24bc437160a8b5f9dc58332c475a68cb">_thread_layers</a>(),</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a1925bec919cdbc7be597f9a9b94fda9a">_thread_fences</a>(),</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a8096ae609313c8bac0e9b8812563ad91">_thread_stats</a>(),</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a268f4111b0be792a9518ef480bac8e22">_threads</a>(),</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a7be4351570f5479fc5122163cc687f70">_strategy</a>(<a class="code hl_enumeration" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0">ThreadingStrategy</a>::<a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0a2bd9c0ed00116be1258e0cc66617d7c8">automatic</a>),</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a1d90dc34a47c2ed8248163fcd29f6cb3">_max_worker_threads</a>(0),</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a81e7a1b5e7628c0e2e7d0b4eaf7a83b9">_num_worker_threads</a>(0),</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a4895550bd235f0b177d44c84d8cdf04a">_compiled</a>(false)</div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>      {</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>      }</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span> </div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a49735f17652c5b12991d5bffd14da9f2"> 1008</a></span>      <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a49735f17652c5b12991d5bffd14da9f2">DomainAssembler</a>(<span class="keyword">const</span> <a class="code hl_class" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html">DomainAssembler</a>&amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#af05e452fa77c48fdd72852eb91ece17b"> 1010</a></span>      <a class="code hl_class" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html">DomainAssembler</a>&amp; <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#af05e452fa77c48fdd72852eb91ece17b">operator=</a>(<span class="keyword">const</span> <a class="code hl_class" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html">DomainAssembler</a>&amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span> </div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a5abdfd541edf954c3df8e31b316a5fd7"> 1013</a></span>      <span class="keyword">virtual</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a5abdfd541edf954c3df8e31b316a5fd7">~DomainAssembler</a>()</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>      {</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>        <span class="comment">// go on, there&#39;s nothing to see here</span></div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>      }</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span> </div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a55f97addd79e921c65424002aafaf21f"> 1021</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a55f97addd79e921c65424002aafaf21f">clear</a>()</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>      {</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>        <a class="code hl_define" href="assertion_8hpp.html#afa48e2beb6db8fae75edc24466481965">XASSERTM</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a268f4111b0be792a9518ef480bac8e22">_threads</a>.empty(), <span class="stringliteral">&quot;currently executing a job&quot;</span>);</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#af9c5bc1b90e084fa6676a8ba2adc61e1">_verts_at_elem</a>.<a class="code hl_function" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#abe7d5a6fe5422d5015835bfd53cfb633">clear</a>();</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a1a500a4341d701b0f9897c116f81073e">_elems_at_vert</a>.<a class="code hl_function" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#abe7d5a6fe5422d5015835bfd53cfb633">clear</a>();</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a047dfbc486082bbf11e5421b4c556a18">_elem_neighbors</a>.<a class="code hl_function" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#abe7d5a6fe5422d5015835bfd53cfb633">clear</a>();</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a02f792b58a245b019acb44ee6c513527">_element_indices</a>.clear();</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a32f18bbbbdf44c393f5e0e1a0a1f8c98">_element_mask</a>.clear();</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#aa0ebc9afcf0c675c66ec3ed328faf312">_color_elements</a>.clear();</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a82a5b63e7c2d06e6546af610c00c98f6">_layer_elements</a>.clear();</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a24bc437160a8b5f9dc58332c475a68cb">_thread_layers</a>.clear();</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a1925bec919cdbc7be597f9a9b94fda9a">_thread_fences</a>.clear();</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a8096ae609313c8bac0e9b8812563ad91">_thread_stats</a>.clear();</div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a268f4111b0be792a9518ef480bac8e22">_threads</a>.clear();</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a4895550bd235f0b177d44c84d8cdf04a">_compiled</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>      }</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span> </div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a9abfbff531993581e08b9ec03c7ecc90"> 1049</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a9abfbff531993581e08b9ec03c7ecc90">add_element</a>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> ielem)</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>      {</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>        <a class="code hl_define" href="assertion_8hpp.html#afa48e2beb6db8fae75edc24466481965">XASSERTM</a>(!<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a4895550bd235f0b177d44c84d8cdf04a">_compiled</a>, <span class="stringliteral">&quot;assembler has already been compiled!&quot;</span>);</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>        this-&gt;_element_mask.at(ielem) = 1;</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>      }</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span> </div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a9525b6da98a3132c559fae05dbd540ac"> 1066</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a9525b6da98a3132c559fae05dbd540ac">add_mesh_part</a>(<span class="keyword">const</span> <a class="code hl_class" href="class_f_e_a_t_1_1_geometry_1_1_mesh_part.html">Geometry::MeshPart&lt;MeshType&gt;</a>&amp; mesh_part)</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>      {</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>        <a class="code hl_define" href="assertion_8hpp.html#afa48e2beb6db8fae75edc24466481965">XASSERTM</a>(!<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a4895550bd235f0b177d44c84d8cdf04a">_compiled</a>, <span class="stringliteral">&quot;assembler has already been compiled!&quot;</span>);</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; trg = mesh_part.template get_target_set&lt;shape_dim&gt;();</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>        <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> i(0); i &lt; trg.get_num_entities(); ++i)</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>          this-&gt;_element_mask.at(trg[i]) = 1;</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>      }</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span> </div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a8d80c1ac513d3bc2b0a32c06679f4978"> 1077</a></span>      <span class="keyword">const</span> Trafo_&amp; <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a8d80c1ac513d3bc2b0a32c06679f4978">get_trafo</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>        <span class="keywordflow">return</span> this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a3a9104e680713b95e2c4399a348f4b97">_trafo</a>;</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>      }</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span> </div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#af18e3fddef72ae0a2db2cb5b2fd09ce0"> 1085</a></span>      <span class="keyword">const</span> std::vector&lt;Index&gt;&amp; <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#af18e3fddef72ae0a2db2cb5b2fd09ce0">get_element_indices</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>        <span class="keywordflow">return</span> this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a02f792b58a245b019acb44ee6c513527">_element_indices</a>;</div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>      }</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span> </div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a02a036ef4ee28397c32c9e6e2665018a"> 1096</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a02a036ef4ee28397c32c9e6e2665018a">set_max_worker_threads</a>(std::size_t max_worker_threads)</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>      {</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>        <a class="code hl_define" href="assertion_8hpp.html#afa48e2beb6db8fae75edc24466481965">XASSERTM</a>(!<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a4895550bd235f0b177d44c84d8cdf04a">_compiled</a>, <span class="stringliteral">&quot;assembler has already been compiled!&quot;</span>);</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>        this-&gt;_max_worker_threads = max_worker_threads;</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>      }</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span> </div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a64adf5a8939e644040d355c251ac136f"> 1105</a></span>      std::size_t <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a64adf5a8939e644040d355c251ac136f">get_max_worker_threads</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>        <span class="keywordflow">return</span> this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a1d90dc34a47c2ed8248163fcd29f6cb3">_max_worker_threads</a>;</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>      }</div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span> </div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a851cbdb5be8ce9a1de6629f67adbd81b"> 1119</a></span>      std::size_t <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a851cbdb5be8ce9a1de6629f67adbd81b">get_num_worker_threads</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>        <span class="keywordflow">return</span> this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a81e7a1b5e7628c0e2e7d0b4eaf7a83b9">_num_worker_threads</a>;</div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>      }</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span> </div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#af65499e5e7d30e12548b3566cbe85fad"> 1132</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#af65499e5e7d30e12548b3566cbe85fad">set_threading_strategy</a>(<a class="code hl_enumeration" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0">ThreadingStrategy</a> strategy)</div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>      {</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>        <a class="code hl_define" href="assertion_8hpp.html#afa48e2beb6db8fae75edc24466481965">XASSERTM</a>(!<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a4895550bd235f0b177d44c84d8cdf04a">_compiled</a>, <span class="stringliteral">&quot;assembler has already been compiled!&quot;</span>);</div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>        this-&gt;_strategy = strategy;</div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>      }</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span> </div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a60e30df91e8e0332b1825c9e16b12d48"> 1141</a></span>      <a class="code hl_enumeration" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0">ThreadingStrategy</a> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a60e30df91e8e0332b1825c9e16b12d48">get_threading_strategy</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>        <span class="keywordflow">return</span> this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a7be4351570f5479fc5122163cc687f70">_strategy</a>;</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>      }</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span> </div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a55dd100242b5fe0a48515dd949effc19"> 1157</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a55dd100242b5fe0a48515dd949effc19">compile</a>()</div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>      {</div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span>        <a class="code hl_define" href="assertion_8hpp.html#afa48e2beb6db8fae75edc24466481965">XASSERTM</a>(!_compiled, <span class="stringliteral">&quot;assembler has already been compiled!&quot;</span>);</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>        <a class="code hl_define" href="assertion_8hpp.html#af5c647b0786db55f57452bfc26726bde">XASSERT</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a02f792b58a245b019acb44ee6c513527">_element_indices</a>.empty());</div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span> </div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>        <span class="comment">// build element indices from element mask</span></div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> num_elems = this-&gt;_trafo.get_mesh().get_num_elements();</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>        this-&gt;_element_indices.reserve(num_elems);</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>        <span class="keywordflow">for</span>(std::size_t i(0); i &lt; this-&gt;_element_mask.size(); ++i)</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>        {</div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>          <span class="keywordflow">if</span>(this-&gt;_element_mask[i] != 0)</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>          {</div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>            <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a02f792b58a245b019acb44ee6c513527">_element_indices</a>.push_back(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(i));</div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>          }</div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>        }</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span> </div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>        this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a03494c7c14d3a52f06b6d3e4196f0c88">_compile</a>();</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>      }</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span> </div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a57321922a430a9a10c0876e162496edb"> 1182</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a57321922a430a9a10c0876e162496edb">compile_all_elements</a>()</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>      {</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>        <a class="code hl_define" href="assertion_8hpp.html#afa48e2beb6db8fae75edc24466481965">XASSERTM</a>(!_compiled, <span class="stringliteral">&quot;assembler has already been compiled!&quot;</span>);</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>        <a class="code hl_define" href="assertion_8hpp.html#af5c647b0786db55f57452bfc26726bde">XASSERT</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a02f792b58a245b019acb44ee6c513527">_element_indices</a>.empty());</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span> </div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>        <span class="comment">// assemble on all elements</span></div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> num_elems = this-&gt;_trafo.get_mesh().get_num_elements();</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a02f792b58a245b019acb44ee6c513527">_element_indices</a>.resize(num_elems);</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>        <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> i(0); i &lt; num_elems; ++i)</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a02f792b58a245b019acb44ee6c513527">_element_indices</a>[i] = i;</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span> </div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>        this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a03494c7c14d3a52f06b6d3e4196f0c88">_compile</a>();</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>      }</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span> </div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Job_&gt;</div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#acbb6f1a306815a85e5366bda3e1509cf"> 1204</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#acbb6f1a306815a85e5366bda3e1509cf">assemble</a>(Job_&amp; job)</div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>      {</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>        <a class="code hl_define" href="assertion_8hpp.html#afa48e2beb6db8fae75edc24466481965">XASSERTM</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a4895550bd235f0b177d44c84d8cdf04a">_compiled</a>, <span class="stringliteral">&quot;assembler has not been compiled yet&quot;</span>);</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>        <a class="code hl_define" href="assertion_8hpp.html#afa48e2beb6db8fae75edc24466481965">XASSERTM</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a268f4111b0be792a9518ef480bac8e22">_threads</a>.empty(), <span class="stringliteral">&quot;already executing a job&quot;</span>);</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span> </div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>        <span class="comment">// no elements to assemble on?</span></div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>        <span class="keywordflow">if</span>(this-&gt;_element_indices.empty())</div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>          <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span> </div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>        <span class="comment">// no worker threads?</span></div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>        <span class="keywordflow">if</span>(this-&gt;_num_worker_threads &lt;= 0)</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>        {</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>          <span class="comment">// assemble on master thread instead</span></div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>          <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#afa988d856e8d9f676985fec6d2ece92d">assemble_master</a>(job);</div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>          <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>        }</div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span> </div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>        <span class="comment">// reset all fences</span></div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; s : this-&gt;_thread_fences)</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span>          s.close();</div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span> </div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span>        <span class="comment">// create worker threads</span></div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span>        <span class="keywordflow">for</span>(std::size_t i(0); i &lt; this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a81e7a1b5e7628c0e2e7d0b4eaf7a83b9">_num_worker_threads</a>; ++i)</div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span>        {</div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>          <span class="comment">// create worker thread</span></div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a268f4111b0be792a9518ef480bac8e22">_threads</a>.emplace_back(std::thread(<a class="code hl_class" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html">Worker&lt;Job_&gt;</a>(</div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>            job, i+1, this-&gt;_num_worker_threads, this-&gt;_strategy,</div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>            this-&gt;_thread_stats.at(i),</div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>            this-&gt;_thread_mutex,</div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span>            this-&gt;_thread_fences,</div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span>            this-&gt;_element_indices,</div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>            this-&gt;_color_elements,</div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>            this-&gt;_layer_elements,</div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span>            this-&gt;_thread_layers</div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span>          )));</div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span>        }</div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span> </div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span>        <span class="comment">// assemble based on the chosen strategy</span></div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>        <span class="keywordflow">switch</span>(this-&gt;_strategy)</div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>        {</div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0add5c07036f2975ff4bce568b6511d3bc">ThreadingStrategy::single</a>:</div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0a9442e6482c63def4c35bc13b704c52e2">ThreadingStrategy::layered</a>:</div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0a3c5097fb5c0edb92db17a1740f6ae4bf">ThreadingStrategy::layered_sorted</a>:</div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>          <span class="comment">// single/layered assembly is straight forward:</span></div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span>          <span class="comment">// start all threads and wait for them to finish</span></div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>          this-&gt;_thread_fences.front().open(<span class="keyword">true</span>);</div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>          <span class="keywordflow">for</span>(std::size_t i(0); i &lt; this-&gt;_threads.size(); ++i)</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>            this-&gt;_threads.at(i).join();</div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span> </div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0a028f0749e1b6a005abdfb9a3975d8c32">ThreadingStrategy::colored</a>:</div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>          <span class="comment">// colored assembly is significantly more complex:</span></div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>          <span class="comment">// each layer represents a single color and all threads have</span></div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>          <span class="comment">// to traverse the layers simultaneously to avoid race conditions</span></div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>          <span class="keywordflow">for</span>(std::size_t icol(0); icol+1u &lt; this-&gt;_color_elements.size(); ++icol)</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>          {</div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>            <span class="comment">// start threads by opening the front fence</span></div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span>            this-&gt;_thread_fences.front().open(<span class="keyword">true</span>);</div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span> </div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>            <span class="keywordtype">bool</span> all_okay = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span> </div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>            <span class="comment">// wait for all threads to finish</span></div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span>            <span class="keywordflow">for</span>(std::size_t i(0); i &lt; this-&gt;_threads.size(); ++i)</div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>            {</div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>              all_okay = (this-&gt;_thread_fences.at(i+1u).wait() &amp;&amp; all_okay);</div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>              this-&gt;_thread_fences.at(i+1u).close();</div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>            }</div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span> </div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>            <span class="comment">// reset start signal</span></div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>            this-&gt;_thread_fences.front().close();</div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span>            this-&gt;_thread_fences.back().open(all_okay);</div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span> </div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>            <span class="comment">// break out in case of an error</span></div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>            <span class="keywordflow">if</span>(!all_okay)</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span> </div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>            <span class="comment">// wait for all threads to finish</span></div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>            <span class="keywordflow">for</span>(std::size_t i(0); i &lt; this-&gt;_threads.size(); ++i)</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>            {</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>              this-&gt;_thread_fences.at(i+1u).wait();</div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>              this-&gt;_thread_fences.at(i+1u).close();</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>            }</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>            this-&gt;_thread_fences.back().close();</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>          }</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span> </div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>          <span class="comment">// wait for all threads to finish</span></div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>          <span class="keywordflow">for</span>(std::size_t i(0); i &lt; this-&gt;_threads.size(); ++i)</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>            this-&gt;_threads.at(i).join();</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span> </div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>          <a class="code hl_define" href="assertion_8hpp.html#a33180af240360ec61a3968af89731f12">XABORTM</a>(<span class="stringliteral">&quot;invalid threading strategy!&quot;</span>);</div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>        }</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span> </div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span>        <span class="comment">// clear thread vector</span></div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>        this-&gt;_threads.clear();</div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>      }</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span> </div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Job_&gt;</div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#afa988d856e8d9f676985fec6d2ece92d"> 1316</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#afa988d856e8d9f676985fec6d2ece92d">assemble_master</a>(Job_&amp; job)</div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>      {</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span>        <a class="code hl_define" href="assertion_8hpp.html#afa48e2beb6db8fae75edc24466481965">XASSERTM</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a4895550bd235f0b177d44c84d8cdf04a">_compiled</a>, <span class="stringliteral">&quot;assembler has not been compiled yet&quot;</span>);</div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>        <a class="code hl_define" href="assertion_8hpp.html#afa48e2beb6db8fae75edc24466481965">XASSERTM</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a268f4111b0be792a9518ef480bac8e22">_threads</a>.empty(), <span class="stringliteral">&quot;already executing a job&quot;</span>);</div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span> </div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span>        <span class="comment">// no elements to assemble on?</span></div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span>        <span class="keywordflow">if</span>(this-&gt;_element_indices.empty())</div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>          <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span> </div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>        <span class="comment">// reset all fences</span></div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; s : this-&gt;_thread_fences)</div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span>          s.close();</div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span> </div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span>        <span class="comment">// create worker object</span></div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span>        <a class="code hl_class" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html">Worker&lt;Job_&gt;</a> worker(job, 0, 0, this-&gt;_strategy, this-&gt;_thread_stats.front(),</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span>          this-&gt;_thread_mutex, this-&gt;_thread_fences, this-&gt;_element_indices,</div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span>          this-&gt;_color_elements, this-&gt;_layer_elements, this-&gt;_thread_layers);</div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span> </div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span>        <span class="comment">// signal begin</span></div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span>        this-&gt;_thread_fences.front().open(<span class="keyword">true</span>);</div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span>        this-&gt;_thread_fences.back().open(<span class="keyword">true</span>);</div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span> </div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span>        <span class="comment">// perform work</span></div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span>        worker();</div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span>      }</div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span> </div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a87e430ae603e0837c4b60e48a1f16e62"> 1347</a></span>      <a class="code hl_class" href="class_f_e_a_t_1_1_string.html">String</a> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a87e430ae603e0837c4b60e48a1f16e62">dump</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span>        std::ostringstream oss;</div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span> </div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span>        oss &lt;&lt; <span class="stringliteral">&quot;Elements: &quot;</span> &lt;&lt; <a class="code hl_function" href="namespace_f_e_a_t.html#a5eca21c2244b8e23da100b311bcda535">stringify</a>(this-&gt;_element_indices.size()) &lt;&lt; <span class="stringliteral">&quot; of &quot;</span> &lt;&lt;</div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span>          <a class="code hl_function" href="namespace_f_e_a_t.html#a5eca21c2244b8e23da100b311bcda535">stringify</a>(this-&gt;_trafo.get_mesh().get_num_elements()) &lt;&lt; std::endl;</div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span> </div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span>        oss &lt;&lt; <span class="stringliteral">&quot;Strategy: &quot;</span> &lt;&lt; (this-&gt;_strategy == <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0a9442e6482c63def4c35bc13b704c52e2">ThreadingStrategy::layered</a> ? <span class="stringliteral">&quot;layered&quot;</span> : <span class="stringliteral">&quot;colored&quot;</span>) &lt;&lt; std::endl;</div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span> </div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a7be4351570f5479fc5122163cc687f70">_strategy</a> == <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0a9442e6482c63def4c35bc13b704c52e2">ThreadingStrategy::layered</a>)</div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span>        {</div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span>          oss &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Layers:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span>          <span class="keywordflow">for</span>(std::size_t i(0); i+1u &lt; this-&gt;_layer_elements.size(); ++i)</div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span>          {</div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span>            <span class="keyword">auto</span> jb = this-&gt;_layer_elements.at(i);</div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span>            <span class="keyword">auto</span> je = this-&gt;_layer_elements.at(i+1);</div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span>            oss &lt;&lt; <a class="code hl_function" href="namespace_f_e_a_t.html#a5eca21c2244b8e23da100b311bcda535">stringify</a>(i).<a class="code hl_function" href="class_f_e_a_t_1_1_string.html#ac8f44f2b1d8f4c2952538e8639319585">pad_front</a>(3) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span>              &lt;&lt; <a class="code hl_function" href="namespace_f_e_a_t.html#a5eca21c2244b8e23da100b311bcda535">stringify</a>(je - jb).<a class="code hl_function" href="class_f_e_a_t_1_1_string.html#ac8f44f2b1d8f4c2952538e8639319585">pad_front</a>(6)</div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span>              &lt;&lt; std::endl;</div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span>          }</div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span>           oss &lt;&lt; std::endl;</div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span> </div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span>          <span class="keywordtype">double</span> desired = double(this-&gt;_element_indices.size()) / <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#ae63636287332e32875ca28780966a810">Math::max</a>(<span class="keywordtype">double</span>(this-&gt;_num_worker_threads), 1.0);</div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span>          oss &lt;&lt; <span class="stringliteral">&quot;Desired : &quot;</span> &lt;&lt; <a class="code hl_function" href="namespace_f_e_a_t.html#a5eca21c2244b8e23da100b311bcda535">stringify</a>(desired) &lt;&lt; std::endl;</div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>          oss &lt;&lt; <span class="stringliteral">&quot;Threads:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span>          <span class="keywordflow">for</span>(std::size_t i(0); i+1 &lt; this-&gt;_thread_layers.size(); ++i)</div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span>          {</div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span>            <span class="keyword">auto</span> jb = this-&gt;_thread_layers.at(i);</div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span>            <span class="keyword">auto</span> je = this-&gt;_thread_layers.at(i+1);</div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span>            <span class="keyword">auto</span> nel = this-&gt;_layer_elements.at(je) - this-&gt;_layer_elements.at(jb);</div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>            oss &lt;&lt; <a class="code hl_function" href="namespace_f_e_a_t.html#a5eca21c2244b8e23da100b311bcda535">stringify</a>(i).<a class="code hl_function" href="class_f_e_a_t_1_1_string.html#ac8f44f2b1d8f4c2952538e8639319585">pad_front</a>(3) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; <a class="code hl_function" href="namespace_f_e_a_t.html#a5eca21c2244b8e23da100b311bcda535">stringify</a>(je-jb).<a class="code hl_function" href="class_f_e_a_t_1_1_string.html#ac8f44f2b1d8f4c2952538e8639319585">pad_front</a>(4) &lt;&lt; <span class="stringliteral">&quot; : &quot;</span></div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span>              &lt;&lt; <a class="code hl_function" href="namespace_f_e_a_t.html#a5eca21c2244b8e23da100b311bcda535">stringify</a>(nel).<a class="code hl_function" href="class_f_e_a_t_1_1_string.html#ac8f44f2b1d8f4c2952538e8639319585">pad_front</a>(6) &lt;&lt; <span class="stringliteral">&quot; :&quot;</span> &lt;&lt; <a class="code hl_function" href="namespace_f_e_a_t.html#a2f8928fdd8a94e9e3a4971f3231b5e77">stringify_fp_fix</a>(<span class="keywordtype">double</span>(nel) / desired, 3, 6)</div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span>              &lt;&lt; std::endl;</div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span>          }</div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span>        }</div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span>        {</div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span>          oss &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Colors:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span>          <span class="keywordflow">for</span>(std::size_t i(0); i+1u &lt; this-&gt;_color_elements.size(); ++i)</div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>            oss &lt;&lt; <a class="code hl_function" href="namespace_f_e_a_t.html#a5eca21c2244b8e23da100b311bcda535">stringify</a>(i).<a class="code hl_function" href="class_f_e_a_t_1_1_string.html#ac8f44f2b1d8f4c2952538e8639319585">pad_front</a>(3) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span>              &lt;&lt; <a class="code hl_function" href="namespace_f_e_a_t.html#a5eca21c2244b8e23da100b311bcda535">stringify</a>(this-&gt;_color_elements.at(i+1) - this-&gt;_color_elements.at(i)).<a class="code hl_function" href="class_f_e_a_t_1_1_string.html#ac8f44f2b1d8f4c2952538e8639319585">pad_front</a>(6)</div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>              &lt;&lt; std::endl;</div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span>        }</div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span> </div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span>        <span class="keywordflow">return</span> oss.str();</div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span>      }</div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span> </div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#ad0d72b39e71c14e4d3895dea1cf09080"> 1397</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#ad0d72b39e71c14e4d3895dea1cf09080">reset_thread_stats</a>()</div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span>      {</div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; x : this-&gt;_thread_stats)</div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span>          x.reset();</div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span>      }</div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span> </div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a0b4d08f9bf86f081b4eb53176e32ec45"> 1408</a></span>      <a class="code hl_class" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html">ThreadStats</a> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a0b4d08f9bf86f081b4eb53176e32ec45">reduce_thread_stats</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>        <a class="code hl_class" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html">ThreadStats</a> r;</div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; x : this-&gt;_thread_stats)</div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span>          r += x;</div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>        <span class="keywordflow">return</span> r;</div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span>      }</div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span> </div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>    <span class="keyword">protected</span>:</div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a03494c7c14d3a52f06b6d3e4196f0c88"> 1423</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a03494c7c14d3a52f06b6d3e4196f0c88">_compile</a>()</div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span>      {</div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span>        <span class="comment">// nothing to do?</span></div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span>        <span class="keywordflow">if</span>(this-&gt;_element_indices.empty())</div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span>        {</div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a4895550bd235f0b177d44c84d8cdf04a">_compiled</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span>          <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span>        }</div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span> </div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span>        <span class="comment">// choose automatic strategy?</span></div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span>        <span class="keywordflow">if</span>(this-&gt;_strategy == <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0a2bd9c0ed00116be1258e0cc66617d7c8">ThreadingStrategy::automatic</a>)</div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span>        {</div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span>          <span class="comment">// only 1 thread? =&gt; use single-threaded strategy</span></div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span>          <span class="keywordflow">if</span>(this-&gt;_max_worker_threads &lt;= std::size_t(1))</div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"> 1437</span>            this-&gt;_strategy = <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0add5c07036f2975ff4bce568b6511d3bc">ThreadingStrategy::single</a>;</div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span>          <span class="comment">// multi-threaded: is the mesh permuted using colored strategy? =&gt; use colored threading strategy</span></div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span>(this-&gt;_trafo.get_mesh().get_mesh_permutation().get_strategy() == <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_geometry.html#a9a08208ef110199cc9c70de1f8b83de6a028f0749e1b6a005abdfb9a3975d8c32">Geometry::PermutationStrategy::colored</a>)</div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span>            this-&gt;_strategy = <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0a028f0749e1b6a005abdfb9a3975d8c32">ThreadingStrategy::colored</a>;</div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span>          <span class="comment">// multi-threaded: use layered threading strategy</span></div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span>          <span class="keywordflow">else</span></div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span>            this-&gt;_strategy = <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0a9442e6482c63def4c35bc13b704c52e2">ThreadingStrategy::layered</a>;</div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span>        }</div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span> </div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span>        <span class="comment">// do we want multi-threading?</span></div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span>        this-&gt;_num_worker_threads = 0;</div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"> 1448</span>        <span class="keywordflow">if</span>(this-&gt;_max_worker_threads &gt; 0)</div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span>        {</div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"> 1450</span>          <span class="comment">// build the graphs for our element list</span></div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"> 1451</span>          this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a54ce4df37dfd4222766a741f5b849499">_build_graphs</a>();</div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"> 1452</span> </div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span>          <span class="comment">// note that one of the following function calls may set the</span></div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span>          <span class="comment">// _num_worker_threads member variable to zero to disable</span></div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span>          <span class="comment">// multi-threading if there are too few elements available and</span></div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span>          <span class="comment">// therefore multi-threading is pointless or even impossible</span></div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"> 1457</span> </div>
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"> 1458</span>          <span class="comment">// build layers/colors for the threading strategy</span></div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"> 1459</span>          <span class="keywordflow">switch</span>(this-&gt;_strategy)</div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span>          {</div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span>          <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0a9442e6482c63def4c35bc13b704c52e2">ThreadingStrategy::layered</a>:</div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"> 1462</span>            this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a7bb2dc51f98f92bd55b741ed4026371b">_build_layers</a>(<span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"> 1463</span>            this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a6968841ff89919a898e6bb084b8170a0">_build_thread_layers</a>();</div>
<div class="line"><a id="l01464" name="l01464"></a><span class="lineno"> 1464</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01465" name="l01465"></a><span class="lineno"> 1465</span> </div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span>          <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0a3c5097fb5c0edb92db17a1740f6ae4bf">ThreadingStrategy::layered_sorted</a>:</div>
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"> 1467</span>            this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a7bb2dc51f98f92bd55b741ed4026371b">_build_layers</a>(<span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span>            this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a6968841ff89919a898e6bb084b8170a0">_build_thread_layers</a>();</div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span> </div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span>          <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0a028f0749e1b6a005abdfb9a3975d8c32">ThreadingStrategy::colored</a>:</div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span>            this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#af6a72c4c3bb66a01b76419bc0d50a246">_build_colors</a>();</div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01474" name="l01474"></a><span class="lineno"> 1474</span> </div>
<div class="line"><a id="l01475" name="l01475"></a><span class="lineno"> 1475</span>          <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l01476" name="l01476"></a><span class="lineno"> 1476</span>            <span class="comment">// go no, there&#39;s nothing to see here...</span></div>
<div class="line"><a id="l01477" name="l01477"></a><span class="lineno"> 1477</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"> 1478</span>          }</div>
<div class="line"><a id="l01479" name="l01479"></a><span class="lineno"> 1479</span>        }</div>
<div class="line"><a id="l01480" name="l01480"></a><span class="lineno"> 1480</span> </div>
<div class="line"><a id="l01481" name="l01481"></a><span class="lineno"> 1481</span>        <span class="comment">// we need one fence per worker thread and two additional fences</span></div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"> 1482</span>        <span class="comment">// (the first and the last) for the master thread</span></div>
<div class="line"><a id="l01483" name="l01483"></a><span class="lineno"> 1483</span>        _thread_fences = std::vector&lt;ThreadFence&gt;(this-&gt;_num_worker_threads + 2u);</div>
<div class="line"><a id="l01484" name="l01484"></a><span class="lineno"> 1484</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a268f4111b0be792a9518ef480bac8e22">_threads</a>.reserve(std::size_t(this-&gt;_num_worker_threads));</div>
<div class="line"><a id="l01485" name="l01485"></a><span class="lineno"> 1485</span> </div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"> 1486</span>        <span class="comment">// stats are reserved for the maximum desired number of threads</span></div>
<div class="line"><a id="l01487" name="l01487"></a><span class="lineno"> 1487</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a8096ae609313c8bac0e9b8812563ad91">_thread_stats</a> = std::vector&lt;ThreadStats&gt;(this-&gt;_max_worker_threads + 1u);</div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span> </div>
<div class="line"><a id="l01489" name="l01489"></a><span class="lineno"> 1489</span>        <a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a4895550bd235f0b177d44c84d8cdf04a">_compiled</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01490" name="l01490"></a><span class="lineno"> 1490</span>      }</div>
<div class="line"><a id="l01491" name="l01491"></a><span class="lineno"> 1491</span> </div>
<div class="line"><a id="l01495" name="l01495"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a54ce4df37dfd4222766a741f5b849499"> 1495</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a54ce4df37dfd4222766a741f5b849499">_build_graphs</a>()</div>
<div class="line"><a id="l01496" name="l01496"></a><span class="lineno"> 1496</span>      {</div>
<div class="line"><a id="l01497" name="l01497"></a><span class="lineno"> 1497</span>        <span class="comment">// get vertices-at-element index set</span></div>
<div class="line"><a id="l01498" name="l01498"></a><span class="lineno"> 1498</span>        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; idx_set = this-&gt;_trafo.get_mesh().template get_index_set&lt;shape_dim,0&gt;();</div>
<div class="line"><a id="l01499" name="l01499"></a><span class="lineno"> 1499</span> </div>
<div class="line"><a id="l01500" name="l01500"></a><span class="lineno"> 1500</span>        <span class="comment">// query dimensions</span></div>
<div class="line"><a id="l01501" name="l01501"></a><span class="lineno"> 1501</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> nel = <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(this-&gt;_element_indices.size());</div>
<div class="line"><a id="l01502" name="l01502"></a><span class="lineno"> 1502</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> nvt = idx_set.get_index_bound();</div>
<div class="line"><a id="l01503" name="l01503"></a><span class="lineno"> 1503</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> nix = <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(idx_set.get_num_indices());</div>
<div class="line"><a id="l01504" name="l01504"></a><span class="lineno"> 1504</span> </div>
<div class="line"><a id="l01505" name="l01505"></a><span class="lineno"> 1505</span>        <span class="comment">// allocate graph</span></div>
<div class="line"><a id="l01506" name="l01506"></a><span class="lineno"> 1506</span>        this-&gt;_verts_at_elem = <a class="code hl_class" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html">Adjacency::Graph</a>(nel, nvt, nel*nix);</div>
<div class="line"><a id="l01507" name="l01507"></a><span class="lineno"> 1507</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>* dom_ptr = this-&gt;_verts_at_elem.<a class="code hl_function" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#a8a87e6dd2f0db7f8aa95c2ba2dda2c71">get_domain_ptr</a>();</div>
<div class="line"><a id="l01508" name="l01508"></a><span class="lineno"> 1508</span>        <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>* img_idx = this-&gt;_verts_at_elem.<a class="code hl_function" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#aa21920504d75a3b75324da3de9ae24b7">get_image_idx</a>();</div>
<div class="line"><a id="l01509" name="l01509"></a><span class="lineno"> 1509</span> </div>
<div class="line"><a id="l01510" name="l01510"></a><span class="lineno"> 1510</span>        <span class="comment">// build domain pointer array</span></div>
<div class="line"><a id="l01511" name="l01511"></a><span class="lineno"> 1511</span>        <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> i(0); i &lt;= nel; ++i)</div>
<div class="line"><a id="l01512" name="l01512"></a><span class="lineno"> 1512</span>          dom_ptr[i] = nix * i;</div>
<div class="line"><a id="l01513" name="l01513"></a><span class="lineno"> 1513</span> </div>
<div class="line"><a id="l01514" name="l01514"></a><span class="lineno"> 1514</span>        <span class="comment">// build image index array</span></div>
<div class="line"><a id="l01515" name="l01515"></a><span class="lineno"> 1515</span>        <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> i(0), k(0); i &lt; nel; ++i)</div>
<div class="line"><a id="l01516" name="l01516"></a><span class="lineno"> 1516</span>        {</div>
<div class="line"><a id="l01517" name="l01517"></a><span class="lineno"> 1517</span>          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; idx = idx_set[this-&gt;_element_indices.at(i)];</div>
<div class="line"><a id="l01518" name="l01518"></a><span class="lineno"> 1518</span>          <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> j(0); j &lt; nix; ++j, ++k)</div>
<div class="line"><a id="l01519" name="l01519"></a><span class="lineno"> 1519</span>            img_idx[k] = idx[<span class="keywordtype">int</span>(j)];</div>
<div class="line"><a id="l01520" name="l01520"></a><span class="lineno"> 1520</span>        }</div>
<div class="line"><a id="l01521" name="l01521"></a><span class="lineno"> 1521</span> </div>
<div class="line"><a id="l01522" name="l01522"></a><span class="lineno"> 1522</span>        <span class="comment">// sort indices</span></div>
<div class="line"><a id="l01523" name="l01523"></a><span class="lineno"> 1523</span>        this-&gt;_verts_at_elem.<a class="code hl_function" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#a6f1048d48ed38f3c4c6d91e4b083916f">sort_indices</a>();</div>
<div class="line"><a id="l01524" name="l01524"></a><span class="lineno"> 1524</span> </div>
<div class="line"><a id="l01525" name="l01525"></a><span class="lineno"> 1525</span>        <span class="comment">// transpose graph</span></div>
<div class="line"><a id="l01526" name="l01526"></a><span class="lineno"> 1526</span>        this-&gt;_elems_at_vert = <a class="code hl_class" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html">Adjacency::Graph</a>(<a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_adjacency.html#a85fc833108471df98e28d6b06324f3e7a382eb179a7d78f25d89c085988b37e95">Adjacency::RenderType::transpose</a>, this-&gt;_verts_at_elem);</div>
<div class="line"><a id="l01527" name="l01527"></a><span class="lineno"> 1527</span> </div>
<div class="line"><a id="l01528" name="l01528"></a><span class="lineno"> 1528</span>        <span class="comment">// build neighbors graph</span></div>
<div class="line"><a id="l01529" name="l01529"></a><span class="lineno"> 1529</span>        this-&gt;_elem_neighbors = <a class="code hl_class" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html">Adjacency::Graph</a>(<a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_adjacency.html#a85fc833108471df98e28d6b06324f3e7a1643ca58f467adb1a5dff48e854ef1bf">Adjacency::RenderType::injectify_sorted</a>, this-&gt;_verts_at_elem, this-&gt;_elems_at_vert);</div>
<div class="line"><a id="l01530" name="l01530"></a><span class="lineno"> 1530</span>      }</div>
<div class="line"><a id="l01531" name="l01531"></a><span class="lineno"> 1531</span> </div>
<div class="line"><a id="l01543" name="l01543"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a7bb2dc51f98f92bd55b741ed4026371b"> 1543</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a7bb2dc51f98f92bd55b741ed4026371b">_build_layers</a>(<span class="keywordtype">bool</span> reverse, <span class="keywordtype">bool</span> sorted)</div>
<div class="line"><a id="l01544" name="l01544"></a><span class="lineno"> 1544</span>      {</div>
<div class="line"><a id="l01545" name="l01545"></a><span class="lineno"> 1545</span>        <span class="comment">// get number of elements and vertices</span></div>
<div class="line"><a id="l01546" name="l01546"></a><span class="lineno"> 1546</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> num_elems = this-&gt;_elem_neighbors.get_num_nodes_domain();</div>
<div class="line"><a id="l01547" name="l01547"></a><span class="lineno"> 1547</span> </div>
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"> 1548</span>        <span class="comment">// get neighbor arrays</span></div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>* neigh_ptr = this-&gt;_elem_neighbors.<a class="code hl_function" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#a8a87e6dd2f0db7f8aa95c2ba2dda2c71">get_domain_ptr</a>();</div>
<div class="line"><a id="l01550" name="l01550"></a><span class="lineno"> 1550</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>* neigh_idx = this-&gt;_elem_neighbors.<a class="code hl_function" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#aa21920504d75a3b75324da3de9ae24b7">get_image_idx</a>();</div>
<div class="line"><a id="l01551" name="l01551"></a><span class="lineno"> 1551</span> </div>
<div class="line"><a id="l01552" name="l01552"></a><span class="lineno"> 1552</span>        <span class="comment">// a compare function for std::stable_sort</span></div>
<div class="line"><a id="l01553" name="l01553"></a><span class="lineno"> 1553</span>        DegreeCompare degree_compare(this-&gt;_elem_neighbors);</div>
<div class="line"><a id="l01554" name="l01554"></a><span class="lineno"> 1554</span> </div>
<div class="line"><a id="l01555" name="l01555"></a><span class="lineno"> 1555</span>        <span class="comment">// allocate an element mask vector and initialize to 0</span></div>
<div class="line"><a id="l01556" name="l01556"></a><span class="lineno"> 1556</span>        std::vector&lt;int&gt; elem_mask(num_elems, 0);</div>
<div class="line"><a id="l01557" name="l01557"></a><span class="lineno"> 1557</span> </div>
<div class="line"><a id="l01558" name="l01558"></a><span class="lineno"> 1558</span>        <span class="comment">// allocate a new element vector</span></div>
<div class="line"><a id="l01559" name="l01559"></a><span class="lineno"> 1559</span>        std::vector&lt;Index&gt; elements, layers;</div>
<div class="line"><a id="l01560" name="l01560"></a><span class="lineno"> 1560</span>        elements.reserve(num_elems);</div>
<div class="line"><a id="l01561" name="l01561"></a><span class="lineno"> 1561</span>        layers.reserve(num_elems);</div>
<div class="line"><a id="l01562" name="l01562"></a><span class="lineno"> 1562</span> </div>
<div class="line"><a id="l01563" name="l01563"></a><span class="lineno"> 1563</span>        <span class="comment">// push beginning of first layer</span></div>
<div class="line"><a id="l01564" name="l01564"></a><span class="lineno"> 1564</span>        layers.push_back(0u);</div>
<div class="line"><a id="l01565" name="l01565"></a><span class="lineno"> 1565</span> </div>
<div class="line"><a id="l01566" name="l01566"></a><span class="lineno"> 1566</span>        <span class="comment">// main Cuthill-McKee loop</span></div>
<div class="line"><a id="l01567" name="l01567"></a><span class="lineno"> 1567</span>        <span class="keywordflow">while</span>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(elements.size()) &lt; num_elems)</div>
<div class="line"><a id="l01568" name="l01568"></a><span class="lineno"> 1568</span>        {</div>
<div class="line"><a id="l01569" name="l01569"></a><span class="lineno"> 1569</span>          <span class="comment">// pick a new root element</span></div>
<div class="line"><a id="l01570" name="l01570"></a><span class="lineno"> 1570</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> root = num_elems + 1u;</div>
<div class="line"><a id="l01571" name="l01571"></a><span class="lineno"> 1571</span> </div>
<div class="line"><a id="l01572" name="l01572"></a><span class="lineno"> 1572</span>          <span class="comment">// choose the node of minimum degree</span></div>
<div class="line"><a id="l01573" name="l01573"></a><span class="lineno"> 1573</span>          {</div>
<div class="line"><a id="l01574" name="l01574"></a><span class="lineno"> 1574</span>            <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> min = num_elems + 1u;</div>
<div class="line"><a id="l01575" name="l01575"></a><span class="lineno"> 1575</span>            <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> j(0); j &lt; num_elems; ++j)</div>
<div class="line"><a id="l01576" name="l01576"></a><span class="lineno"> 1576</span>            {</div>
<div class="line"><a id="l01577" name="l01577"></a><span class="lineno"> 1577</span>              <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> deg = this-&gt;_elem_neighbors.<a class="code hl_function" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#aa9cdd4137ca4eb408ba30d03f592813a">degree</a>(j);</div>
<div class="line"><a id="l01578" name="l01578"></a><span class="lineno"> 1578</span>              <span class="keywordflow">if</span>((deg &lt; min) &amp;&amp; (elem_mask[j] == 0))</div>
<div class="line"><a id="l01579" name="l01579"></a><span class="lineno"> 1579</span>              {</div>
<div class="line"><a id="l01580" name="l01580"></a><span class="lineno"> 1580</span>                root = j;</div>
<div class="line"><a id="l01581" name="l01581"></a><span class="lineno"> 1581</span>                min = deg;</div>
<div class="line"><a id="l01582" name="l01582"></a><span class="lineno"> 1582</span>              }</div>
<div class="line"><a id="l01583" name="l01583"></a><span class="lineno"> 1583</span>            }</div>
<div class="line"><a id="l01584" name="l01584"></a><span class="lineno"> 1584</span>          }</div>
<div class="line"><a id="l01585" name="l01585"></a><span class="lineno"> 1585</span> </div>
<div class="line"><a id="l01586" name="l01586"></a><span class="lineno"> 1586</span>          <a class="code hl_define" href="assertion_8hpp.html#afa48e2beb6db8fae75edc24466481965">XASSERTM</a>(root &lt; num_elems, <span class="stringliteral">&quot;no valid root element found&quot;</span>);</div>
<div class="line"><a id="l01587" name="l01587"></a><span class="lineno"> 1587</span> </div>
<div class="line"><a id="l01588" name="l01588"></a><span class="lineno"> 1588</span>          <span class="comment">// push next layer</span></div>
<div class="line"><a id="l01589" name="l01589"></a><span class="lineno"> 1589</span>          elements.push_back(root);</div>
<div class="line"><a id="l01590" name="l01590"></a><span class="lineno"> 1590</span>          elem_mask[root] = int(layers.size());</div>
<div class="line"><a id="l01591" name="l01591"></a><span class="lineno"> 1591</span> </div>
<div class="line"><a id="l01592" name="l01592"></a><span class="lineno"> 1592</span>          <span class="comment">// loop over the adjacency levels of the root element</span></div>
<div class="line"><a id="l01593" name="l01593"></a><span class="lineno"> 1593</span>          <span class="keywordflow">while</span>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(elements.size()) &lt; num_elems)</div>
<div class="line"><a id="l01594" name="l01594"></a><span class="lineno"> 1594</span>          {</div>
<div class="line"><a id="l01595" name="l01595"></a><span class="lineno"> 1595</span>            <span class="comment">// get layer start</span></div>
<div class="line"><a id="l01596" name="l01596"></a><span class="lineno"> 1596</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> layer_beg = layers.back();</div>
<div class="line"><a id="l01597" name="l01597"></a><span class="lineno"> 1597</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> layer_end = <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(elements.size());</div>
<div class="line"><a id="l01598" name="l01598"></a><span class="lineno"> 1598</span>            layers.push_back(layer_end);</div>
<div class="line"><a id="l01599" name="l01599"></a><span class="lineno"> 1599</span> </div>
<div class="line"><a id="l01600" name="l01600"></a><span class="lineno"> 1600</span>            <span class="comment">// loop over all elements in the current layer</span></div>
<div class="line"><a id="l01601" name="l01601"></a><span class="lineno"> 1601</span>            <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> i(layer_beg); i &lt; layer_end; ++i)</div>
<div class="line"><a id="l01602" name="l01602"></a><span class="lineno"> 1602</span>            {</div>
<div class="line"><a id="l01603" name="l01603"></a><span class="lineno"> 1603</span>              <span class="comment">// get the element&#39;s index</span></div>
<div class="line"><a id="l01604" name="l01604"></a><span class="lineno"> 1604</span>              <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> elem_idx = elements.at(i);</div>
<div class="line"><a id="l01605" name="l01605"></a><span class="lineno"> 1605</span> </div>
<div class="line"><a id="l01606" name="l01606"></a><span class="lineno"> 1606</span>              <span class="comment">// loop over all element neighbors</span></div>
<div class="line"><a id="l01607" name="l01607"></a><span class="lineno"> 1607</span>              <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> j(neigh_ptr[elem_idx]); j &lt; neigh_ptr[elem_idx+1]; ++j)</div>
<div class="line"><a id="l01608" name="l01608"></a><span class="lineno"> 1608</span>              {</div>
<div class="line"><a id="l01609" name="l01609"></a><span class="lineno"> 1609</span>                <span class="comment">// get the neighbor&#39;s element index</span></div>
<div class="line"><a id="l01610" name="l01610"></a><span class="lineno"> 1610</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> elem_jdx = neigh_idx[j];</div>
<div class="line"><a id="l01611" name="l01611"></a><span class="lineno"> 1611</span> </div>
<div class="line"><a id="l01612" name="l01612"></a><span class="lineno"> 1612</span>                <span class="comment">// did we already process this element?</span></div>
<div class="line"><a id="l01613" name="l01613"></a><span class="lineno"> 1613</span>                <span class="keywordflow">if</span>(elem_mask[elem_jdx] == 0)</div>
<div class="line"><a id="l01614" name="l01614"></a><span class="lineno"> 1614</span>                {</div>
<div class="line"><a id="l01615" name="l01615"></a><span class="lineno"> 1615</span>                  <span class="comment">// add element</span></div>
<div class="line"><a id="l01616" name="l01616"></a><span class="lineno"> 1616</span>                  elements.push_back(elem_jdx);</div>
<div class="line"><a id="l01617" name="l01617"></a><span class="lineno"> 1617</span>                  elem_mask[elem_jdx] = int(layers.size());</div>
<div class="line"><a id="l01618" name="l01618"></a><span class="lineno"> 1618</span>                }</div>
<div class="line"><a id="l01619" name="l01619"></a><span class="lineno"> 1619</span>              }</div>
<div class="line"><a id="l01620" name="l01620"></a><span class="lineno"> 1620</span>            }</div>
<div class="line"><a id="l01621" name="l01621"></a><span class="lineno"> 1621</span> </div>
<div class="line"><a id="l01622" name="l01622"></a><span class="lineno"> 1622</span>            <span class="comment">// no new elements?</span></div>
<div class="line"><a id="l01623" name="l01623"></a><span class="lineno"> 1623</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> layer_nxt = <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(elements.size());</div>
<div class="line"><a id="l01624" name="l01624"></a><span class="lineno"> 1624</span>            <span class="keywordflow">if</span>(layer_nxt &lt;= layer_end)</div>
<div class="line"><a id="l01625" name="l01625"></a><span class="lineno"> 1625</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01626" name="l01626"></a><span class="lineno"> 1626</span> </div>
<div class="line"><a id="l01627" name="l01627"></a><span class="lineno"> 1627</span>            <span class="comment">// sort elements in layer by neighbor degree</span></div>
<div class="line"><a id="l01628" name="l01628"></a><span class="lineno"> 1628</span>            <span class="keywordflow">if</span>(sorted)</div>
<div class="line"><a id="l01629" name="l01629"></a><span class="lineno"> 1629</span>              std::stable_sort(elements.begin() + std::ptrdiff_t(layer_end), elements.begin() + std::ptrdiff_t(layer_nxt), degree_compare);</div>
<div class="line"><a id="l01630" name="l01630"></a><span class="lineno"> 1630</span> </div>
<div class="line"><a id="l01631" name="l01631"></a><span class="lineno"> 1631</span>            <span class="comment">// continue with next layer</span></div>
<div class="line"><a id="l01632" name="l01632"></a><span class="lineno"> 1632</span>          }</div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"> 1633</span>          <span class="comment">// continue with next root</span></div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span>        }</div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span> </div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span>        <span class="comment">// push final layer end</span></div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"> 1637</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> num_layers = <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(layers.size());</div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span>        layers.push_back(num_elems);</div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span> </div>
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"> 1640</span>        <span class="comment">// translate and sort element indices</span></div>
<div class="line"><a id="l01641" name="l01641"></a><span class="lineno"> 1641</span>        <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> ilay(0); ilay &lt; num_layers; ++ilay)</div>
<div class="line"><a id="l01642" name="l01642"></a><span class="lineno"> 1642</span>        {</div>
<div class="line"><a id="l01643" name="l01643"></a><span class="lineno"> 1643</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> ibeg = layers.at(ilay);</div>
<div class="line"><a id="l01644" name="l01644"></a><span class="lineno"> 1644</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> iend = layers.at(ilay+1u);</div>
<div class="line"><a id="l01645" name="l01645"></a><span class="lineno"> 1645</span> </div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span>          <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> j(ibeg); j &lt; iend; ++j)</div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span>            elements[j] = this-&gt;_element_indices[elements[j]];</div>
<div class="line"><a id="l01648" name="l01648"></a><span class="lineno"> 1648</span> </div>
<div class="line"><a id="l01649" name="l01649"></a><span class="lineno"> 1649</span>          <span class="comment">// sort elements in layer</span></div>
<div class="line"><a id="l01650" name="l01650"></a><span class="lineno"> 1650</span>          <span class="keywordflow">if</span>(sorted)</div>
<div class="line"><a id="l01651" name="l01651"></a><span class="lineno"> 1651</span>            std::sort(elements.begin() + std::ptrdiff_t(ibeg), elements.begin() + std::ptrdiff_t(iend));</div>
<div class="line"><a id="l01652" name="l01652"></a><span class="lineno"> 1652</span>        }</div>
<div class="line"><a id="l01653" name="l01653"></a><span class="lineno"> 1653</span> </div>
<div class="line"><a id="l01654" name="l01654"></a><span class="lineno"> 1654</span>        <span class="comment">// reverse layers?</span></div>
<div class="line"><a id="l01655" name="l01655"></a><span class="lineno"> 1655</span>        <span class="keywordflow">if</span>(reverse)</div>
<div class="line"><a id="l01656" name="l01656"></a><span class="lineno"> 1656</span>        {</div>
<div class="line"><a id="l01657" name="l01657"></a><span class="lineno"> 1657</span>          this-&gt;_element_indices.clear();</div>
<div class="line"><a id="l01658" name="l01658"></a><span class="lineno"> 1658</span>          this-&gt;_layer_elements.clear();</div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span>          this-&gt;_layer_elements.reserve(layers.size());</div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"> 1660</span>          this-&gt;_layer_elements.push_back(0u);</div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span> </div>
<div class="line"><a id="l01662" name="l01662"></a><span class="lineno"> 1662</span>          <span class="comment">// reverse layers</span></div>
<div class="line"><a id="l01663" name="l01663"></a><span class="lineno"> 1663</span>          <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> ilay(0); ilay &lt; num_layers; ++ilay)</div>
<div class="line"><a id="l01664" name="l01664"></a><span class="lineno"> 1664</span>          {</div>
<div class="line"><a id="l01665" name="l01665"></a><span class="lineno"> 1665</span>            <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> ibeg = layers.at(num_layers-ilay-1u);</div>
<div class="line"><a id="l01666" name="l01666"></a><span class="lineno"> 1666</span>            <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> iend = layers.at(num_layers-ilay);</div>
<div class="line"><a id="l01667" name="l01667"></a><span class="lineno"> 1667</span> </div>
<div class="line"><a id="l01668" name="l01668"></a><span class="lineno"> 1668</span>            <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> j(ibeg); j &lt; iend; ++j)</div>
<div class="line"><a id="l01669" name="l01669"></a><span class="lineno"> 1669</span>            {</div>
<div class="line"><a id="l01670" name="l01670"></a><span class="lineno"> 1670</span>              this-&gt;_element_indices.push_back(elements[j]);</div>
<div class="line"><a id="l01671" name="l01671"></a><span class="lineno"> 1671</span>            }</div>
<div class="line"><a id="l01672" name="l01672"></a><span class="lineno"> 1672</span> </div>
<div class="line"><a id="l01673" name="l01673"></a><span class="lineno"> 1673</span>            this-&gt;_layer_elements.push_back(this-&gt;_layer_elements.back() + iend - ibeg);</div>
<div class="line"><a id="l01674" name="l01674"></a><span class="lineno"> 1674</span>          }</div>
<div class="line"><a id="l01675" name="l01675"></a><span class="lineno"> 1675</span>        }</div>
<div class="line"><a id="l01676" name="l01676"></a><span class="lineno"> 1676</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l01677" name="l01677"></a><span class="lineno"> 1677</span>        {</div>
<div class="line"><a id="l01678" name="l01678"></a><span class="lineno"> 1678</span>          this-&gt;_element_indices = std::move(elements);</div>
<div class="line"><a id="l01679" name="l01679"></a><span class="lineno"> 1679</span>          this-&gt;_layer_elements = std::move(layers);</div>
<div class="line"><a id="l01680" name="l01680"></a><span class="lineno"> 1680</span>        }</div>
<div class="line"><a id="l01681" name="l01681"></a><span class="lineno"> 1681</span>      }</div>
<div class="line"><a id="l01682" name="l01682"></a><span class="lineno"> 1682</span> </div>
<div class="line"><a id="l01686" name="l01686"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a6968841ff89919a898e6bb084b8170a0"> 1686</a></span>      <span class="keywordtype">bool</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a6968841ff89919a898e6bb084b8170a0">_build_thread_layers</a>()</div>
<div class="line"><a id="l01687" name="l01687"></a><span class="lineno"> 1687</span>      {</div>
<div class="line"><a id="l01688" name="l01688"></a><span class="lineno"> 1688</span>        <span class="comment">// no threading?</span></div>
<div class="line"><a id="l01689" name="l01689"></a><span class="lineno"> 1689</span>        <span class="keywordflow">if</span>(this-&gt;_max_worker_threads &lt; std::size_t(1))</div>
<div class="line"><a id="l01690" name="l01690"></a><span class="lineno"> 1690</span>          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01691" name="l01691"></a><span class="lineno"> 1691</span> </div>
<div class="line"><a id="l01692" name="l01692"></a><span class="lineno"> 1692</span>        <span class="comment">// set the number of actual worker threads; we want at least 3 layers per thread on average</span></div>
<div class="line"><a id="l01693" name="l01693"></a><span class="lineno"> 1693</span>        this-&gt;_num_worker_threads = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a737d301e1e32f502778181d09b408407">Math::min</a>(this-&gt;_max_worker_threads,</div>
<div class="line"><a id="l01694" name="l01694"></a><span class="lineno"> 1694</span>          this-&gt;_layer_elements.size() / std::size_t(3));</div>
<div class="line"><a id="l01695" name="l01695"></a><span class="lineno"> 1695</span> </div>
<div class="line"><a id="l01696" name="l01696"></a><span class="lineno"> 1696</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> num_elems = <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(this-&gt;_element_indices.size());</div>
<div class="line"><a id="l01697" name="l01697"></a><span class="lineno"> 1697</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> num_layers = <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(this-&gt;_layer_elements.size() - 1u);</div>
<div class="line"><a id="l01698" name="l01698"></a><span class="lineno"> 1698</span> </div>
<div class="line"><a id="l01699" name="l01699"></a><span class="lineno"> 1699</span>        this-&gt;_thread_layers.reserve(this-&gt;_num_worker_threads+1u);</div>
<div class="line"><a id="l01700" name="l01700"></a><span class="lineno"> 1700</span>        this-&gt;_thread_layers.push_back(0u);</div>
<div class="line"><a id="l01701" name="l01701"></a><span class="lineno"> 1701</span> </div>
<div class="line"><a id="l01702" name="l01702"></a><span class="lineno"> 1702</span>        <span class="comment">// In the following, we need to assign a set of consecutive layers to each thread.</span></div>
<div class="line"><a id="l01703" name="l01703"></a><span class="lineno"> 1703</span>        <span class="comment">// We want to distribute the layers so that each thread is assigned roughly the</span></div>
<div class="line"><a id="l01704" name="l01704"></a><span class="lineno"> 1704</span>        <span class="comment">// same number elements to avoid imbalance, but at the same time we have to make</span></div>
<div class="line"><a id="l01705" name="l01705"></a><span class="lineno"> 1705</span>        <span class="comment">// sure that each thread is assigned at least two layers to rule out race conditions.</span></div>
<div class="line"><a id="l01706" name="l01706"></a><span class="lineno"> 1706</span>        <span class="comment">// This is performed in a 3-step approach: first we distribute the layers to avoid</span></div>
<div class="line"><a id="l01707" name="l01707"></a><span class="lineno"> 1707</span>        <span class="comment">// imbalance and afterwards then we enforce the minimum of two layers per thread</span></div>
<div class="line"><a id="l01708" name="l01708"></a><span class="lineno"> 1708</span>        <span class="comment">// by a backward and a forward sweep. Note that in general this approach will not</span></div>
<div class="line"><a id="l01709" name="l01709"></a><span class="lineno"> 1709</span>        <span class="comment">// yield an optimal partitioning if there are only few layers, but this shouldn&#39;t</span></div>
<div class="line"><a id="l01710" name="l01710"></a><span class="lineno"> 1710</span>        <span class="comment">// really matter in practice.</span></div>
<div class="line"><a id="l01711" name="l01711"></a><span class="lineno"> 1711</span> </div>
<div class="line"><a id="l01712" name="l01712"></a><span class="lineno"> 1712</span>        <span class="comment">// Example:</span></div>
<div class="line"><a id="l01713" name="l01713"></a><span class="lineno"> 1713</span>        <span class="comment">// Assume we have 60 elements, 8 layers of different sizes and 3 worker threads</span></div>
<div class="line"><a id="l01714" name="l01714"></a><span class="lineno"> 1714</span>        <span class="comment">// In a perfect world, each worker thread should process the same number of</span></div>
<div class="line"><a id="l01715" name="l01715"></a><span class="lineno"> 1715</span>        <span class="comment">// elements (20), but in our case, the threads can only be assigned whole layers.</span></div>
<div class="line"><a id="l01716" name="l01716"></a><span class="lineno"> 1716</span>        <span class="comment">//</span></div>
<div class="line"><a id="l01717" name="l01717"></a><span class="lineno"> 1717</span>        <span class="comment">// Step 1: for each thread, we choose the starting layer whose first element</span></div>
<div class="line"><a id="l01718" name="l01718"></a><span class="lineno"> 1718</span>        <span class="comment">//         is greater or equal to the desired first element for that thread</span></div>
<div class="line"><a id="l01719" name="l01719"></a><span class="lineno"> 1719</span>        <span class="comment">// Step 2: ensure that each thread has at least 2 layer by a backward sweep</span></div>
<div class="line"><a id="l01720" name="l01720"></a><span class="lineno"> 1720</span>        <span class="comment">// Step 3: ensure that each thread has at least 2 layer by a forward sweep</span></div>
<div class="line"><a id="l01721" name="l01721"></a><span class="lineno"> 1721</span>        <span class="comment">//</span></div>
<div class="line"><a id="l01722" name="l01722"></a><span class="lineno"> 1722</span>        <span class="comment">// elements:     .123456789.123456789.123456789.123456789.123456789.123456789</span></div>
<div class="line"><a id="l01723" name="l01723"></a><span class="lineno"> 1723</span>        <span class="comment">// layers:       |0-|1--|2---|3----|4-----|5-------|6---------|7------------|</span></div>
<div class="line"><a id="l01724" name="l01724"></a><span class="lineno"> 1724</span>        <span class="comment">// desired:      |0------------------|1------------------|2-----------------|</span></div>
<div class="line"><a id="l01725" name="l01725"></a><span class="lineno"> 1725</span>        <span class="comment">// threads #1:   |0-----------------------|1------------------|2------------|</span></div>
<div class="line"><a id="l01726" name="l01726"></a><span class="lineno"> 1726</span>        <span class="comment">// threads #2:   |0----------------|1--------------|2-----------------------|</span></div>
<div class="line"><a id="l01727" name="l01727"></a><span class="lineno"> 1727</span>        <span class="comment">// threads #3:   |0----------------|1--------------|2-----------------------|</span></div>
<div class="line"><a id="l01728" name="l01728"></a><span class="lineno"> 1728</span> </div>
<div class="line"><a id="l01729" name="l01729"></a><span class="lineno"> 1729</span>        <span class="comment">// Step 1: build thread layers by desired elements</span></div>
<div class="line"><a id="l01730" name="l01730"></a><span class="lineno"> 1730</span>        <span class="keywordflow">for</span>(std::size_t i(1); i &lt; this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a81e7a1b5e7628c0e2e7d0b4eaf7a83b9">_num_worker_threads</a>; ++i)</div>
<div class="line"><a id="l01731" name="l01731"></a><span class="lineno"> 1731</span>        {</div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"> 1732</span>          <span class="comment">// compute the desired first element of the i-th thread</span></div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> desired_first = (num_elems * <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(i)) / <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(this-&gt;_num_worker_threads);</div>
<div class="line"><a id="l01734" name="l01734"></a><span class="lineno"> 1734</span> </div>
<div class="line"><a id="l01735" name="l01735"></a><span class="lineno"> 1735</span>          <span class="comment">// choose the first layer whose first element is greater or equal to our desired element</span></div>
<div class="line"><a id="l01736" name="l01736"></a><span class="lineno"> 1736</span>          <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> j(this-&gt;_thread_layers.back()+1);</div>
<div class="line"><a id="l01737" name="l01737"></a><span class="lineno"> 1737</span>          <span class="keywordflow">while</span>((j &lt; num_layers) &amp;&amp; (this-&gt;_layer_elements.at(j) &lt; desired_first))</div>
<div class="line"><a id="l01738" name="l01738"></a><span class="lineno"> 1738</span>            ++j;</div>
<div class="line"><a id="l01739" name="l01739"></a><span class="lineno"> 1739</span>          this-&gt;_thread_layers.push_back(j);</div>
<div class="line"><a id="l01740" name="l01740"></a><span class="lineno"> 1740</span>        }</div>
<div class="line"><a id="l01741" name="l01741"></a><span class="lineno"> 1741</span>        this-&gt;_thread_layers.push_back(num_layers);</div>
<div class="line"><a id="l01742" name="l01742"></a><span class="lineno"> 1742</span> </div>
<div class="line"><a id="l01743" name="l01743"></a><span class="lineno"> 1743</span>        <span class="comment">// Step 2: make sure each thread has at least two layers by backward sweep</span></div>
<div class="line"><a id="l01744" name="l01744"></a><span class="lineno"> 1744</span>        <span class="keywordflow">for</span>(std::size_t i(this-&gt;_num_worker_threads-1); i &gt; 0; --i)</div>
<div class="line"><a id="l01745" name="l01745"></a><span class="lineno"> 1745</span>        {</div>
<div class="line"><a id="l01746" name="l01746"></a><span class="lineno"> 1746</span>          <span class="comment">// make sure there are at least two layers for this thread</span></div>
<div class="line"><a id="l01747" name="l01747"></a><span class="lineno"> 1747</span>          <span class="comment">// if not, then decrease the preceding thread&#39;s starting layer index</span></div>
<div class="line"><a id="l01748" name="l01748"></a><span class="lineno"> 1748</span>          <span class="keywordflow">if</span>(this-&gt;_thread_layers.at(i+1) &lt; this-&gt;_thread_layers.at(i) + <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(2))</div>
<div class="line"><a id="l01749" name="l01749"></a><span class="lineno"> 1749</span>            this-&gt;_thread_layers.at(i) = this-&gt;_thread_layers.at(i+1) - <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(2);</div>
<div class="line"><a id="l01750" name="l01750"></a><span class="lineno"> 1750</span> </div>
<div class="line"><a id="l01751" name="l01751"></a><span class="lineno"> 1751</span>          <span class="comment">// bail out if we have less that two layers left;</span></div>
<div class="line"><a id="l01752" name="l01752"></a><span class="lineno"> 1752</span>          <span class="comment">// the next loop takes care of this case</span></div>
<div class="line"><a id="l01753" name="l01753"></a><span class="lineno"> 1753</span>          <span class="keywordflow">if</span>(this-&gt;_thread_layers.at(i) &lt; <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(2))</div>
<div class="line"><a id="l01754" name="l01754"></a><span class="lineno"> 1754</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01755" name="l01755"></a><span class="lineno"> 1755</span>        }</div>
<div class="line"><a id="l01756" name="l01756"></a><span class="lineno"> 1756</span> </div>
<div class="line"><a id="l01757" name="l01757"></a><span class="lineno"> 1757</span>        <span class="comment">// Step 3: make sure each thread has at least two layers by forward sweep</span></div>
<div class="line"><a id="l01758" name="l01758"></a><span class="lineno"> 1758</span>        <span class="keywordflow">for</span>(std::size_t i(0); i &lt; this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a81e7a1b5e7628c0e2e7d0b4eaf7a83b9">_num_worker_threads</a>; ++i)</div>
<div class="line"><a id="l01759" name="l01759"></a><span class="lineno"> 1759</span>        {</div>
<div class="line"><a id="l01760" name="l01760"></a><span class="lineno"> 1760</span>          <span class="comment">// make sure there are at least two layers for this thread</span></div>
<div class="line"><a id="l01761" name="l01761"></a><span class="lineno"> 1761</span>          <span class="comment">// if not, then increase the succeeding thread&#39;s starting layer index</span></div>
<div class="line"><a id="l01762" name="l01762"></a><span class="lineno"> 1762</span>          <span class="keywordflow">if</span>(this-&gt;_thread_layers.at(i+1) &lt; this-&gt;_thread_layers.at(i) + <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(2))</div>
<div class="line"><a id="l01763" name="l01763"></a><span class="lineno"> 1763</span>            this-&gt;_thread_layers.at(i+1) = this-&gt;_thread_layers.at(i) + <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(2);</div>
<div class="line"><a id="l01764" name="l01764"></a><span class="lineno"> 1764</span>        }</div>
<div class="line"><a id="l01765" name="l01765"></a><span class="lineno"> 1765</span> </div>
<div class="line"><a id="l01766" name="l01766"></a><span class="lineno"> 1766</span>        <span class="comment">// make sure that we didn&#39;t change the first and last entries</span></div>
<div class="line"><a id="l01767" name="l01767"></a><span class="lineno"> 1767</span>        <a class="code hl_define" href="assertion_8hpp.html#af5c647b0786db55f57452bfc26726bde">XASSERT</a>(this-&gt;_thread_layers.front() == <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(0));</div>
<div class="line"><a id="l01768" name="l01768"></a><span class="lineno"> 1768</span>        <a class="code hl_define" href="assertion_8hpp.html#af5c647b0786db55f57452bfc26726bde">XASSERT</a>(this-&gt;_thread_layers.back() == num_layers);</div>
<div class="line"><a id="l01769" name="l01769"></a><span class="lineno"> 1769</span> </div>
<div class="line"><a id="l01770" name="l01770"></a><span class="lineno"> 1770</span>        <span class="comment">// okay</span></div>
<div class="line"><a id="l01771" name="l01771"></a><span class="lineno"> 1771</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01772" name="l01772"></a><span class="lineno"> 1772</span>      }</div>
<div class="line"><a id="l01773" name="l01773"></a><span class="lineno"> 1773</span> </div>
<div class="line"><a id="l01779" name="l01779"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#af6a72c4c3bb66a01b76419bc0d50a246"> 1779</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#af6a72c4c3bb66a01b76419bc0d50a246">_build_colors</a>()</div>
<div class="line"><a id="l01780" name="l01780"></a><span class="lineno"> 1780</span>      {</div>
<div class="line"><a id="l01781" name="l01781"></a><span class="lineno"> 1781</span>        <span class="comment">// create coloring from our neighbors graph</span></div>
<div class="line"><a id="l01782" name="l01782"></a><span class="lineno"> 1782</span>        <a class="code hl_class" href="class_f_e_a_t_1_1_adjacency_1_1_coloring.html">Adjacency::Coloring</a> coloring(this-&gt;_elem_neighbors);</div>
<div class="line"><a id="l01783" name="l01783"></a><span class="lineno"> 1783</span> </div>
<div class="line"><a id="l01784" name="l01784"></a><span class="lineno"> 1784</span>        <span class="comment">// create the partitioning graph from our coloring</span></div>
<div class="line"><a id="l01785" name="l01785"></a><span class="lineno"> 1785</span>        <a class="code hl_class" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html">Adjacency::Graph</a> color_parti = coloring.<a class="code hl_function" href="class_f_e_a_t_1_1_adjacency_1_1_coloring.html#a24fb5326b73a7958cc9765cb24800ff7">create_partition_graph</a>();</div>
<div class="line"><a id="l01786" name="l01786"></a><span class="lineno"> 1786</span> </div>
<div class="line"><a id="l01787" name="l01787"></a><span class="lineno"> 1787</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> num_elems = color_parti.get_num_nodes_image();</div>
<div class="line"><a id="l01788" name="l01788"></a><span class="lineno"> 1788</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> num_colors = color_parti.get_num_nodes_domain();</div>
<div class="line"><a id="l01789" name="l01789"></a><span class="lineno"> 1789</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>* dom_ptr = color_parti.<a class="code hl_function" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#a8a87e6dd2f0db7f8aa95c2ba2dda2c71">get_domain_ptr</a>();</div>
<div class="line"><a id="l01790" name="l01790"></a><span class="lineno"> 1790</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>* img_idx = color_parti.<a class="code hl_function" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#aa21920504d75a3b75324da3de9ae24b7">get_image_idx</a>();</div>
<div class="line"><a id="l01791" name="l01791"></a><span class="lineno"> 1791</span> </div>
<div class="line"><a id="l01792" name="l01792"></a><span class="lineno"> 1792</span>        <span class="comment">// sanity check</span></div>
<div class="line"><a id="l01793" name="l01793"></a><span class="lineno"> 1793</span>        <a class="code hl_define" href="assertion_8hpp.html#af5c647b0786db55f57452bfc26726bde">XASSERT</a>(num_elems == <a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>(this-&gt;_element_indices.size()));</div>
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"> 1794</span> </div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"> 1795</span>        <span class="comment">// set number of worker threads to the minimum of the desired maximum number of threads</span></div>
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"> 1796</span>        <span class="comment">// and the maximum number of elements per color; note that it is perfectly legal if some</span></div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span>        <span class="comment">// colors contain less elements than we have worker threads because in this case some of</span></div>
<div class="line"><a id="l01798" name="l01798"></a><span class="lineno"> 1798</span>        <span class="comment">// the threads will simply twiddle their thumbs during the assembly</span></div>
<div class="line"><a id="l01799" name="l01799"></a><span class="lineno"> 1799</span>        this-&gt;_num_worker_threads = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a737d301e1e32f502778181d09b408407">Math::min</a>(this-&gt;_max_worker_threads, std::size_t(color_parti.<a class="code hl_function" href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#aa9cdd4137ca4eb408ba30d03f592813a">degree</a>()));</div>
<div class="line"><a id="l01800" name="l01800"></a><span class="lineno"> 1800</span> </div>
<div class="line"><a id="l01801" name="l01801"></a><span class="lineno"> 1801</span>        <span class="comment">// backup element indices</span></div>
<div class="line"><a id="l01802" name="l01802"></a><span class="lineno"> 1802</span>        std::vector&lt;Index&gt; elems(this-&gt;_element_indices);</div>
<div class="line"><a id="l01803" name="l01803"></a><span class="lineno"> 1803</span> </div>
<div class="line"><a id="l01804" name="l01804"></a><span class="lineno"> 1804</span>        <span class="comment">// translate image indices</span></div>
<div class="line"><a id="l01805" name="l01805"></a><span class="lineno"> 1805</span>        <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> i(0); i &lt; num_elems; ++i)</div>
<div class="line"><a id="l01806" name="l01806"></a><span class="lineno"> 1806</span>          this-&gt;_element_indices.at(i) = elems.at(img_idx[i]);</div>
<div class="line"><a id="l01807" name="l01807"></a><span class="lineno"> 1807</span> </div>
<div class="line"><a id="l01808" name="l01808"></a><span class="lineno"> 1808</span>        <span class="comment">// store color layers</span></div>
<div class="line"><a id="l01809" name="l01809"></a><span class="lineno"> 1809</span>        <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> i(0); i &lt;= num_colors; ++i)</div>
<div class="line"><a id="l01810" name="l01810"></a><span class="lineno"> 1810</span>          this-&gt;_color_elements.push_back(dom_ptr[i]);</div>
<div class="line"><a id="l01811" name="l01811"></a><span class="lineno"> 1811</span>      }</div>
<div class="line"><a id="l01812" name="l01812"></a><span class="lineno"> 1812</span>    }; <span class="comment">// DomainAssembler</span></div>
<div class="line"><a id="l01813" name="l01813"></a><span class="lineno"> 1813</span>  } <span class="comment">// namespace Assembly</span></div>
<div class="line"><a id="l01814" name="l01814"></a><span class="lineno"> 1814</span>} <span class="comment">// namespace FEAT</span></div>
<div class="line"><a id="l01815" name="l01815"></a><span class="lineno"> 1815</span> </div>
<div class="line"><a id="l01816" name="l01816"></a><span class="lineno"> 1816</span><span class="preprocessor">#endif </span><span class="comment">// KERNEL_ASSEMBLY_DOMAIN_ASSEMBLER_HPP</span></div>
<div class="ttc" id="aassertion_8hpp_html_a33180af240360ec61a3968af89731f12"><div class="ttname"><a href="assertion_8hpp.html#a33180af240360ec61a3968af89731f12">XABORTM</a></div><div class="ttdeci">#define XABORTM(msg)</div><div class="ttdoc">Abortion macro definition with custom message.</div><div class="ttdef"><b>Definition:</b> <a href="assertion_8hpp_source.html#l00113">assertion.hpp:113</a></div></div>
<div class="ttc" id="aassertion_8hpp_html_af5c647b0786db55f57452bfc26726bde"><div class="ttname"><a href="assertion_8hpp.html#af5c647b0786db55f57452bfc26726bde">XASSERT</a></div><div class="ttdeci">#define XASSERT(expr)</div><div class="ttdoc">Assertion macro definition.</div><div class="ttdef"><b>Definition:</b> <a href="assertion_8hpp_source.html#l00183">assertion.hpp:183</a></div></div>
<div class="ttc" id="aassertion_8hpp_html_afa48e2beb6db8fae75edc24466481965"><div class="ttname"><a href="assertion_8hpp.html#afa48e2beb6db8fae75edc24466481965">XASSERTM</a></div><div class="ttdeci">#define XASSERTM(expr, msg)</div><div class="ttdoc">Assertion macro definition with custom message.</div><div class="ttdef"><b>Definition:</b> <a href="assertion_8hpp_source.html#l00184">assertion.hpp:184</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_adjacency_1_1_coloring_html"><div class="ttname"><a href="class_f_e_a_t_1_1_adjacency_1_1_coloring.html">FEAT::Adjacency::Coloring</a></div><div class="ttdoc">Coloring object implementation.</div><div class="ttdef"><b>Definition:</b> <a href="coloring_8hpp_source.html#l00031">coloring.hpp:32</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_adjacency_1_1_coloring_html_a24fb5326b73a7958cc9765cb24800ff7"><div class="ttname"><a href="class_f_e_a_t_1_1_adjacency_1_1_coloring.html#a24fb5326b73a7958cc9765cb24800ff7">FEAT::Adjacency::Coloring::create_partition_graph</a></div><div class="ttdeci">Graph create_partition_graph() const</div><div class="ttdoc">Creates a color partition graph.</div><div class="ttdef"><b>Definition:</b> <a href="coloring_8cpp_source.html#l00292">coloring.cpp:292</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_adjacency_1_1_graph_html"><div class="ttname"><a href="class_f_e_a_t_1_1_adjacency_1_1_graph.html">FEAT::Adjacency::Graph</a></div><div class="ttdoc">Adjacency Graph implementation.</div><div class="ttdef"><b>Definition:</b> <a href="graph_8hpp_source.html#l00034">graph.hpp:35</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_adjacency_1_1_graph_html_a6f1048d48ed38f3c4c6d91e4b083916f"><div class="ttname"><a href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#a6f1048d48ed38f3c4c6d91e4b083916f">FEAT::Adjacency::Graph::sort_indices</a></div><div class="ttdeci">void sort_indices()</div><div class="ttdoc">Sorts the image indices to non-descending order.</div><div class="ttdef"><b>Definition:</b> <a href="graph_8cpp_source.html#l00193">graph.cpp:193</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_adjacency_1_1_graph_html_a8a87e6dd2f0db7f8aa95c2ba2dda2c71"><div class="ttname"><a href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#a8a87e6dd2f0db7f8aa95c2ba2dda2c71">FEAT::Adjacency::Graph::get_domain_ptr</a></div><div class="ttdeci">Index * get_domain_ptr()</div><div class="ttdoc">Returns the domain pointer array.</div><div class="ttdef"><b>Definition:</b> <a href="graph_8hpp_source.html#l00342">graph.hpp:342</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_adjacency_1_1_graph_html_aa21920504d75a3b75324da3de9ae24b7"><div class="ttname"><a href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#aa21920504d75a3b75324da3de9ae24b7">FEAT::Adjacency::Graph::get_image_idx</a></div><div class="ttdeci">Index * get_image_idx()</div><div class="ttdoc">Returns the image node index array.</div><div class="ttdef"><b>Definition:</b> <a href="graph_8hpp_source.html#l00357">graph.hpp:357</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_adjacency_1_1_graph_html_aa9cdd4137ca4eb408ba30d03f592813a"><div class="ttname"><a href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#aa9cdd4137ca4eb408ba30d03f592813a">FEAT::Adjacency::Graph::degree</a></div><div class="ttdeci">Index degree(Index domain_node) const</div><div class="ttdoc">Returns the degree of a domain node.</div><div class="ttdef"><b>Definition:</b> <a href="graph_8hpp_source.html#l00316">graph.hpp:316</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_adjacency_1_1_graph_html_abe7d5a6fe5422d5015835bfd53cfb633"><div class="ttname"><a href="class_f_e_a_t_1_1_adjacency_1_1_graph.html#abe7d5a6fe5422d5015835bfd53cfb633">FEAT::Adjacency::Graph::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Clears the graph.</div><div class="ttdef"><b>Definition:</b> <a href="graph_8cpp_source.html#l00176">graph.cpp:176</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats_html"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html">FEAT::Assembly::DomainAssembler::ThreadStats</a></div><div class="ttdoc">Thread statistics helper class.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00408">domain_assembler.hpp:409</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats_html_a4e6c2653407e45f8deb835154fbb9f00"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a4e6c2653407e45f8deb835154fbb9f00">FEAT::Assembly::DomainAssembler::ThreadStats::micros_wait</a></div><div class="ttdeci">long long micros_wait</div><div class="ttdoc">microseconds spend waiting for mutex locks</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00416">domain_assembler.hpp:416</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats_html_a5e3857c0104fc4e9dd6d0ca768b9f984"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#a5e3857c0104fc4e9dd6d0ca768b9f984">FEAT::Assembly::DomainAssembler::ThreadStats::micros_assemble</a></div><div class="ttdeci">long long micros_assemble</div><div class="ttdoc">microseconds spend in actual assembly</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00414">domain_assembler.hpp:414</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats_html_abc34165675fed90258a75252edd5e994"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_thread_stats.html#abc34165675fed90258a75252edd5e994">FEAT::Assembly::DomainAssembler::ThreadStats::micros_total</a></div><div class="ttdeci">long long micros_total</div><div class="ttdoc">microseconds assembling in total</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00412">domain_assembler.hpp:412</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker_html"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html">FEAT::Assembly::DomainAssembler::Worker</a></div><div class="ttdoc">Worker thread data class.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00461">domain_assembler.hpp:462</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker_html_a158f6a90654968ec2e376604d2fed531"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a158f6a90654968ec2e376604d2fed531">FEAT::Assembly::DomainAssembler::Worker::_thread_stats</a></div><div class="ttdeci">ThreadStats &amp; _thread_stats</div><div class="ttdoc">the thread statistics</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00475">domain_assembler.hpp:475</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker_html_a1d06c26574b4d4ce9f9f4e4a7e43b70f"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a1d06c26574b4d4ce9f9f4e4a7e43b70f">FEAT::Assembly::DomainAssembler::Worker::~Worker</a></div><div class="ttdeci">virtual ~Worker()</div><div class="ttdoc">virtual destructor</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00550">domain_assembler.hpp:550</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker_html_a33174b5572f53b2ccd7262070fe104a9"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a33174b5572f53b2ccd7262070fe104a9">FEAT::Assembly::DomainAssembler::Worker::_thread_layers</a></div><div class="ttdeci">const std::vector&lt; Index &gt; &amp; _thread_layers</div><div class="ttdoc">the thread layers vector</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00485">domain_assembler.hpp:485</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker_html_a3790a118b6d01186f38d1795230c2a86"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a3790a118b6d01186f38d1795230c2a86">FEAT::Assembly::DomainAssembler::Worker::operator()</a></div><div class="ttdeci">void operator()()</div><div class="ttdoc">Evaluation operator.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00559">domain_assembler.hpp:559</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker_html_a3dd738db616b61bb35ac67a7ba66e840"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a3dd738db616b61bb35ac67a7ba66e840">FEAT::Assembly::DomainAssembler::Worker::_color_elements</a></div><div class="ttdeci">const std::vector&lt; Index &gt; &amp; _color_elements</div><div class="ttdoc">the color elements vector</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00481">domain_assembler.hpp:481</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker_html_a3ebfb66456e82cd06cb78ff2ded7f025"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a3ebfb66456e82cd06cb78ff2ded7f025">FEAT::Assembly::DomainAssembler::Worker::_job</a></div><div class="ttdeci">Job_ &amp; _job</div><div class="ttdoc">a reference to the assembly job</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00467">domain_assembler.hpp:467</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker_html_a40f3ec50bbc13b56b2d19547a096a57a"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a40f3ec50bbc13b56b2d19547a096a57a">FEAT::Assembly::DomainAssembler::Worker::_layer_elements</a></div><div class="ttdeci">const std::vector&lt; Index &gt; &amp; _layer_elements</div><div class="ttdoc">the layer elements vector</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00483">domain_assembler.hpp:483</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker_html_a41a9c6631a6d102d60d7b7a5843a732c"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a41a9c6631a6d102d60d7b7a5843a732c">FEAT::Assembly::DomainAssembler::Worker::_strategy</a></div><div class="ttdeci">const ThreadingStrategy _strategy</div><div class="ttdoc">the chosen threading strategy</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00471">domain_assembler.hpp:471</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker_html_a4679d65fa3c031cfd82ddc2f025eaab1"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a4679d65fa3c031cfd82ddc2f025eaab1">FEAT::Assembly::DomainAssembler::Worker::_work_layered</a></div><div class="ttdeci">bool _work_layered(std::unique_ptr&lt; TaskType &gt; task)</div><div class="ttdoc">Assembly worker implementation for layered (+sorted) strategy.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00726">domain_assembler.hpp:726</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker_html_a5c43ef61662dbdd926992534e980fabb"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a5c43ef61662dbdd926992534e980fabb">FEAT::Assembly::DomainAssembler::Worker::TaskType</a></div><div class="ttdeci">Job_::Task TaskType</div><div class="ttdoc">a typedef for the task</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00465">domain_assembler.hpp:465</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker_html_a6f45cd82464703d591a0674a338da36f"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a6f45cd82464703d591a0674a338da36f">FEAT::Assembly::DomainAssembler::Worker::_my_id</a></div><div class="ttdeci">const std::size_t _my_id</div><div class="ttdoc">id of this worker thread and total number of worker threads</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00469">domain_assembler.hpp:469</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker_html_a7a3eadfca1c65a7dfd114fc8d66cdfb3"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a7a3eadfca1c65a7dfd114fc8d66cdfb3">FEAT::Assembly::DomainAssembler::Worker::Worker</a></div><div class="ttdeci">Worker(Job_ &amp;job, std::size_t id, std::size_t num_workers, ThreadingStrategy strategy, ThreadStats &amp;thread_stats, std::mutex &amp;thread_mutex, std::vector&lt; ThreadFence &gt; &amp;thread_fences, const std::vector&lt; Index &gt; &amp;element_indices, const std::vector&lt; Index &gt; &amp;color_elements, const std::vector&lt; Index &gt; &amp;layer_elements, const std::vector&lt; Index &gt; &amp;thread_layers)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00526">domain_assembler.hpp:526</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker_html_a7cea8a1b49feec96e91097449c38aeff"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a7cea8a1b49feec96e91097449c38aeff">FEAT::Assembly::DomainAssembler::Worker::_element_indices</a></div><div class="ttdeci">const std::vector&lt; Index &gt; &amp; _element_indices</div><div class="ttdoc">the element indices vector</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00479">domain_assembler.hpp:479</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker_html_a8a1b5dba822d17637b9a672a6b823a74"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a8a1b5dba822d17637b9a672a6b823a74">FEAT::Assembly::DomainAssembler::Worker::_work_no_scatter</a></div><div class="ttdeci">bool _work_no_scatter(std::unique_ptr&lt; TaskType &gt; task)</div><div class="ttdoc">Assembly worker implementation for no-scatter assembly.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00669">domain_assembler.hpp:669</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker_html_a98363fbb9e28f811af53b2cadbcd2982"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a98363fbb9e28f811af53b2cadbcd2982">FEAT::Assembly::DomainAssembler::Worker::_thread_fences</a></div><div class="ttdeci">std::vector&lt; ThreadFence &gt; &amp; _thread_fences</div><div class="ttdoc">the thread fences vector</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00477">domain_assembler.hpp:477</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker_html_a9f74c65039325a799b41e73b365ba82f"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#a9f74c65039325a799b41e73b365ba82f">FEAT::Assembly::DomainAssembler::Worker::_work_colored</a></div><div class="ttdeci">bool _work_colored(std::unique_ptr&lt; TaskType &gt; task)</div><div class="ttdoc">Assembly worker implementation for colored strategy.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00851">domain_assembler.hpp:851</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker_html_ac90604b33bbbacc4bcd7b3c4cf7cbf59"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#ac90604b33bbbacc4bcd7b3c4cf7cbf59">FEAT::Assembly::DomainAssembler::Worker::_work_single</a></div><div class="ttdeci">bool _work_single(std::unique_ptr&lt; TaskType &gt; task)</div><div class="ttdoc">Assembly worker implementation for single-threaded strategy.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00618">domain_assembler.hpp:618</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker_html_ad7858fa7e0b0b2f2cf14fdf013ce562c"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler_1_1_worker.html#ad7858fa7e0b0b2f2cf14fdf013ce562c">FEAT::Assembly::DomainAssembler::Worker::_thread_mutex</a></div><div class="ttdeci">std::mutex &amp; _thread_mutex</div><div class="ttdoc">the free-to-use thread mutex</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00473">domain_assembler.hpp:473</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html">FEAT::Assembly::DomainAssembler</a></div><div class="ttdoc">Domain Integral Assembler class template.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00392">domain_assembler.hpp:393</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a02a036ef4ee28397c32c9e6e2665018a"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a02a036ef4ee28397c32c9e6e2665018a">FEAT::Assembly::DomainAssembler::set_max_worker_threads</a></div><div class="ttdeci">void set_max_worker_threads(std::size_t max_worker_threads)</div><div class="ttdoc">Sets the maximum number of worker threads.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01096">domain_assembler.hpp:1096</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a02f792b58a245b019acb44ee6c513527"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a02f792b58a245b019acb44ee6c513527">FEAT::Assembly::DomainAssembler::_element_indices</a></div><div class="ttdeci">std::vector&lt; Index &gt; _element_indices</div><div class="ttdoc">a vector of all elements to assemble on</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00956">domain_assembler.hpp:956</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a03494c7c14d3a52f06b6d3e4196f0c88"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a03494c7c14d3a52f06b6d3e4196f0c88">FEAT::Assembly::DomainAssembler::_compile</a></div><div class="ttdeci">void _compile()</div><div class="ttdoc">Compiles the domain assembler.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01423">domain_assembler.hpp:1423</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a047dfbc486082bbf11e5421b4c556a18"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a047dfbc486082bbf11e5421b4c556a18">FEAT::Assembly::DomainAssembler::_elem_neighbors</a></div><div class="ttdeci">Adjacency::Graph _elem_neighbors</div><div class="ttdoc">adjacency graph for element neighbors</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00952">domain_assembler.hpp:952</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a0b4d08f9bf86f081b4eb53176e32ec45"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a0b4d08f9bf86f081b4eb53176e32ec45">FEAT::Assembly::DomainAssembler::reduce_thread_stats</a></div><div class="ttdeci">ThreadStats reduce_thread_stats() const</div><div class="ttdoc">Reduces the thread statistics to a single object.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01408">domain_assembler.hpp:1408</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a1925bec919cdbc7be597f9a9b94fda9a"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a1925bec919cdbc7be597f9a9b94fda9a">FEAT::Assembly::DomainAssembler::_thread_fences</a></div><div class="ttdeci">std::vector&lt; ThreadFence &gt; _thread_fences</div><div class="ttdoc">a vector of thread fences</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00964">domain_assembler.hpp:964</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a1a500a4341d701b0f9897c116f81073e"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a1a500a4341d701b0f9897c116f81073e">FEAT::Assembly::DomainAssembler::_elems_at_vert</a></div><div class="ttdeci">Adjacency::Graph _elems_at_vert</div><div class="ttdoc">adjacency graph for elements-at-vertex</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00950">domain_assembler.hpp:950</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a1d90dc34a47c2ed8248163fcd29f6cb3"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a1d90dc34a47c2ed8248163fcd29f6cb3">FEAT::Assembly::DomainAssembler::_max_worker_threads</a></div><div class="ttdeci">std::size_t _max_worker_threads</div><div class="ttdoc">specifies the maximum number of worker threads to use</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00974">domain_assembler.hpp:974</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a207982e2e27facae34b98565a901ea30"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a207982e2e27facae34b98565a901ea30">FEAT::Assembly::DomainAssembler::_thread_mutex</a></div><div class="ttdeci">std::mutex _thread_mutex</div><div class="ttdoc">a mutex for free use by the worker threads</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00970">domain_assembler.hpp:970</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a24bc437160a8b5f9dc58332c475a68cb"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a24bc437160a8b5f9dc58332c475a68cb">FEAT::Assembly::DomainAssembler::_thread_layers</a></div><div class="ttdeci">std::vector&lt; Index &gt; _thread_layers</div><div class="ttdoc">a vector of thread layer blocks</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00962">domain_assembler.hpp:962</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a268f4111b0be792a9518ef480bac8e22"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a268f4111b0be792a9518ef480bac8e22">FEAT::Assembly::DomainAssembler::_threads</a></div><div class="ttdeci">std::vector&lt; std::thread &gt; _threads</div><div class="ttdoc">a vector of worker threads</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00968">domain_assembler.hpp:968</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a32f18bbbbdf44c393f5e0e1a0a1f8c98"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a32f18bbbbdf44c393f5e0e1a0a1f8c98">FEAT::Assembly::DomainAssembler::_element_mask</a></div><div class="ttdeci">std::vector&lt; char &gt; _element_mask</div><div class="ttdoc">an element mask vector</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00954">domain_assembler.hpp:954</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a3a9104e680713b95e2c4399a348f4b97"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a3a9104e680713b95e2c4399a348f4b97">FEAT::Assembly::DomainAssembler::_trafo</a></div><div class="ttdeci">const TrafoType &amp; _trafo</div><div class="ttdoc">a reference to the underlying trafo</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00946">domain_assembler.hpp:946</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a4895550bd235f0b177d44c84d8cdf04a"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a4895550bd235f0b177d44c84d8cdf04a">FEAT::Assembly::DomainAssembler::_compiled</a></div><div class="ttdeci">bool _compiled</div><div class="ttdoc">specifies whether the assembler has already been compiled</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00978">domain_assembler.hpp:978</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a49735f17652c5b12991d5bffd14da9f2"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a49735f17652c5b12991d5bffd14da9f2">FEAT::Assembly::DomainAssembler::DomainAssembler</a></div><div class="ttdeci">DomainAssembler(const DomainAssembler &amp;)=delete</div><div class="ttdoc">delete copy constructor</div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a54ce4df37dfd4222766a741f5b849499"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a54ce4df37dfd4222766a741f5b849499">FEAT::Assembly::DomainAssembler::_build_graphs</a></div><div class="ttdeci">void _build_graphs()</div><div class="ttdoc">Builds the element adjacencies graphs.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01495">domain_assembler.hpp:1495</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a55dd100242b5fe0a48515dd949effc19"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a55dd100242b5fe0a48515dd949effc19">FEAT::Assembly::DomainAssembler::compile</a></div><div class="ttdeci">void compile()</div><div class="ttdoc">Compiles the assembler for all elements that have been added manually.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01157">domain_assembler.hpp:1157</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a55f97addd79e921c65424002aafaf21f"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a55f97addd79e921c65424002aafaf21f">FEAT::Assembly::DomainAssembler::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Clears the assembler.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01021">domain_assembler.hpp:1021</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a57321922a430a9a10c0876e162496edb"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a57321922a430a9a10c0876e162496edb">FEAT::Assembly::DomainAssembler::compile_all_elements</a></div><div class="ttdeci">void compile_all_elements()</div><div class="ttdoc">Compiles the assembler for all elements of the underlying mesh.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01182">domain_assembler.hpp:1182</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a58d5aa8077dfda5ac492209158fa505a"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a58d5aa8077dfda5ac492209158fa505a">FEAT::Assembly::DomainAssembler::TrafoType</a></div><div class="ttdeci">Trafo_ TrafoType</div><div class="ttdoc">the underlying trafo type</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00396">domain_assembler.hpp:396</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a5abdfd541edf954c3df8e31b316a5fd7"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a5abdfd541edf954c3df8e31b316a5fd7">FEAT::Assembly::DomainAssembler::~DomainAssembler</a></div><div class="ttdeci">virtual ~DomainAssembler()</div><div class="ttdoc">virtual destructor</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01013">domain_assembler.hpp:1013</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a60e30df91e8e0332b1825c9e16b12d48"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a60e30df91e8e0332b1825c9e16b12d48">FEAT::Assembly::DomainAssembler::get_threading_strategy</a></div><div class="ttdeci">ThreadingStrategy get_threading_strategy() const</div><div class="ttdoc">Returns the threading strategy.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01141">domain_assembler.hpp:1141</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a64adf5a8939e644040d355c251ac136f"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a64adf5a8939e644040d355c251ac136f">FEAT::Assembly::DomainAssembler::get_max_worker_threads</a></div><div class="ttdeci">std::size_t get_max_worker_threads() const</div><div class="ttdoc">Returns the maximum number of worker threads.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01105">domain_assembler.hpp:1105</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a6968841ff89919a898e6bb084b8170a0"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a6968841ff89919a898e6bb084b8170a0">FEAT::Assembly::DomainAssembler::_build_thread_layers</a></div><div class="ttdeci">bool _build_thread_layers()</div><div class="ttdoc">Build the actual thread layers for the layered strategy.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01686">domain_assembler.hpp:1686</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a7379d2d7b9c483e5b0858c12b0c8667f"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a7379d2d7b9c483e5b0858c12b0c8667f">FEAT::Assembly::DomainAssembler::shape_dim</a></div><div class="ttdeci">static constexpr int shape_dim</div><div class="ttdoc">the shape dimension</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00400">domain_assembler.hpp:400</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a7bb2dc51f98f92bd55b741ed4026371b"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a7bb2dc51f98f92bd55b741ed4026371b">FEAT::Assembly::DomainAssembler::_build_layers</a></div><div class="ttdeci">void _build_layers(bool reverse, bool sorted)</div><div class="ttdoc">Builds the Cuthill-McKee layer graphs.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01543">domain_assembler.hpp:1543</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a7be4351570f5479fc5122163cc687f70"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a7be4351570f5479fc5122163cc687f70">FEAT::Assembly::DomainAssembler::_strategy</a></div><div class="ttdeci">ThreadingStrategy _strategy</div><div class="ttdoc">specifies the chosen threading strategy</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00972">domain_assembler.hpp:972</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a8096ae609313c8bac0e9b8812563ad91"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a8096ae609313c8bac0e9b8812563ad91">FEAT::Assembly::DomainAssembler::_thread_stats</a></div><div class="ttdeci">std::vector&lt; ThreadStats &gt; _thread_stats</div><div class="ttdoc">a vector of thread statistics</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00966">domain_assembler.hpp:966</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a81e7a1b5e7628c0e2e7d0b4eaf7a83b9"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a81e7a1b5e7628c0e2e7d0b4eaf7a83b9">FEAT::Assembly::DomainAssembler::_num_worker_threads</a></div><div class="ttdeci">std::size_t _num_worker_threads</div><div class="ttdoc">specifies the actual number of worker threads to use</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00976">domain_assembler.hpp:976</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a82a5b63e7c2d06e6546af610c00c98f6"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a82a5b63e7c2d06e6546af610c00c98f6">FEAT::Assembly::DomainAssembler::_layer_elements</a></div><div class="ttdeci">std::vector&lt; Index &gt; _layer_elements</div><div class="ttdoc">a vector of element layer offsets</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00960">domain_assembler.hpp:960</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a851cbdb5be8ce9a1de6629f67adbd81b"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a851cbdb5be8ce9a1de6629f67adbd81b">FEAT::Assembly::DomainAssembler::get_num_worker_threads</a></div><div class="ttdeci">std::size_t get_num_worker_threads() const</div><div class="ttdoc">Returns the actual number of worker threads.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01119">domain_assembler.hpp:1119</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a87e430ae603e0837c4b60e48a1f16e62"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a87e430ae603e0837c4b60e48a1f16e62">FEAT::Assembly::DomainAssembler::dump</a></div><div class="ttdeci">String dump() const</div><div class="ttdoc">Returns a string dump of various debugging information.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01347">domain_assembler.hpp:1347</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a8d4f46837749d60d6fbffe567543e196"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a8d4f46837749d60d6fbffe567543e196">FEAT::Assembly::DomainAssembler::DomainAssembler</a></div><div class="ttdeci">DomainAssembler(const TrafoType &amp;trafo)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00987">domain_assembler.hpp:987</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a8d80c1ac513d3bc2b0a32c06679f4978"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a8d80c1ac513d3bc2b0a32c06679f4978">FEAT::Assembly::DomainAssembler::get_trafo</a></div><div class="ttdeci">const Trafo_ &amp; get_trafo() const</div><div class="ttdoc">Returns a reference to the domain assembler's trafo.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01077">domain_assembler.hpp:1077</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a9525b6da98a3132c559fae05dbd540ac"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a9525b6da98a3132c559fae05dbd540ac">FEAT::Assembly::DomainAssembler::add_mesh_part</a></div><div class="ttdeci">void add_mesh_part(const Geometry::MeshPart&lt; MeshType &gt; &amp;mesh_part)</div><div class="ttdoc">Adds all elements of a mesh-part to the assembler.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01066">domain_assembler.hpp:1066</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_a9abfbff531993581e08b9ec03c7ecc90"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#a9abfbff531993581e08b9ec03c7ecc90">FEAT::Assembly::DomainAssembler::add_element</a></div><div class="ttdeci">void add_element(Index ielem)</div><div class="ttdoc">Adds a single element to the assembler.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01049">domain_assembler.hpp:1049</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_aa0ebc9afcf0c675c66ec3ed328faf312"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#aa0ebc9afcf0c675c66ec3ed328faf312">FEAT::Assembly::DomainAssembler::_color_elements</a></div><div class="ttdeci">std::vector&lt; Index &gt; _color_elements</div><div class="ttdoc">a vector of element color offsets</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00958">domain_assembler.hpp:958</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_ac6751d9ac3d3ed696cf232ba936ea7c6"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#ac6751d9ac3d3ed696cf232ba936ea7c6">FEAT::Assembly::DomainAssembler::MeshType</a></div><div class="ttdeci">TrafoType::MeshType MeshType</div><div class="ttdoc">the underlying mesh type</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00398">domain_assembler.hpp:398</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_acbb6f1a306815a85e5366bda3e1509cf"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#acbb6f1a306815a85e5366bda3e1509cf">FEAT::Assembly::DomainAssembler::assemble</a></div><div class="ttdeci">void assemble(Job_ &amp;job)</div><div class="ttdoc">Executes a domain assembly job (in parallel) by (multiple) worker threads.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01204">domain_assembler.hpp:1204</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_ad0d72b39e71c14e4d3895dea1cf09080"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#ad0d72b39e71c14e4d3895dea1cf09080">FEAT::Assembly::DomainAssembler::reset_thread_stats</a></div><div class="ttdeci">void reset_thread_stats()</div><div class="ttdoc">Resets the thread statistics.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01397">domain_assembler.hpp:1397</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_af05e452fa77c48fdd72852eb91ece17b"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#af05e452fa77c48fdd72852eb91ece17b">FEAT::Assembly::DomainAssembler::operator=</a></div><div class="ttdeci">DomainAssembler &amp; operator=(const DomainAssembler &amp;)=delete</div><div class="ttdoc">delete copy assignment operator</div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_af18e3fddef72ae0a2db2cb5b2fd09ce0"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#af18e3fddef72ae0a2db2cb5b2fd09ce0">FEAT::Assembly::DomainAssembler::get_element_indices</a></div><div class="ttdeci">const std::vector&lt; Index &gt; &amp; get_element_indices() const</div><div class="ttdoc">Returns the element indices vector.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01085">domain_assembler.hpp:1085</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_af65499e5e7d30e12548b3566cbe85fad"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#af65499e5e7d30e12548b3566cbe85fad">FEAT::Assembly::DomainAssembler::set_threading_strategy</a></div><div class="ttdeci">void set_threading_strategy(ThreadingStrategy strategy)</div><div class="ttdoc">Sets the desired threading strategy.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01132">domain_assembler.hpp:1132</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_af6a72c4c3bb66a01b76419bc0d50a246"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#af6a72c4c3bb66a01b76419bc0d50a246">FEAT::Assembly::DomainAssembler::_build_colors</a></div><div class="ttdeci">void _build_colors()</div><div class="ttdoc">Builds the color element vectors for the colored threading strategy.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01779">domain_assembler.hpp:1779</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_af9c5bc1b90e084fa6676a8ba2adc61e1"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#af9c5bc1b90e084fa6676a8ba2adc61e1">FEAT::Assembly::DomainAssembler::_verts_at_elem</a></div><div class="ttdeci">Adjacency::Graph _verts_at_elem</div><div class="ttdoc">adjacency graph for vertices-at-element</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00948">domain_assembler.hpp:948</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembler_html_afa988d856e8d9f676985fec6d2ece92d"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembler.html#afa988d856e8d9f676985fec6d2ece92d">FEAT::Assembly::DomainAssembler::assemble_master</a></div><div class="ttdeci">void assemble_master(Job_ &amp;job)</div><div class="ttdoc">Executes a domain assembly job directly on the calling thread.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l01316">domain_assembler.hpp:1316</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task_html"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html">FEAT::Assembly::DomainAssemblyJob::Task</a></div><div class="ttdoc">Domain assembly task class.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00240">domain_assembler.hpp:241</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task_html_a1b1086ca0cde0b36f53977a570dc4ec0"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#a1b1086ca0cde0b36f53977a570dc4ec0">FEAT::Assembly::DomainAssemblyJob::Task::finish</a></div><div class="ttdeci">void finish()</div><div class="ttdoc">Finishes the task on the current cell.</div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task_html_a39c463c5d4e1cf69b60ff25791b01d24"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#a39c463c5d4e1cf69b60ff25791b01d24">FEAT::Assembly::DomainAssemblyJob::Task::combine</a></div><div class="ttdeci">void combine()</div><div class="ttdoc">Finishes the overall assembly and combines all local results.</div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task_html_a4d64a2f88bf0f02202465bcc89fa4261"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#a4d64a2f88bf0f02202465bcc89fa4261">FEAT::Assembly::DomainAssemblyJob::Task::assemble</a></div><div class="ttdeci">void assemble()</div><div class="ttdoc">Performs the local assembly on the current cell.</div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task_html_a720e1b6f35f6999414249ac3f0a23399"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#a720e1b6f35f6999414249ac3f0a23399">FEAT::Assembly::DomainAssemblyJob::Task::Task</a></div><div class="ttdeci">Task(DomainAssemblyJob &amp;job)</div><div class="ttdoc">Mandatory Constructor.</div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task_html_a8d4786529216d37b6dc44fdcacde9232"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#a8d4786529216d37b6dc44fdcacde9232">FEAT::Assembly::DomainAssemblyJob::Task::prepare</a></div><div class="ttdeci">void prepare(Index cell)</div><div class="ttdoc">Prepares the task for assembly on a element/cell.</div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task_html_abb595bc13b8b96870cf565e60276324f"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#abb595bc13b8b96870cf565e60276324f">FEAT::Assembly::DomainAssemblyJob::Task::scatter</a></div><div class="ttdeci">void scatter()</div><div class="ttdoc">Scatters the local assembly into the global system.</div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task_html_ac46bb91fd5d6dc1421bb283a6ad174ab"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#ac46bb91fd5d6dc1421bb283a6ad174ab">FEAT::Assembly::DomainAssemblyJob::Task::need_scatter</a></div><div class="ttdeci">static constexpr bool need_scatter</div><div class="ttdoc">Specifies whether this task has a scatter() function, which is required to be called from within a cr...</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00247">domain_assembler.hpp:247</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task_html_ad92d9f4174acb3afcd1b2d2863de7f4b"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_1_1_task.html#ad92d9f4174acb3afcd1b2d2863de7f4b">FEAT::Assembly::DomainAssemblyJob::Task::need_combine</a></div><div class="ttdeci">static constexpr bool need_combine</div><div class="ttdoc">Specifies whether this task fas a combine() function, which is required to be called from within a cr...</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00253">domain_assembler.hpp:253</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_assembly_1_1_domain_assembly_job_html"><div class="ttname"><a href="class_f_e_a_t_1_1_assembly_1_1_domain_assembly_job.html">FEAT::Assembly::DomainAssemblyJob</a></div><div class="ttdoc">Interface description of a domain assembly job.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00169">domain_assembler.hpp:170</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_geometry_1_1_mesh_part_html"><div class="ttname"><a href="class_f_e_a_t_1_1_geometry_1_1_mesh_part.html">FEAT::Geometry::MeshPart</a></div><div class="ttdoc">Class template for partial meshes.</div><div class="ttdef"><b>Definition:</b> <a href="mesh__part_8hpp_source.html#l00091">mesh_part.hpp:92</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_string_html"><div class="ttname"><a href="class_f_e_a_t_1_1_string.html">FEAT::String</a></div><div class="ttdoc">String class implementation.</div><div class="ttdef"><b>Definition:</b> <a href="string_8hpp_source.html#l00045">string.hpp:47</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_string_html_ac8f44f2b1d8f4c2952538e8639319585"><div class="ttname"><a href="class_f_e_a_t_1_1_string.html#ac8f44f2b1d8f4c2952538e8639319585">FEAT::String::pad_front</a></div><div class="ttdeci">String pad_front(size_type len, char c=' ') const</div><div class="ttdoc">Pads the front of the string up to a desired length.</div><div class="ttdef"><b>Definition:</b> <a href="string_8hpp_source.html#l00393">string.hpp:393</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_time_stamp_html"><div class="ttname"><a href="class_f_e_a_t_1_1_time_stamp.html">FEAT::TimeStamp</a></div><div class="ttdoc">Time stamp class.</div><div class="ttdef"><b>Definition:</b> <a href="time__stamp_8hpp_source.html#l00055">time_stamp.hpp:56</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_time_stamp_html_a0a91ce5a9de136d7db0affac4218cf85"><div class="ttname"><a href="class_f_e_a_t_1_1_time_stamp.html#a0a91ce5a9de136d7db0affac4218cf85">FEAT::TimeStamp::stamp</a></div><div class="ttdeci">TimeStamp &amp; stamp()</div><div class="ttdoc">Stamps the current time-stamp.</div><div class="ttdef"><b>Definition:</b> <a href="time__stamp_8hpp_source.html#l00081">time_stamp.hpp:81</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_time_stamp_html_aa13f6c5955f4b04dc00ff264b9a0f842"><div class="ttname"><a href="class_f_e_a_t_1_1_time_stamp.html#aa13f6c5955f4b04dc00ff264b9a0f842">FEAT::TimeStamp::elapsed_micros</a></div><div class="ttdeci">long long elapsed_micros(const TimeStamp &amp;before) const</div><div class="ttdoc">Calculate the time elapsed between two time stamps in microseconds.</div><div class="ttdef"><b>Definition:</b> <a href="time__stamp_8hpp_source.html#l00137">time_stamp.hpp:137</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_time_stamp_html_af0d1fdd8e82363a860ea7c19f987701e"><div class="ttname"><a href="class_f_e_a_t_1_1_time_stamp.html#af0d1fdd8e82363a860ea7c19f987701e">FEAT::TimeStamp::elapsed_micros_now</a></div><div class="ttdeci">long long elapsed_micros_now() const</div><div class="ttdoc">Calculates the time elapsed between the time stamp and now in microseconds.</div><div class="ttdef"><b>Definition:</b> <a href="time__stamp_8hpp_source.html#l00159">time_stamp.hpp:159</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_adjacency_html_a85fc833108471df98e28d6b06324f3e7a1643ca58f467adb1a5dff48e854ef1bf"><div class="ttname"><a href="namespace_f_e_a_t_1_1_adjacency.html#a85fc833108471df98e28d6b06324f3e7a1643ca58f467adb1a5dff48e854ef1bf">FEAT::Adjacency::RenderType::injectify_sorted</a></div><div class="ttdeci">@ injectify_sorted</div><div class="ttdoc">Render-Injectified mode, sort image indices.</div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_adjacency_html_a85fc833108471df98e28d6b06324f3e7a382eb179a7d78f25d89c085988b37e95"><div class="ttname"><a href="namespace_f_e_a_t_1_1_adjacency.html#a85fc833108471df98e28d6b06324f3e7a382eb179a7d78f25d89c085988b37e95">FEAT::Adjacency::RenderType::transpose</a></div><div class="ttdeci">@ transpose</div><div class="ttdoc">Render-Transpose mode.</div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_assembly_html_a28186a335b7da11c0a4a2a3770462bf0"><div class="ttname"><a href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0">FEAT::Assembly::ThreadingStrategy</a></div><div class="ttdeci">ThreadingStrategy</div><div class="ttdoc">Threading Strategy for multi-threaded assembler.</div><div class="ttdef"><b>Definition:</b> <a href="domain__assembler_8hpp_source.html#l00031">domain_assembler.hpp:32</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_assembly_html_a28186a335b7da11c0a4a2a3770462bf0a028f0749e1b6a005abdfb9a3975d8c32"><div class="ttname"><a href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0a028f0749e1b6a005abdfb9a3975d8c32">FEAT::Assembly::ThreadingStrategy::colored</a></div><div class="ttdeci">@ colored</div><div class="ttdoc">Colored threading strategy.</div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_assembly_html_a28186a335b7da11c0a4a2a3770462bf0a2bd9c0ed00116be1258e0cc66617d7c8"><div class="ttname"><a href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0a2bd9c0ed00116be1258e0cc66617d7c8">FEAT::Assembly::ThreadingStrategy::automatic</a></div><div class="ttdeci">@ automatic</div><div class="ttdoc">Automatic threading strategy.</div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_assembly_html_a28186a335b7da11c0a4a2a3770462bf0a3c5097fb5c0edb92db17a1740f6ae4bf"><div class="ttname"><a href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0a3c5097fb5c0edb92db17a1740f6ae4bf">FEAT::Assembly::ThreadingStrategy::layered_sorted</a></div><div class="ttdeci">@ layered_sorted</div><div class="ttdoc">Layered + sorted threading strategy.</div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_assembly_html_a28186a335b7da11c0a4a2a3770462bf0a9442e6482c63def4c35bc13b704c52e2"><div class="ttname"><a href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0a9442e6482c63def4c35bc13b704c52e2">FEAT::Assembly::ThreadingStrategy::layered</a></div><div class="ttdeci">@ layered</div><div class="ttdoc">Layered threading strategy.</div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_assembly_html_a28186a335b7da11c0a4a2a3770462bf0add5c07036f2975ff4bce568b6511d3bc"><div class="ttname"><a href="namespace_f_e_a_t_1_1_assembly.html#a28186a335b7da11c0a4a2a3770462bf0add5c07036f2975ff4bce568b6511d3bc">FEAT::Assembly::ThreadingStrategy::single</a></div><div class="ttdeci">@ single</div><div class="ttdoc">Single-Threaded strategy.</div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_geometry_html_a9a08208ef110199cc9c70de1f8b83de6a028f0749e1b6a005abdfb9a3975d8c32"><div class="ttname"><a href="namespace_f_e_a_t_1_1_geometry.html#a9a08208ef110199cc9c70de1f8b83de6a028f0749e1b6a005abdfb9a3975d8c32">FEAT::Geometry::PermutationStrategy::colored</a></div><div class="ttdeci">@ colored</div><div class="ttdoc">colored permutation strategy a.k.a. &quot;red-black&quot; strategy</div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_math_html_a737d301e1e32f502778181d09b408407"><div class="ttname"><a href="namespace_f_e_a_t_1_1_math.html#a737d301e1e32f502778181d09b408407">FEAT::Math::min</a></div><div class="ttdeci">T_ min(T_ a, T_ b)</div><div class="ttdoc">Returns the minimum of two values.</div><div class="ttdef"><b>Definition:</b> <a href="math_8hpp_source.html#l00120">math.hpp:120</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_math_html_ae63636287332e32875ca28780966a810"><div class="ttname"><a href="namespace_f_e_a_t_1_1_math.html#ae63636287332e32875ca28780966a810">FEAT::Math::max</a></div><div class="ttdeci">T_ max(T_ a, T_ b)</div><div class="ttdoc">Returns the maximum of two values.</div><div class="ttdef"><b>Definition:</b> <a href="math_8hpp_source.html#l00134">math.hpp:134</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_html"><div class="ttname"><a href="namespace_f_e_a_t.html">FEAT</a></div><div class="ttdoc">FEAT namespace.</div><div class="ttdef"><b>Definition:</b> <a href="adjactor_8hpp_source.html#l00013">adjactor.hpp:14</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_html_a2f8928fdd8a94e9e3a4971f3231b5e77"><div class="ttname"><a href="namespace_f_e_a_t.html#a2f8928fdd8a94e9e3a4971f3231b5e77">FEAT::stringify_fp_fix</a></div><div class="ttdeci">String stringify_fp_fix(DataType_ value, int precision=0, int width=0, bool sign=false)</div><div class="ttdoc">Prints a floating point value to a string in fixed-point notation.</div><div class="ttdef"><b>Definition:</b> <a href="string_8hpp_source.html#l01117">string.hpp:1117</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_html_a5eca21c2244b8e23da100b311bcda535"><div class="ttname"><a href="namespace_f_e_a_t.html#a5eca21c2244b8e23da100b311bcda535">FEAT::stringify</a></div><div class="ttdeci">String stringify(const T_ &amp;item)</div><div class="ttdoc">Converts an item into a String.</div><div class="ttdef"><b>Definition:</b> <a href="string_8hpp_source.html#l00991">string.hpp:991</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_html_aea15318a59381180ea8b771242a3bbe1"><div class="ttname"><a href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">FEAT::Index</a></div><div class="ttdeci">std::uint64_t Index</div><div class="ttdoc">Index data type.</div><div class="ttdef"><b>Definition:</b> <a href="base__header_8hpp_source.html#l00118">base_header.hpp:118</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_dc43877d82dd332f9fb2071fcca799d6.html">kernel</a></li><li class="navelem"><a class="el" href="dir_f6ae2f7434b54b47883a194cb018900f.html">assembly</a></li><li class="navelem"><b>domain_assembler.hpp</b></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>

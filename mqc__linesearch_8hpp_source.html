<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FEAT: kernel/solver/mqc_linesearch.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">FEAT<span id="projectnumber">&#160;3</span>
   </div>
   <div id="projectbrief">Finite Element Analysis Toolbox</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('mqc__linesearch_8hpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">mqc_linesearch.hpp</div></div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// FEAT3: Finite Element Analysis Toolbox, Version 3</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">// Copyright (C) 2010 - 2023 by Stefan Turek &amp; the FEAT group</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">// FEAT3 is released under the GNU General Public License version 3,</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">// see the file &#39;copyright.txt&#39; in the top level directory for details.</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span> </div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#pragma once</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#ifndef FEAT_KERNEL_SOLVER_MQC_LINESEARCH</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#define FEAT_KERNEL_SOLVER_MQC_LINESEARCH 1</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &lt;<a class="code" href="base__header_8hpp.html">kernel/base_header.hpp</a>&gt;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#include &lt;kernel/solver/linesearch.hpp&gt;</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span> </div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_f_e_a_t.html">FEAT</a></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span>{</div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span>  <span class="keyword">namespace </span>Solver</div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span>  {</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Functional_, <span class="keyword">typename</span> Filter_&gt;</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html">   52</a></span>    <span class="keyword">class </span><a class="code hl_class" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html">MQCLinesearch</a> : <span class="keyword">public</span> <a class="code hl_class" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html">Linesearch</a>&lt;Functional_, Filter_&gt;</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>    {</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>      <span class="keyword">public</span>:</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a930aaba4d2cb4f5576f8915cbe20e966">   56</a></span>        <span class="keyword">typedef</span> Filter_ <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a930aaba4d2cb4f5576f8915cbe20e966">FilterType</a>;</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#ac96ddf166af524e8bcbd8811eee24dd3">   58</a></span>        <span class="keyword">typedef</span> <span class="keyword">typename</span> Functional_::VectorTypeR <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#ac96ddf166af524e8bcbd8811eee24dd3">VectorType</a>;</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">   60</a></span>        <span class="keyword">typedef</span> <span class="keyword">typename</span> Functional_::DataType <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>;</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#aaec597375935042fdeee5ff49d9e5dba">   62</a></span>        <span class="keyword">typedef</span> <a class="code hl_class" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html">Linesearch&lt;Functional_, Filter_&gt;</a> <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#aaec597375935042fdeee5ff49d9e5dba">BaseClass</a>;</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span> </div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>      <span class="keyword">protected</span>:</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a037e15c86b327857756b641ae32ebabf">   66</a></span>        <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a037e15c86b327857756b641ae32ebabf">_alpha_hard_max</a>;</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#aaaf1ebbd30f6e6dfeccb6fb4fff32cdd">   68</a></span>        <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#aaaf1ebbd30f6e6dfeccb6fb4fff32cdd">_alpha_hard_min</a>;</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a45d1421ff97be56ded264e5b60a62353">   70</a></span>        <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a45d1421ff97be56ded264e5b60a62353">_alpha_soft_max</a>;</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a7eed1de5dac3d51cdae54b3d16063bae">   72</a></span>        <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a7eed1de5dac3d51cdae54b3d16063bae">_alpha_soft_min</a>;</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span> </div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>      <span class="keyword">public</span>:</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a3e46c8212d61c6f0961f97e68f696a89">   88</a></span>        <span class="keyword">explicit</span> <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a3e46c8212d61c6f0961f97e68f696a89">MQCLinesearch</a>(Functional_&amp; functional, Filter_&amp; filter, <span class="keywordtype">bool</span> keep_iterates = <span class="keyword">false</span>) :</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>          <a class="code hl_class" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html">BaseClass</a>(<span class="stringliteral">&quot;MQC-LS&quot;</span>, functional, filter, keep_iterates),</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a037e15c86b327857756b641ae32ebabf">_alpha_hard_max</a>(<a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0)),</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#aaaf1ebbd30f6e6dfeccb6fb4fff32cdd">_alpha_hard_min</a>(<a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0)),</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a45d1421ff97be56ded264e5b60a62353">_alpha_soft_max</a>(<a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0)),</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a7eed1de5dac3d51cdae54b3d16063bae">_alpha_soft_min</a>(<a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0))</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>          {</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>          }</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a412c6301aa0750168b4dac17ed49f938">  113</a></span>        <span class="keyword">explicit</span> <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a412c6301aa0750168b4dac17ed49f938">MQCLinesearch</a>(<span class="keyword">const</span> <a class="code hl_class" href="class_f_e_a_t_1_1_string.html">String</a>&amp; section_name, <a class="code hl_class" href="class_f_e_a_t_1_1_property_map.html">PropertyMap</a>* section,</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>        Functional_&amp; functional, Filter_&amp; filter) :</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>          <a class="code hl_class" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html">BaseClass</a>(<span class="stringliteral">&quot;MQC-LS&quot;</span>, section_name, section, functional, filter),</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a037e15c86b327857756b641ae32ebabf">_alpha_hard_max</a>(<a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0)),</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#aaaf1ebbd30f6e6dfeccb6fb4fff32cdd">_alpha_hard_min</a>(<a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0)),</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a45d1421ff97be56ded264e5b60a62353">_alpha_soft_max</a>(<a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0)),</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a7eed1de5dac3d51cdae54b3d16063bae">_alpha_soft_min</a>(<a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0))</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>          {</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>          }</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span> </div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a7c13fe0975871dce382199d45f2d7b93">  124</a></span>        <span class="keyword">virtual</span> <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a7c13fe0975871dce382199d45f2d7b93">~MQCLinesearch</a>()</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>        {</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>        }</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span> </div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a2d8c159cd4fdfd1d9908d52d17b4666c">  129</a></span>        <span class="keyword">virtual</span> <a class="code hl_class" href="class_f_e_a_t_1_1_string.html">String</a> <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a2d8c159cd4fdfd1d9908d52d17b4666c">name</a>()<span class="keyword"> const override</span></div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span><span class="keyword">        </span>{</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>          <span class="keywordflow">return</span> <span class="stringliteral">&quot;MQCLinesearch&quot;</span>;</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>        }</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span> </div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#afc7ec16c39fc3217c6f1a9dd38b3c3e8">  135</a></span>        <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#afc7ec16c39fc3217c6f1a9dd38b3c3e8">reset</a>()<span class="keyword"> override</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span><span class="keyword">        </span>{</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>          <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#aa5944f939b4e98706eff002e1c4caa3e">BaseClass::reset</a>();</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a037e15c86b327857756b641ae32ebabf">_alpha_hard_max</a> = <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0);</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#aaaf1ebbd30f6e6dfeccb6fb4fff32cdd">_alpha_hard_min</a> = <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0);</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a45d1421ff97be56ded264e5b60a62353">_alpha_soft_max</a> = <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0);</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a7eed1de5dac3d51cdae54b3d16063bae">_alpha_soft_min</a> = <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0);</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>        }</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span> </div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#ab478c726b420d585b616027f965b75e6">  155</a></span>        <span class="keyword">virtual</span> <a class="code hl_enumeration" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35ed">Status</a> <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#ab478c726b420d585b616027f965b75e6">apply</a>(<a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#ac96ddf166af524e8bcbd8811eee24dd3">VectorType</a>&amp; vec_cor, <span class="keyword">const</span> <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#ac96ddf166af524e8bcbd8811eee24dd3">VectorType</a>&amp; vec_dir)<span class="keyword"> override</span></div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span><span class="keyword">        </span>{</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>          <span class="comment">// clear solution vector</span></div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>          vec_cor.format();</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>          this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a1678798c09d463bd121bf52812719ba9">_functional</a>.prepare(vec_cor, this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac2ed9d06b8fc5632e175864d6b0aec6c">_filter</a>);</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span> </div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>          <span class="comment">// apply</span></div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>          this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#a575442c5edf8721e18db2a49717f45a5">_status</a> = <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#af17bd5807f12d7e83137a18b07247af7">_apply_intern</a>(vec_cor, vec_dir);</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>          this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#abb072260d9458116ae6aa240d5685fb3">plot_summary</a>();</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>          <span class="keywordflow">return</span> this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#a575442c5edf8721e18db2a49717f45a5">_status</a>;</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>        }</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span> </div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a84aad9b507328de339e486f832a8fb4d">  178</a></span>        <span class="keyword">virtual</span> <a class="code hl_enumeration" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35ed">Status</a> <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a84aad9b507328de339e486f832a8fb4d">correct</a>(<a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#ac96ddf166af524e8bcbd8811eee24dd3">VectorType</a>&amp; vec_sol, <span class="keyword">const</span> <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#ac96ddf166af524e8bcbd8811eee24dd3">VectorType</a>&amp; vec_dir)<span class="keyword"> override</span></div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span><span class="keyword">        </span>{</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>          this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a1678798c09d463bd121bf52812719ba9">_functional</a>.prepare(vec_sol, this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac2ed9d06b8fc5632e175864d6b0aec6c">_filter</a>);</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span> </div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>          <span class="comment">// apply</span></div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>          this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#a575442c5edf8721e18db2a49717f45a5">_status</a> = <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#af17bd5807f12d7e83137a18b07247af7">_apply_intern</a>(vec_sol, vec_dir);</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>          this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#abb072260d9458116ae6aa240d5685fb3">plot_summary</a>();</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>          <span class="keywordflow">return</span> this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#a575442c5edf8721e18db2a49717f45a5">_status</a>;</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>        }</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span> </div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>      <span class="keyword">protected</span>:</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#af17bd5807f12d7e83137a18b07247af7">  203</a></span>        <span class="keyword">virtual</span> <a class="code hl_enumeration" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35ed">Status</a> <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#af17bd5807f12d7e83137a18b07247af7">_apply_intern</a>(<a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#ac96ddf166af524e8bcbd8811eee24dd3">VectorType</a>&amp; vec_sol, <span class="keyword">const</span> <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#ac96ddf166af524e8bcbd8811eee24dd3">VectorType</a>&amp; vec_dir)</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>        {</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>          Statistics::add_solver_expression(std::make_shared&lt;ExpressionStartSolve&gt;(this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a2d8c159cd4fdfd1d9908d52d17b4666c">name</a>()));</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span> </div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>          <span class="keyword">static</span> <span class="keyword">constexpr</span> DataType extrapolation_width = <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(4);</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>          <a class="code hl_enumeration" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35ed">Status</a> status(<a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35eda3c709b10a5d47ba33d85337dd9110917">Status::progress</a>);</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span> </div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>          <span class="comment">// The step length wrt. to the NORMALISED search direction</span></div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> alpha(0);</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>          <span class="comment">// The functional value</span></div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> fval(0);</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> df(0);</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span> </div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>          <span class="comment">// Perform initializations and checks</span></div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>          <a class="code hl_enumeration" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35ed">Status</a> st = this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a903b89f07e60974b07e6348291fc6741">_startup</a>(alpha, fval, df, vec_sol, vec_dir);</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>          <span class="comment">//alpha = this-&gt;_alpha_0;</span></div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>          <span class="keywordflow">if</span>(st != <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35eda3c709b10a5d47ba33d85337dd9110917">Status::progress</a>)</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>          {</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>            <span class="keywordflow">return</span> st;</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>          }</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span> </div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>          <span class="comment">// Scaling if we are to use step sizes wrt. to the non-normalized search direction</span></div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>          <span class="comment">// This appears to be the right thing theoretically, but in practice not using the search direction norm as</span></div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>          <span class="comment">// initial guess for the step size works better. Stupid reality...</span></div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>          <span class="comment">//if(this-&gt;_dir_scaling)</span></div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>          <span class="comment">//{</span></div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>          <span class="comment">//  alpha = this-&gt;_norm_dir;</span></div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>          <span class="comment">//}</span></div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span> </div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>          <span class="comment">// Set hard limits to default values if they have not been set</span></div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#aaaf1ebbd30f6e6dfeccb6fb4fff32cdd">_alpha_hard_min</a> = <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0);</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>          <span class="comment">// This bogus value should be around 1e50 for double precision. It is chosen to make comparing results with</span></div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>          <span class="comment">// ALGLIB easier</span></div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>          <span class="keywordflow">if</span>(<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a037e15c86b327857756b641ae32ebabf">_alpha_hard_max</a> &lt; Math::eps&lt;DataType&gt;())</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>          {</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>            <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a037e15c86b327857756b641ae32ebabf">_alpha_hard_max</a> = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a564d69313ee91de438926de491613096">Math::pow</a>(Math::huge&lt;DataType&gt;(), <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0.1622));</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>          }</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span> </div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>          <span class="comment">// Set the intervall of uncertainty</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a7eed1de5dac3d51cdae54b3d16063bae">_alpha_soft_min</a> = <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0);</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>          <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a45d1421ff97be56ded264e5b60a62353">_alpha_soft_max</a> = this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#acac79b1fb48d0d47da2bfcd987afb9c1">_alpha_0</a> + extrapolation_width*this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#acac79b1fb48d0d47da2bfcd987afb9c1">_alpha_0</a>;</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>          _alpha_soft_max = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a737d301e1e32f502778181d09b408407">Math::min</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a45d1421ff97be56ded264e5b60a62353">_alpha_soft_max</a>, <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a037e15c86b327857756b641ae32ebabf">_alpha_hard_max</a>);</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span> </div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>          <span class="comment">//std::cout &lt;&lt; &quot;Linesearch initial alpha &quot; &lt;&lt; this-&gt;_alpha_0 &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span> </div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> alpha_lo(0);</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>          <span class="comment">// It is critical that _f_0 was set from the outside!</span></div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> fval_lo(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a4dc1746ed5b84277a02c48e1804538ef">_fval_0</a>);</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>          DataType df_lo(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#aa6cf349be86b034e98d0a751ad6859f5">_delta_0</a>);</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span> </div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>          DataType alpha_hi(0);</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> fval_hi(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a4dc1746ed5b84277a02c48e1804538ef">_fval_0</a>);</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>          DataType df_hi(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#aa6cf349be86b034e98d0a751ad6859f5">_delta_0</a>);</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span> </div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>          <span class="comment">// This is the width of the search interval</span></div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>          DataType width(<a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a286aac96ac3f73267cf1cca71bd79c27">Math::abs</a>(<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a037e15c86b327857756b641ae32ebabf">_alpha_hard_max</a> - <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#aaaf1ebbd30f6e6dfeccb6fb4fff32cdd">_alpha_hard_min</a>));</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> width_old(<a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(2)*width);</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span> </div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>          <span class="comment">// Do we know the interval of uncertainty?</span></div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>          <span class="keywordtype">bool</span> interval_known(<span class="keyword">false</span>);</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>          <span class="comment">// Is the minimum in the interval of uncertainty?</span></div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>          <span class="keywordtype">bool</span> min_in_interval(<span class="keyword">false</span>);</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>          <span class="comment">// Does the minimum lie outside the current search interval, requiring us to drive the step to its</span></div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>          <span class="comment">// boundary?</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>          <span class="keywordtype">bool</span> drive_to_bndry(<span class="keyword">false</span>);</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span> </div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>          <span class="comment">// start iterating</span></div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>          <span class="keywordflow">while</span>(status == <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35eda3c709b10a5d47ba33d85337dd9110917">Status::progress</a>)</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>          {</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span> </div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>            <a class="code hl_class" href="class_f_e_a_t_1_1_solver_1_1_iteration_stats.html">IterationStats</a> stat(*<span class="keyword">this</span>);</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>            ++(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#aa5524e82d3d153e57af1787421c0ec90">_num_iter</a>);</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span> </div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>            <span class="comment">// If we know the minimum is in the search interval, the interval of uncertainty is the search interval</span></div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>            <span class="keywordflow">if</span>(min_in_interval)</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>            {</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>              <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a7eed1de5dac3d51cdae54b3d16063bae">_alpha_soft_min</a> = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a737d301e1e32f502778181d09b408407">Math::min</a>(alpha_lo, alpha_hi);</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>              <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a45d1421ff97be56ded264e5b60a62353">_alpha_soft_max</a> = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#ae63636287332e32875ca28780966a810">Math::max</a>(alpha_lo, alpha_hi);</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>            }</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>            <span class="comment">// Enlarge the interval of uncertainty</span></div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>            {</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>              <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a7eed1de5dac3d51cdae54b3d16063bae">_alpha_soft_min</a> = alpha_lo;</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>              <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a45d1421ff97be56ded264e5b60a62353">_alpha_soft_max</a> = alpha + extrapolation_width*<a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a286aac96ac3f73267cf1cca71bd79c27">Math::abs</a>(alpha - alpha_lo);</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>            }</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>            <span class="comment">//std::cout &lt;&lt; &quot;Set alpha_smin &quot; &lt;&lt; _alpha_soft_min &lt;&lt; &quot; alpha_smax &quot; &lt;&lt; _alpha_soft_max &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span> </div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>            <span class="comment">// Update solution: sol &lt;- initial_sol + _alpha*dir</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>            vec_sol.axpy(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a92961d837ffc56d85cff3b820340eb2a">_vec_pn</a>, this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a27ba39cc738b9a4fa6208feb779ca42d">_vec_initial_sol</a>, alpha);</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>            <span class="comment">//std::cout &lt;&lt; &quot;Linesearch alpha &quot; &lt;&lt; alpha &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>            <span class="comment">//std::cout &lt;&lt; &quot;initial_sol &quot; &lt;&lt; *(this-&gt;_vec_initial_sol) &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>            <span class="comment">//std::cout &lt;&lt; &quot;dir &quot; &lt;&lt; *this-&gt;_vec_pn &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>            <span class="comment">//std::cout &lt;&lt; &quot;sol &quot; &lt;&lt; *vec_sol &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span> </div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>            <span class="comment">// Prepare and evaluate</span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>            this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a1678798c09d463bd121bf52812719ba9">_functional</a>.prepare(vec_sol, this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac2ed9d06b8fc5632e175864d6b0aec6c">_filter</a>);</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span> </div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>            <span class="comment">// Compute and filter the gradient</span></div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>            this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a1678798c09d463bd121bf52812719ba9">_functional</a>.eval_fval_grad(fval, this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a0d4201e4324ec13233def993318e44f2">_vec_grad</a>);</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>            this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a4274068c4e97f9636c48f4c932bfe7b1">trim_func_grad</a>(fval);</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>            this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac2ed9d06b8fc5632e175864d6b0aec6c">_filter</a>.filter_def(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a0d4201e4324ec13233def993318e44f2">_vec_grad</a>);</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span> </div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>            <span class="comment">// New directional derivative and new defect</span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>            df = this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a92961d837ffc56d85cff3b820340eb2a">_vec_pn</a>.dot(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a0d4201e4324ec13233def993318e44f2">_vec_grad</a>);</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>            status = this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#aeb397e3e98d6e2edb5e4ee5cb8f73082">_check_convergence</a>(fval, df, alpha);</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span> </div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>            <span class="comment">// If success is reported, check if it is a real success or if something fishy is going on</span></div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>            <span class="keywordflow">if</span>(status == <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35eda260ca9dd8a4577fc00b7bd5810298076">Status::success</a>)</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>            {</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>              this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ae856346c0f498690e441ceefe6edd212">_vec_tmp</a>.axpy(vec_sol, this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a27ba39cc738b9a4fa6208feb779ca42d">_vec_initial_sol</a>, -<a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(1));</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>              <span class="keywordflow">if</span>(fval &gt;= this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a4dc1746ed5b84277a02c48e1804538ef">_fval_0</a> || this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ae856346c0f498690e441ceefe6edd212">_vec_tmp</a>.norm2() == DataType(0))</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>              {</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>                status = <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35edaa3d1e0a7dd736bc430ba471d9dfdf3a2">Status::stagnated</a>;</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>              }</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>            }</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>            <span class="comment">// If we are not successful, check if the interval of uncertainty has become too small</span></div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(min_in_interval &amp;&amp; (<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a45d1421ff97be56ded264e5b60a62353">_alpha_soft_max</a> - <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a7eed1de5dac3d51cdae54b3d16063bae">_alpha_soft_min</a>) &lt;= this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ade3e6601c1d2a6d2cfbed7437c13bb11">_tol_step</a>*_alpha_soft_max)</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>            {</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>              <span class="comment">//std::cout &lt;&lt; &quot;interval width &quot; &lt;&lt; _alpha_soft_max - _alpha_soft_min &lt;&lt; &quot; : &quot; &lt;&lt; this-&gt;_tol_step*_alpha_soft_max &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>              status = <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35edaa3d1e0a7dd736bc430ba471d9dfdf3a2">Status::stagnated</a>;</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>            }</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>            <span class="comment">// Stagnation due to rounding errors</span></div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>            <span class="comment">//if(min_in_interval &amp;&amp; (alpha &lt;= _alpha_soft_min || alpha &gt;= _alpha_soft_max))</span></div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>            <span class="comment">//{</span></div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>            <span class="comment">//  std::cout &lt;&lt; &quot;Rounding errors&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>            <span class="comment">//  status = Status::stagnated;</span></div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>            <span class="comment">//}</span></div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>            <span class="comment">// This is not used at the moment because it is only relevant if there are constraints limiting the</span></div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>            <span class="comment">// step length</span></div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>            <span class="comment">//if( alpha == _alpha_hard_max)</span></div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>            <span class="comment">//if( alpha == _alpha_hard_min)</span></div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span> </div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>            <span class="keywordflow">if</span>(status != <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35eda3c709b10a5d47ba33d85337dd9110917">Status::progress</a>)</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>            {</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>            }</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span> </div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>            <span class="keywordflow">if</span>(!interval_known</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>                &amp;&amp; (fval &lt; this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a4dc1746ed5b84277a02c48e1804538ef">_fval_0</a> + this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac5990a1f2ff4f600e868b8fd15b96079">_tol_decrease</a>*alpha*this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#aa6cf349be86b034e98d0a751ad6859f5">_delta_0</a>)</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>                &amp;&amp; (df &gt;= <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a737d301e1e32f502778181d09b408407">Math::min</a>(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac5990a1f2ff4f600e868b8fd15b96079">_tol_decrease</a>, this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a74d7d176a5ffdf55d5eb6144f3d9ce66">_tol_curvature</a>)))</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>                {</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>                  interval_known = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>                }</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span> </div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>            <span class="comment">//std::cout &lt;&lt; &quot;interval known &quot; &lt;&lt; interval_known &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>            <span class="comment">// If we do not know that the minimum was in the previous interval of uncertainty, we need to compute a</span></div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>            <span class="comment">// new step size to expand the interval of uncertainty at the start of the next iteration.</span></div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>            <span class="keywordflow">if</span>(!interval_known &amp;&amp; (fval &lt;= fval_lo)</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>                &amp;&amp; fval &gt; this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a4dc1746ed5b84277a02c48e1804538ef">_fval_0</a> + alpha*this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac5990a1f2ff4f600e868b8fd15b96079">_tol_decrease</a>*this-&gt;_delta_0)</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>            {</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>              <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> fval_m(fval - alpha*this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac5990a1f2ff4f600e868b8fd15b96079">_tol_decrease</a>*this-&gt;_delta_0);</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>              <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> df_m(df - this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac5990a1f2ff4f600e868b8fd15b96079">_tol_decrease</a>*this-&gt;_delta_0);</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>              <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> fval_lo_m(fval_lo - alpha_lo*this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac5990a1f2ff4f600e868b8fd15b96079">_tol_decrease</a>*this-&gt;_delta_0);</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>              <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> df_lo_m(df_lo - this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac5990a1f2ff4f600e868b8fd15b96079">_tol_decrease</a>*this-&gt;_delta_0);</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>              <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> fval_hi_m(fval_hi - alpha_hi*this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac5990a1f2ff4f600e868b8fd15b96079">_tol_decrease</a>*this-&gt;_delta_0);</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>              <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> df_hi_m(df_hi - this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac5990a1f2ff4f600e868b8fd15b96079">_tol_decrease</a>*this-&gt;_delta_0);</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span> </div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>              <span class="comment">// Note that the expansion step might already give us the information that the minimum is the the</span></div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>              <span class="comment">// new search interval</span></div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>              <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#ac964c483886d3f23e54fb5d3e65f7c64">_polynomial_fit</a>(</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>                alpha, fval_m, df_m, alpha_lo, fval_lo_m, df_lo_m,</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>                alpha_hi, fval_hi_m, df_hi_m, min_in_interval, drive_to_bndry);</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span> </div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>              fval_lo = fval_lo_m + alpha_lo*this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac5990a1f2ff4f600e868b8fd15b96079">_tol_decrease</a>*this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#aa6cf349be86b034e98d0a751ad6859f5">_delta_0</a>;</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>              df_lo = df_lo_m + this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac5990a1f2ff4f600e868b8fd15b96079">_tol_decrease</a>*this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#aa6cf349be86b034e98d0a751ad6859f5">_delta_0</a>;</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>              fval_hi = fval_hi_m * alpha_hi*this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac5990a1f2ff4f600e868b8fd15b96079">_tol_decrease</a>*this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#aa6cf349be86b034e98d0a751ad6859f5">_delta_0</a>;</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>              df_hi = df_hi_m + this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac5990a1f2ff4f600e868b8fd15b96079">_tol_decrease</a>*this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#aa6cf349be86b034e98d0a751ad6859f5">_delta_0</a>;</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span> </div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>            }</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>            {</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>              <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#ac964c483886d3f23e54fb5d3e65f7c64">_polynomial_fit</a>(alpha, fval, df, alpha_lo, fval_lo, df_lo, alpha_hi, fval_hi, df_hi, min_in_interval,</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>              drive_to_bndry);</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span> </div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>              <span class="comment">//std::cout &lt;&lt; &quot;width &quot; &lt;&lt; width &lt;&lt; &quot; width_old &quot; &lt;&lt; width_old &lt;&lt; &quot; min_in_interval &quot; &lt;&lt; min_in_interval &lt;&lt;std::endl;</span></div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span> </div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>              <span class="keywordflow">if</span>(min_in_interval)</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>              {</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>                <span class="keywordflow">if</span>(<a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a286aac96ac3f73267cf1cca71bd79c27">Math::abs</a>(alpha_hi - alpha_lo) &gt;= <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0.66)*width_old)</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>                {</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>                  <span class="comment">//std::cout &lt;&lt; &quot;Forcing &quot; &lt;&lt; alpha &lt;&lt; &quot; to &quot;;</span></div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>                  alpha = alpha_lo + <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0.5)*(alpha_hi - alpha_lo);</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>                  <span class="comment">//std::cout &lt;&lt; alpha &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>                }</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>                width_old = width;</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>                width = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a286aac96ac3f73267cf1cca71bd79c27">Math::abs</a>(alpha_lo - alpha_hi);</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>              }</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>            }</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span> </div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>          } <span class="comment">// while(status == Status:progress)</span></div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span> </div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>          this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ad8716d5245471de11330a2f693d6f4f2">_alpha_min</a> = alpha;</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>          this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#aab60dec26fb66c0cd2faeac189467f8f">_fval_min</a> = fval;</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span> </div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>          <span class="comment">// If we are successful, we save the last step length as the new initial step length</span></div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>          <span class="keywordflow">if</span>(status == <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35eda260ca9dd8a4577fc00b7bd5810298076">Status::success</a>)</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>          {</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>            this-&gt;_alpha_0 = this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ad8716d5245471de11330a2f693d6f4f2">_alpha_min</a>;</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>          }</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>          <span class="comment">// If we are not successful, we update the best step length and need to re-evaluate everything for that</span></div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>          <span class="comment">// step</span></div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>          <span class="keywordflow">else</span></div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>          {</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>            this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ad8716d5245471de11330a2f693d6f4f2">_alpha_min</a> = alpha_lo;</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>            this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#aab60dec26fb66c0cd2faeac189467f8f">_fval_min</a> = fval_lo;</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>            <span class="comment">//std::cout &lt;&lt; &quot;Unusual termination alpha_lo &quot; &lt;&lt; alpha_lo &lt;&lt; &quot;fval_lo &quot; &lt;&lt; fval_lo &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>            vec_sol.axpy(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a92961d837ffc56d85cff3b820340eb2a">_vec_pn</a>, this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a27ba39cc738b9a4fa6208feb779ca42d">_vec_initial_sol</a>, alpha_lo);</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span> </div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>            <span class="comment">// Prepare and evaluate</span></div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>            this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a1678798c09d463bd121bf52812719ba9">_functional</a>.prepare(vec_sol, this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac2ed9d06b8fc5632e175864d6b0aec6c">_filter</a>);</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>            this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a1678798c09d463bd121bf52812719ba9">_functional</a>.eval_fval_grad(fval, this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a0d4201e4324ec13233def993318e44f2">_vec_grad</a>);</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>            this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a4274068c4e97f9636c48f4c932bfe7b1">trim_func_grad</a>(fval);</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>            this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac2ed9d06b8fc5632e175864d6b0aec6c">_filter</a>.filter_def(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a0d4201e4324ec13233def993318e44f2">_vec_grad</a>);</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>          }</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span> </div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>          Statistics::add_solver_expression(std::make_shared&lt;ExpressionEndSolve&gt;(this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a2d8c159cd4fdfd1d9908d52d17b4666c">name</a>(), status, this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#a4d6b6c7809c161f59cbaf7cb01149178">get_num_iter</a>()));</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>          <span class="keywordflow">return</span> status;</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>        }</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span> </div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#ac964c483886d3f23e54fb5d3e65f7c64">  469</a></span>        <a class="code hl_enumeration" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35ed">Status</a> <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#ac964c483886d3f23e54fb5d3e65f7c64">_polynomial_fit</a>(</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>&amp; alpha, <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>&amp; fval, <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>&amp; df,</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>&amp; alpha_lo, <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>&amp; fval_lo, <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>&amp; df_lo,</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>&amp; alpha_hi, <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>&amp; fval_hi, <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>&amp; df_hi,</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>          <span class="keywordtype">bool</span>&amp; min_in_interval, <span class="keywordtype">bool</span>&amp; drive_to_bndry)</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>        {</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> alpha_c(0);</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> alpha_q(0);</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> alpha_new(0);</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span> </div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>          <span class="comment">// Case 1: The function value increased.</span></div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>          <span class="keywordflow">if</span>( fval &gt; fval_lo)</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>          {</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>            <span class="comment">// Computation of cubic step</span></div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>            alpha_c  = <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#aa60190aa635ed9e1be6b14f8a5c765e6">_argmin_cubic</a>(alpha_lo, fval_lo, df_lo, alpha, fval, df);</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>            <span class="comment">// The first derivative was negative, but the function value increases, so the minimum has to be in this</span></div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>            <span class="comment">// interval (or have been in the original interval, which this interval is a subset of)</span></div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>            min_in_interval = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>            drive_to_bndry = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>            <span class="comment">// Use 2nd order approximation NOT using the derivative df because it might be garbage (i.e. if we hit a</span></div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>            <span class="comment">// singularity) because the function value increased</span></div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>            alpha_q = <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a634ac681d806bb44db198f0f59983b91">_argmin_quadratic</a>(alpha_lo, fval_lo, df_lo, alpha, fval, df, <span class="keyword">false</span>);</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span> </div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>            <span class="comment">// If the cubic minimum is closer to the old best step length, take it. Otherwise, take the mean</span></div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>            <span class="keywordflow">if</span>(<a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a286aac96ac3f73267cf1cca71bd79c27">Math::abs</a>(alpha_c - alpha_lo) &lt; <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a286aac96ac3f73267cf1cca71bd79c27">Math::abs</a>(alpha_q - alpha_lo))</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>              alpha_new = alpha_c;</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>              alpha_new = (alpha_q + alpha_c)/<a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(2);</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>            <span class="comment">//std::cout &lt;&lt; &quot;Case 1: alpha &quot; &lt;&lt; alpha_new &lt;&lt; &quot; q &quot; &lt;&lt; alpha_q &lt;&lt; &quot; c &quot; &lt;&lt; alpha_c &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span> </div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>          }</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>          <span class="comment">// Case 2: The first derivative changes sign</span></div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>          <span class="comment">// We also know that the function value increased in the last trial step</span></div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span>( df_lo*df &lt; <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0) )</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>          {</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>            alpha_c  = <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#aa60190aa635ed9e1be6b14f8a5c765e6">_argmin_cubic</a>(alpha, fval, df, alpha_lo, fval_lo, df_lo);</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>            <span class="comment">// Because the derivative changed sign, it has to be zero somewhere in between, so the minimum is in the</span></div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>            <span class="comment">// current interval</span></div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>            min_in_interval = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>            drive_to_bndry = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>            <span class="comment">// Default: Quadratic interpolant using fval_lo, df_lo and df</span></div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>            alpha_q = <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a634ac681d806bb44db198f0f59983b91">_argmin_quadratic</a>(alpha_lo, fval_lo, df_lo, alpha, fval, df, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>            <span class="comment">// Take the step closer to the new step alpha</span></div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>            <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a286aac96ac3f73267cf1cca71bd79c27">Math::abs</a>(alpha - alpha_c) &gt; <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a286aac96ac3f73267cf1cca71bd79c27">Math::abs</a>(alpha - alpha_q) ? alpha_new = alpha_c : alpha_new = alpha_q;</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>            <span class="comment">//std::cout &lt;&lt; &quot;Case 2: alpha &quot; &lt;&lt; alpha_new &lt;&lt; &quot; q &quot; &lt;&lt; alpha_q &lt;&lt; &quot; c &quot; &lt;&lt; alpha_c &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>          }</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>          <span class="comment">// Case 3: The absolute value of the derivative increases</span></div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>          <span class="comment">// We also know that the function value increased in the last trial step and that the derivative did not</span></div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>          <span class="comment">// change sign.</span></div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>          <span class="comment">// This means we have to further search in the direction of alpha.</span></div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a286aac96ac3f73267cf1cca71bd79c27">Math::abs</a>(df) &lt; <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a286aac96ac3f73267cf1cca71bd79c27">Math::abs</a>(df_lo))</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>          {</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>            alpha_c  = <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a41a9a9f80ce9e2355297cb3808d8e47f">_argmin_cubic_case_3</a>(alpha, fval, df, alpha_lo, fval_lo, df_lo);</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>            drive_to_bndry = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span> </div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>            <span class="comment">// Quadratic interpolant using fval_lo, df_lo and df</span></div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>            alpha_q = <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a634ac681d806bb44db198f0f59983b91">_argmin_quadratic</a>(alpha, fval, df, alpha_lo, fval_lo, df_lo, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span> </div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>            <span class="comment">// If the cubic step is closer to the trial step</span></div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>            <span class="keywordflow">if</span>(<a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a286aac96ac3f73267cf1cca71bd79c27">Math::abs</a>(alpha - alpha_c) &lt; <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a286aac96ac3f73267cf1cca71bd79c27">Math::abs</a>(alpha - alpha_q))</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>            {</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>              min_in_interval ? alpha_new = alpha_c : alpha_new = alpha_q;</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>            }</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>            {</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>              min_in_interval ? alpha_new = alpha_q : alpha_new = alpha_c;</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>            }</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>            <span class="comment">//std::cout &lt;&lt; &quot;Case 3: alpha &quot; &lt;&lt; alpha_new &lt;&lt; &quot; q &quot; &lt;&lt; alpha_q &lt;&lt; &quot; c &quot; &lt;&lt; alpha_c &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>          }</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>          <span class="comment">// Case 4: The absolute value of the derivative did not increase</span></div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>          <span class="comment">// We also know that the function value increased in the last trial step and that the derivative did not</span></div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>          <span class="comment">// change sign.</span></div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>          <span class="keywordflow">else</span></div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>          {</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>            drive_to_bndry = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>            <span class="comment">// Note that the arguments for argmin_cubic are different in this case</span></div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>            <span class="comment">// Here we can just take the cubic step because the cubic interpolation sets it to the alpha_soft_max</span></div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>            <span class="comment">// if it recognises that the minimum is outside the current interval.</span></div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>            <span class="keywordflow">if</span>(min_in_interval)</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>            {</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>              alpha_c  = <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#aa60190aa635ed9e1be6b14f8a5c765e6">_argmin_cubic</a>(alpha, fval , df, alpha_hi, fval_hi, df_hi);</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>              alpha_new = alpha_c;</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>            }</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>            {</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>              alpha &gt; alpha_lo ? alpha_new = <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a45d1421ff97be56ded264e5b60a62353">_alpha_soft_max</a> : alpha_new = <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a7eed1de5dac3d51cdae54b3d16063bae">_alpha_soft_min</a>;</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>            }</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>            <span class="comment">//std::cout &lt;&lt; &quot;Case 4: alpha &quot; &lt;&lt; alpha_new &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>          }</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span> </div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>            <span class="comment">// Update the inverval of uncertainty. Has to happen befor we clamp the step to the admissible interval.</span></div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>            <span class="comment">// Check which step(s) we need to replace</span></div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>            <span class="keywordflow">if</span>(fval &gt; fval_lo)</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>            {</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>              alpha_hi = alpha;</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>              fval_hi = fval;</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>              df_hi = df;</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>            }</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>            {</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>              <span class="keywordflow">if</span>(df * df_lo &lt; <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0))</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>              {</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>                alpha_hi = alpha_lo;</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>                fval_hi = fval_lo;</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>                df_hi = df_lo;</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>              }</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>              alpha_lo = alpha;</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>              fval_lo = fval;</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>              df_lo = df;</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>            }</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span> </div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>            <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#ad555e8822e9cfafd2439892f03096242">_clamp_step</a>(alpha_new);</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span> </div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>            <span class="comment">// If we know the minimum is in the interval, we can drive alpha to the corresponding end more quickly</span></div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>            <span class="keywordflow">if</span>(min_in_interval &amp;&amp; drive_to_bndry)</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>            {</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>              <span class="comment">//std::cout &lt;&lt; &quot;Bracketing adjust &quot; &lt;&lt; alpha_lo &lt;&lt; &quot; &quot; &lt;&lt; alpha_hi &lt;&lt; &quot; &quot; &lt;&lt; alpha_new &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>              <span class="comment">//std::cout &lt;&lt; &quot;Bracketing adjust alpha_new from &quot; &lt;&lt; alpha_new;</span></div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>              <span class="keywordflow">if</span>(alpha_lo &lt; alpha_hi)</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>                alpha_new = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a737d301e1e32f502778181d09b408407">Math::min</a>(alpha_lo + <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0.66)*(alpha_hi - alpha_lo), alpha_new);</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>              <span class="keywordflow">else</span></div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>                alpha_new = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#ae63636287332e32875ca28780966a810">Math::max</a>(alpha_lo + <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0.66)*(alpha_hi - alpha_lo), alpha_new);</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>              <span class="comment">//std::cout &lt;&lt; &quot; to &quot; &lt;&lt; alpha_new &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>            }</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span> </div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>            alpha = alpha_new;</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span> </div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>            <span class="comment">//std::cout &lt;&lt; &quot;Polynomial fit: new &quot; &lt;&lt; alpha &lt;&lt; &quot; &quot; &lt;&lt; fval &lt;&lt; &quot; &quot; &lt;&lt; df &lt;&lt;std::endl;</span></div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>            <span class="comment">//std::cout &lt;&lt; &quot;Polynomial fit: lo  &quot; &lt;&lt; alpha_lo &lt;&lt; &quot; &quot; &lt;&lt; fval_lo &lt;&lt; &quot; &quot; &lt;&lt; df_lo &lt;&lt;std::endl;</span></div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>            <span class="comment">//std::cout &lt;&lt; &quot;Polynomial fit: hi  &quot; &lt;&lt; alpha_hi &lt;&lt; &quot; &quot; &lt;&lt; fval_hi &lt;&lt; &quot; &quot; &lt;&lt; df_hi &lt;&lt;std::endl;</span></div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span> </div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>          <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35eda260ca9dd8a4577fc00b7bd5810298076">Status::success</a>;</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>        }</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span> </div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#ad555e8822e9cfafd2439892f03096242">  610</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#ad555e8822e9cfafd2439892f03096242">_clamp_step</a>(<a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>&amp; alpha_new)<span class="keyword"> const</span></div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span><span class="keyword">        </span>{</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>          alpha_new = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#ae63636287332e32875ca28780966a810">Math::max</a>(alpha_new, <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#aaaf1ebbd30f6e6dfeccb6fb4fff32cdd">_alpha_hard_min</a>);</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>          alpha_new = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a737d301e1e32f502778181d09b408407">Math::min</a>(alpha_new, <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a037e15c86b327857756b641ae32ebabf">_alpha_hard_max</a>);</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span> </div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>          alpha_new = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#ae63636287332e32875ca28780966a810">Math::max</a>(alpha_new, <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a7eed1de5dac3d51cdae54b3d16063bae">_alpha_soft_min</a>);</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>          alpha_new = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a737d301e1e32f502778181d09b408407">Math::min</a>(alpha_new, <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a45d1421ff97be56ded264e5b60a62353">_alpha_soft_max</a>);</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>        }</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span> </div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a634ac681d806bb44db198f0f59983b91">  651</a></span>        <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a634ac681d806bb44db198f0f59983b91">_argmin_quadratic</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> alpha_lo, <span class="keyword">const</span> <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> fval_lo, <span class="keyword">const</span> <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> df_lo, <span class="keyword">const</span> <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> alpha_hi, <span class="keyword">const</span> <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> fval_hi, <span class="keyword">const</span> <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> df_hi, <span class="keyword">const</span> <span class="keywordtype">bool</span> interpolate_derivative)<span class="keyword"> const</span></div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span><span class="keyword">        </span>{</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> alpha(alpha_lo);</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span> </div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>          <span class="comment">// Quadratic interpolation using fval_lo, df_lo, df_hi</span></div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>          <span class="keywordflow">if</span>(interpolate_derivative)</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>            alpha += df_lo /(df_lo - df_hi) * (alpha_hi - alpha_lo);</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>          <span class="comment">// Quadratic interpolation using fval_lo, fval_hi, df_lo</span></div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>          <span class="keywordflow">else</span></div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>            alpha += df_lo/( (fval_hi - fval_lo)/( alpha_hi - alpha_lo) - df_lo)/<a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(2)*(alpha_lo - alpha_hi);</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span> </div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>          <span class="keywordflow">return</span> alpha;</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>        }</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span> </div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#aa60190aa635ed9e1be6b14f8a5c765e6">  696</a></span>        <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#aa60190aa635ed9e1be6b14f8a5c765e6">_argmin_cubic</a>(<a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> alpha_lo, <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> fval_lo, <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> df_lo,</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>        <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> alpha_hi, <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> fval_hi, <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> df_hi)<span class="keyword"> const</span></div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span><span class="keyword">        </span>{</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> alpha(alpha_lo);</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span> </div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> d1 = <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(3)*(fval_lo - fval_hi)/(alpha_hi - alpha_lo) + df_lo + df_hi;</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>          <span class="comment">// Scale the computation of r for better numerical stability</span></div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> scale = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#ae63636287332e32875ca28780966a810">Math::max</a>(<a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a286aac96ac3f73267cf1cca71bd79c27">Math::abs</a>(df_lo), <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a286aac96ac3f73267cf1cca71bd79c27">Math::abs</a>(df_hi));</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>          scale = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#ae63636287332e32875ca28780966a810">Math::max</a>(scale, <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a286aac96ac3f73267cf1cca71bd79c27">Math::abs</a>(d1));</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span> </div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> r = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a6af449baf67aa23022a99f019ddb1053">Math::sqr</a>(d1/scale) - (df_lo/scale) * (df_hi/scale);</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span> </div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>          <span class="comment">//std::cout &lt;&lt; &quot;fval_hi &quot; &lt;&lt; fval_hi &lt;&lt; &quot; fval_lo &quot;&lt;&lt; fval_lo &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>          <span class="comment">//std::cout &lt;&lt; &quot;alpha_hi &quot; &lt;&lt; alpha_hi &lt;&lt; &quot; alpha_lo &quot;&lt;&lt; alpha_lo &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>          <span class="comment">//std::cout &lt;&lt; &quot;df_hi &quot; &lt;&lt; df_hi &lt;&lt; &quot; df_lo &quot;&lt;&lt; df_lo &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>          <span class="comment">//std::cout &lt;&lt; &quot;d1 &quot; &lt;&lt; d1 &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>          <span class="comment">//std::cout &lt;&lt; &quot;scale &quot; &lt;&lt; scale &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span> </div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> d2(0);</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span> </div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>          <span class="keywordflow">if</span>(r &gt; <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0))</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>          {</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>            d2 = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#aa4f403e0b9b13250f24ef2e0119dc038">Math::signum</a>(alpha_hi - alpha_lo) * scale * <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a00029dad195a1d46d7baa2c66595b0b5">Math::sqrt</a>(r);</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span> </div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>            <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> p(d2 - df_lo + d1);</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span> </div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>            <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> q(0);</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>            <span class="comment">// This sorting is done to avoid annihilation</span></div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>            df_hi*df_lo &gt; <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0) ?  q = d2 +(df_hi-df_lo) + d2 : q = d2 - df_lo + d2 + df_hi;</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span> </div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>            <span class="comment">//std::cout &lt;&lt; &quot;d2 &quot; &lt;&lt; d2 &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>            <span class="comment">//std::cout &lt;&lt; &quot;p &quot; &lt;&lt; p &lt;&lt; &quot; q &quot; &lt;&lt; q &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span> </div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>            alpha += (alpha_hi - alpha_lo)*(p/q);</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>          }</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>          <span class="comment">// r &lt;= 0 means that the minimum is not in the interior, so it has to lie across the endpoint with the</span></div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>          <span class="comment">// lower function value</span></div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>          <span class="keywordflow">else</span></div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>          {</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>            <span class="comment">//d2 = Math::signum(alpha_hi - alpha_lo) * scale *</span></div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>            <span class="comment">//  Math::sqrt(Math::max(r, DataType(0)));</span></div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>            <span class="comment">//DataType q(0);</span></div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>            <span class="comment">//if(df_hi*df_lo &gt; 0)</span></div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>            <span class="comment">//  q = d2 +(df_hi-df_lo) + d2;</span></div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>            <span class="comment">//else</span></div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>            <span class="comment">//  q = d2 - df_lo + d2 +df_hi;</span></div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>            <span class="comment">//std::cout &lt;&lt; &quot;d2 &quot; &lt;&lt; d2 &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>            <span class="comment">//std::cout &lt;&lt; &quot;p &quot; &lt;&lt; (d2 - df_lo + d1) &lt;&lt; &quot; q &quot; &lt;&lt; q &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span> </div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>            (alpha_lo &lt; alpha_hi &amp;&amp; df_lo &gt; <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0) )? alpha = <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a7eed1de5dac3d51cdae54b3d16063bae">_alpha_soft_min</a>: alpha = <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a45d1421ff97be56ded264e5b60a62353">_alpha_soft_max</a>;</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>          }</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span> </div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>          <span class="keywordflow">return</span> alpha;</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>        }</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span> </div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a41a9a9f80ce9e2355297cb3808d8e47f">  756</a></span>        <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a41a9a9f80ce9e2355297cb3808d8e47f">_argmin_cubic_case_3</a>(</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> alpha_lo, <span class="keyword">const</span> <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> fval_lo, <span class="keyword">const</span> <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> df_lo,</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> alpha_hi, <span class="keyword">const</span> <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> fval_hi, <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> df_hi)<span class="keyword"> const</span></div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span><span class="keyword">        </span>{</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> alpha_c(alpha_lo);</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span> </div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>          <span class="keywordflow">if</span>(alpha_lo == alpha_hi)</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>          {</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>            <span class="keywordflow">return</span> alpha_lo;</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>          }</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span> </div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> d1 = <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(3)*(fval_hi - fval_lo)/(alpha_lo - alpha_hi) + df_hi + df_lo;</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> scale = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#ae63636287332e32875ca28780966a810">Math::max</a>(<a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a286aac96ac3f73267cf1cca71bd79c27">Math::abs</a>(df_lo), <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a286aac96ac3f73267cf1cca71bd79c27">Math::abs</a>(df_hi));</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>          scale = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#ae63636287332e32875ca28780966a810">Math::max</a>(scale, <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a286aac96ac3f73267cf1cca71bd79c27">Math::abs</a>(d1));</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span> </div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> r = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a6af449baf67aa23022a99f019ddb1053">Math::sqr</a>(d1/scale) - (df_lo/scale) * (df_hi/scale);</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span> </div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> d2 = <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#aa4f403e0b9b13250f24ef2e0119dc038">Math::signum</a>(alpha_hi - alpha_lo) * scale * <a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#a00029dad195a1d46d7baa2c66595b0b5">Math::sqrt</a>(<a class="code hl_function" href="namespace_f_e_a_t_1_1_math.html#ae63636287332e32875ca28780966a810">Math::max</a>(r, <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0)));</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span> </div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> p(d2 - df_lo + d1);</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a> q(d2 +(df_hi - df_lo) + d2);</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span> </div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>          <span class="comment">//std::cout &lt;&lt; &quot;fval_hi &quot; &lt;&lt; fval_hi &lt;&lt; &quot; fval_lo &quot;&lt;&lt; fval_lo &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>          <span class="comment">//std::cout &lt;&lt; &quot;alpha_hi &quot; &lt;&lt; alpha_hi &lt;&lt; &quot; alpha_lo &quot;&lt;&lt; alpha_lo &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>          <span class="comment">//std::cout &lt;&lt; &quot;df_hi &quot; &lt;&lt; df_hi &lt;&lt; &quot; df_lo &quot;&lt;&lt; df_lo &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>          <span class="comment">//std::cout &lt;&lt; &quot;d1 &quot; &lt;&lt; d1 &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>          <span class="comment">//std::cout &lt;&lt; &quot;scale &quot; &lt;&lt; scale &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>          <span class="comment">//std::cout &lt;&lt; &quot;d2 &quot; &lt;&lt; d2 &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>          <span class="comment">//std::cout &lt;&lt; &quot;p &quot; &lt;&lt; (d2 - df_lo + d1) &lt;&lt; &quot; q &quot; &lt;&lt; q &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span> </div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>          <span class="keywordflow">if</span>( p/q &lt; <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0) &amp;&amp; d2 != <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">DataType</a>(0))</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>            alpha_c += p/q*(alpha_hi - alpha_lo);</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>          <span class="keywordflow">else</span></div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>          {</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>            <span class="comment">//std::cout &lt;&lt; &quot;Weird &quot;;</span></div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>            alpha_lo &gt; alpha_hi ? alpha_c = <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a45d1421ff97be56ded264e5b60a62353">_alpha_soft_max</a> : alpha_c = <a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a7eed1de5dac3d51cdae54b3d16063bae">_alpha_soft_min</a>;</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>          }</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span> </div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>          <span class="keywordflow">return</span> alpha_c;</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>        }</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span> </div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>    }; <span class="comment">// class MQCLinesearch</span></div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span> </div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Functional_, <span class="keyword">typename</span> Filter_&gt;</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno"><a class="line" href="namespace_f_e_a_t_1_1_solver.html#ac11a88375825f798d11e58403c40379f">  815</a></span>    <span class="keyword">inline</span> std::shared_ptr&lt;MQCLinesearch&lt;Functional_, Filter_&gt;&gt; <a class="code hl_function" href="namespace_f_e_a_t_1_1_solver.html#ac11a88375825f798d11e58403c40379f">new_mqc_linesearch</a>(</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>      Functional_&amp; functional, Filter_&amp; filter, <span class="keywordtype">bool</span> keep_iterates = <span class="keyword">false</span>)</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>      {</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>        <span class="keywordflow">return</span> std::make_shared&lt;MQCLinesearch&lt;Functional_, Filter_&gt;&gt;(functional, filter, keep_iterates);</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>      }</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span> </div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Functional_, <span class="keyword">typename</span> Filter_&gt;</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno"><a class="line" href="namespace_f_e_a_t_1_1_solver.html#a3f21dbcd6bf8a8e7b5541fd6d3bed119">  840</a></span>    <span class="keyword">inline</span> std::shared_ptr&lt;MQCLinesearch&lt;Functional_, Filter_&gt;&gt; <a class="code hl_function" href="namespace_f_e_a_t_1_1_solver.html#ac11a88375825f798d11e58403c40379f">new_mqc_linesearch</a>(</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>      <span class="keyword">const</span> <a class="code hl_class" href="class_f_e_a_t_1_1_string.html">String</a>&amp; section_name, <a class="code hl_class" href="class_f_e_a_t_1_1_property_map.html">PropertyMap</a>* section, Functional_&amp; functional, Filter_&amp; filter)</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>      {</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>        <span class="keywordflow">return</span> std::make_shared&lt;MQCLinesearch&lt;Functional_, Filter_&gt;&gt; (section_name, section, functional, filter);</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>      }</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span> </div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>  } <span class="comment">// namespace Solver</span></div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>} <span class="comment">// namespace FEAT</span></div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span><span class="preprocessor">#endif </span><span class="comment">// FEAT_KERNEL_SOLVER_MQC_LINESEARCH</span></div>
<div class="ttc" id="abase__header_8hpp_html"><div class="ttname"><a href="base__header_8hpp.html">base_header.hpp</a></div><div class="ttdoc">FEAT Kernel base header.</div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_property_map_html"><div class="ttname"><a href="class_f_e_a_t_1_1_property_map.html">FEAT::PropertyMap</a></div><div class="ttdoc">A class organizing a tree of key-value pairs.</div><div class="ttdef"><b>Definition:</b> <a href="property__map_8hpp_source.html#l00048">property_map.hpp:49</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_iteration_stats_html"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_iteration_stats.html">FEAT::Solver::IterationStats</a></div><div class="ttdoc">Helper class for iteration statistics collection.</div><div class="ttdef"><b>Definition:</b> <a href="kernel_2solver_2base_8hpp_source.html#l00393">base.hpp:394</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_iterative_solver_html_a4d6b6c7809c161f59cbaf7cb01149178"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#a4d6b6c7809c161f59cbaf7cb01149178">FEAT::Solver::IterativeSolver&lt; Functional_::VectorTypeR &gt;::get_num_iter</a></div><div class="ttdeci">Index get_num_iter() const</div><div class="ttdoc">Returns number of performed iterations.</div><div class="ttdef"><b>Definition:</b> <a href="iterative_8hpp_source.html#l00406">iterative.hpp:406</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_iterative_solver_html_a575442c5edf8721e18db2a49717f45a5"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#a575442c5edf8721e18db2a49717f45a5">FEAT::Solver::IterativeSolver&lt; Functional_::VectorTypeR &gt;::_status</a></div><div class="ttdeci">Status _status</div><div class="ttdoc">current status of the solver</div><div class="ttdef"><b>Definition:</b> <a href="iterative_8hpp_source.html#l00135">iterative.hpp:135</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_iterative_solver_html_aa5524e82d3d153e57af1787421c0ec90"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#aa5524e82d3d153e57af1787421c0ec90">FEAT::Solver::IterativeSolver&lt; Functional_::VectorTypeR &gt;::_num_iter</a></div><div class="ttdeci">Index _num_iter</div><div class="ttdoc">number of performed iterations</div><div class="ttdef"><b>Definition:</b> <a href="iterative_8hpp_source.html#l00174">iterative.hpp:174</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_iterative_solver_html_abb072260d9458116ae6aa240d5685fb3"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#abb072260d9458116ae6aa240d5685fb3">FEAT::Solver::IterativeSolver&lt; Functional_::VectorTypeR &gt;::plot_summary</a></div><div class="ttdeci">virtual void plot_summary() const</div><div class="ttdoc">Plot a summary of the last solver run.</div><div class="ttdef"><b>Definition:</b> <a href="iterative_8hpp_source.html#l00573">iterative.hpp:573</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html">FEAT::Solver::Linesearch</a></div><div class="ttdoc">Linesearch base class.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00035">linesearch.hpp:36</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_a0d4201e4324ec13233def993318e44f2"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a0d4201e4324ec13233def993318e44f2">FEAT::Solver::Linesearch::_vec_grad</a></div><div class="ttdeci">VectorType _vec_grad</div><div class="ttdoc">Gradient vector.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00055">linesearch.hpp:55</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_a1678798c09d463bd121bf52812719ba9"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a1678798c09d463bd121bf52812719ba9">FEAT::Solver::Linesearch::_functional</a></div><div class="ttdeci">Functional_ &amp; _functional</div><div class="ttdoc">The (nonlinear) functional.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00050">linesearch.hpp:50</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_a27ba39cc738b9a4fa6208feb779ca42d"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a27ba39cc738b9a4fa6208feb779ca42d">FEAT::Solver::Linesearch::_vec_initial_sol</a></div><div class="ttdeci">VectorType _vec_initial_sol</div><div class="ttdoc">Initial solution.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00057">linesearch.hpp:57</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_a4274068c4e97f9636c48f4c932bfe7b1"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a4274068c4e97f9636c48f4c932bfe7b1">FEAT::Solver::Linesearch::trim_func_grad</a></div><div class="ttdeci">virtual void trim_func_grad(DataType &amp;func)</div><div class="ttdoc">Trims the function value and gradient according to some threshold.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00432">linesearch.hpp:432</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_a4dc1746ed5b84277a02c48e1804538ef"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a4dc1746ed5b84277a02c48e1804538ef">FEAT::Solver::Linesearch::_fval_0</a></div><div class="ttdeci">DataType _fval_0</div><div class="ttdoc">Initial functional value.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00066">linesearch.hpp:66</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_a74d7d176a5ffdf55d5eb6144f3d9ce66"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a74d7d176a5ffdf55d5eb6144f3d9ce66">FEAT::Solver::Linesearch::_tol_curvature</a></div><div class="ttdeci">DataType _tol_curvature</div><div class="ttdoc">Tolerance for sufficient decrease in the norm of the gradient (Wolfe conditions)</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00082">linesearch.hpp:82</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_a903b89f07e60974b07e6348291fc6741"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a903b89f07e60974b07e6348291fc6741">FEAT::Solver::Linesearch::_startup</a></div><div class="ttdeci">virtual Status _startup(DataType &amp;alpha, DataType &amp;fval, DataType &amp;delta, const VectorType &amp;vec_sol, const VectorType &amp;vec_dir)</div><div class="ttdoc">Performs the startup of the iteration.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00466">linesearch.hpp:466</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_a92961d837ffc56d85cff3b820340eb2a"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a92961d837ffc56d85cff3b820340eb2a">FEAT::Solver::Linesearch::_vec_pn</a></div><div class="ttdeci">VectorType _vec_pn</div><div class="ttdoc">descend direction vector, normalized for better numerical stability</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00061">linesearch.hpp:61</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_aa5944f939b4e98706eff002e1c4caa3e"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#aa5944f939b4e98706eff002e1c4caa3e">FEAT::Solver::Linesearch::reset</a></div><div class="ttdeci">virtual void reset()</div><div class="ttdoc">Resets various member variables in case the solver is reused.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00301">linesearch.hpp:301</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_aa6cf349be86b034e98d0a751ad6859f5"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#aa6cf349be86b034e98d0a751ad6859f5">FEAT::Solver::Linesearch::_delta_0</a></div><div class="ttdeci">DataType _delta_0</div><div class="ttdoc">Initial &lt;vec_dir, vec_grad&gt;</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00075">linesearch.hpp:75</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_aab60dec26fb66c0cd2faeac189467f8f"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#aab60dec26fb66c0cd2faeac189467f8f">FEAT::Solver::Linesearch::_fval_min</a></div><div class="ttdeci">DataType _fval_min</div><div class="ttdoc">Functional functional value.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00064">linesearch.hpp:64</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_ac2ed9d06b8fc5632e175864d6b0aec6c"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac2ed9d06b8fc5632e175864d6b0aec6c">FEAT::Solver::Linesearch::_filter</a></div><div class="ttdeci">Filter_ &amp; _filter</div><div class="ttdoc">The filter to be applied to the functional's gradient.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00052">linesearch.hpp:52</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_ac5990a1f2ff4f600e868b8fd15b96079"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac5990a1f2ff4f600e868b8fd15b96079">FEAT::Solver::Linesearch::_tol_decrease</a></div><div class="ttdeci">DataType _tol_decrease</div><div class="ttdoc">Tolerance for sufficient decrease in the functional value (Wolfe conditions)</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00084">linesearch.hpp:84</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_acac79b1fb48d0d47da2bfcd987afb9c1"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#acac79b1fb48d0d47da2bfcd987afb9c1">FEAT::Solver::Linesearch::_alpha_0</a></div><div class="ttdeci">DataType _alpha_0</div><div class="ttdoc">Initial line search parameter.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00071">linesearch.hpp:71</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_ad8716d5245471de11330a2f693d6f4f2"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ad8716d5245471de11330a2f693d6f4f2">FEAT::Solver::Linesearch::_alpha_min</a></div><div class="ttdeci">DataType _alpha_min</div><div class="ttdoc">Line search parameter.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00073">linesearch.hpp:73</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_ade3e6601c1d2a6d2cfbed7437c13bb11"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ade3e6601c1d2a6d2cfbed7437c13bb11">FEAT::Solver::Linesearch::_tol_step</a></div><div class="ttdeci">DataType _tol_step</div><div class="ttdoc">Tolerance for the update step.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00086">linesearch.hpp:86</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_ae856346c0f498690e441ceefe6edd212"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ae856346c0f498690e441ceefe6edd212">FEAT::Solver::Linesearch::_vec_tmp</a></div><div class="ttdeci">VectorType _vec_tmp</div><div class="ttdoc">temporary vector</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00059">linesearch.hpp:59</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_aeb397e3e98d6e2edb5e4ee5cb8f73082"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#aeb397e3e98d6e2edb5e4ee5cb8f73082">FEAT::Solver::Linesearch::_check_convergence</a></div><div class="ttdeci">virtual Status _check_convergence(const DataType fval, const DataType df, const DataType alpha)</div><div class="ttdoc">Performs the line search convergence checks using the strong Wolfe conditions.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00545">linesearch.hpp:545</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html">FEAT::Solver::MQCLinesearch</a></div><div class="ttdoc">Mixed quadratic-cubic line search.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00052">mqc_linesearch.hpp:53</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html_a037e15c86b327857756b641ae32ebabf"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a037e15c86b327857756b641ae32ebabf">FEAT::Solver::MQCLinesearch::_alpha_hard_max</a></div><div class="ttdeci">DataType _alpha_hard_max</div><div class="ttdoc">Hard maximum for the step length.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00066">mqc_linesearch.hpp:66</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html_a2d8c159cd4fdfd1d9908d52d17b4666c"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a2d8c159cd4fdfd1d9908d52d17b4666c">FEAT::Solver::MQCLinesearch::name</a></div><div class="ttdeci">virtual String name() const override</div><div class="ttdoc">Returns a descriptive string.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00129">mqc_linesearch.hpp:129</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html_a3e46c8212d61c6f0961f97e68f696a89"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a3e46c8212d61c6f0961f97e68f696a89">FEAT::Solver::MQCLinesearch::MQCLinesearch</a></div><div class="ttdeci">MQCLinesearch(Functional_ &amp;functional, Filter_ &amp;filter, bool keep_iterates=false)</div><div class="ttdoc">Standard constructor.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00088">mqc_linesearch.hpp:88</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html_a412c6301aa0750168b4dac17ed49f938"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a412c6301aa0750168b4dac17ed49f938">FEAT::Solver::MQCLinesearch::MQCLinesearch</a></div><div class="ttdeci">MQCLinesearch(const String &amp;section_name, PropertyMap *section, Functional_ &amp;functional, Filter_ &amp;filter)</div><div class="ttdoc">Constructor using a PropertyMap.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00113">mqc_linesearch.hpp:113</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html_a41a9a9f80ce9e2355297cb3808d8e47f"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a41a9a9f80ce9e2355297cb3808d8e47f">FEAT::Solver::MQCLinesearch::_argmin_cubic_case_3</a></div><div class="ttdeci">DataType _argmin_cubic_case_3(const DataType alpha_lo, const DataType fval_lo, const DataType df_lo, const DataType alpha_hi, const DataType fval_hi, DataType df_hi) const</div><div class="ttdoc">Computes the minimum of a cubic interpolation polynomial.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00756">mqc_linesearch.hpp:756</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html_a45d1421ff97be56ded264e5b60a62353"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a45d1421ff97be56ded264e5b60a62353">FEAT::Solver::MQCLinesearch::_alpha_soft_max</a></div><div class="ttdeci">DataType _alpha_soft_max</div><div class="ttdoc">Lower bound of the interval of uncertainty.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00070">mqc_linesearch.hpp:70</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html_a572b2d22f37b0e456d69cc756bab3e7e"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a572b2d22f37b0e456d69cc756bab3e7e">FEAT::Solver::MQCLinesearch::DataType</a></div><div class="ttdeci">Functional_::DataType DataType</div><div class="ttdoc">Underlying floating point type.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00060">mqc_linesearch.hpp:60</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html_a634ac681d806bb44db198f0f59983b91"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a634ac681d806bb44db198f0f59983b91">FEAT::Solver::MQCLinesearch::_argmin_quadratic</a></div><div class="ttdeci">DataType _argmin_quadratic(const DataType alpha_lo, const DataType fval_lo, const DataType df_lo, const DataType alpha_hi, const DataType fval_hi, const DataType df_hi, const bool interpolate_derivative) const</div><div class="ttdoc">Computes the minimum of a quadratic interpolation polynomial.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00651">mqc_linesearch.hpp:651</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html_a7c13fe0975871dce382199d45f2d7b93"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a7c13fe0975871dce382199d45f2d7b93">FEAT::Solver::MQCLinesearch::~MQCLinesearch</a></div><div class="ttdeci">virtual ~MQCLinesearch()</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00124">mqc_linesearch.hpp:124</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html_a7eed1de5dac3d51cdae54b3d16063bae"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a7eed1de5dac3d51cdae54b3d16063bae">FEAT::Solver::MQCLinesearch::_alpha_soft_min</a></div><div class="ttdeci">DataType _alpha_soft_min</div><div class="ttdoc">Upper bound of the interval of uncertainty.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00072">mqc_linesearch.hpp:72</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html_a84aad9b507328de339e486f832a8fb4d"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a84aad9b507328de339e486f832a8fb4d">FEAT::Solver::MQCLinesearch::correct</a></div><div class="ttdeci">virtual Status correct(VectorType &amp;vec_sol, const VectorType &amp;vec_dir) override</div><div class="ttdoc">Applies the solver, making use of an initial guess.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00178">mqc_linesearch.hpp:178</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html_a930aaba4d2cb4f5576f8915cbe20e966"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#a930aaba4d2cb4f5576f8915cbe20e966">FEAT::Solver::MQCLinesearch::FilterType</a></div><div class="ttdeci">Filter_ FilterType</div><div class="ttdoc">Filter type to be applied to the gradient of the functional.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00056">mqc_linesearch.hpp:56</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html_aa60190aa635ed9e1be6b14f8a5c765e6"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#aa60190aa635ed9e1be6b14f8a5c765e6">FEAT::Solver::MQCLinesearch::_argmin_cubic</a></div><div class="ttdeci">DataType _argmin_cubic(DataType alpha_lo, DataType fval_lo, DataType df_lo, DataType alpha_hi, DataType fval_hi, DataType df_hi) const</div><div class="ttdoc">Computes the minimum of a cubic interpolation polynomial.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00696">mqc_linesearch.hpp:696</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html_aaaf1ebbd30f6e6dfeccb6fb4fff32cdd"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#aaaf1ebbd30f6e6dfeccb6fb4fff32cdd">FEAT::Solver::MQCLinesearch::_alpha_hard_min</a></div><div class="ttdeci">DataType _alpha_hard_min</div><div class="ttdoc">Hard minimum for the step length.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00068">mqc_linesearch.hpp:68</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html_aaec597375935042fdeee5ff49d9e5dba"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#aaec597375935042fdeee5ff49d9e5dba">FEAT::Solver::MQCLinesearch::BaseClass</a></div><div class="ttdeci">Linesearch&lt; Functional_, Filter_ &gt; BaseClass</div><div class="ttdoc">Our base class.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00062">mqc_linesearch.hpp:62</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html_ab478c726b420d585b616027f965b75e6"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#ab478c726b420d585b616027f965b75e6">FEAT::Solver::MQCLinesearch::apply</a></div><div class="ttdeci">virtual Status apply(VectorType &amp;vec_cor, const VectorType &amp;vec_dir) override</div><div class="ttdoc">Applies the solver, setting the initial guess to zero.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00155">mqc_linesearch.hpp:155</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html_ac964c483886d3f23e54fb5d3e65f7c64"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#ac964c483886d3f23e54fb5d3e65f7c64">FEAT::Solver::MQCLinesearch::_polynomial_fit</a></div><div class="ttdeci">Status _polynomial_fit(DataType &amp;alpha, DataType &amp;fval, DataType &amp;df, DataType &amp;alpha_lo, DataType &amp;fval_lo, DataType &amp;df_lo, DataType &amp;alpha_hi, DataType &amp;fval_hi, DataType &amp;df_hi, bool &amp;min_in_interval, bool &amp;drive_to_bndry)</div><div class="ttdoc">The great magick trick to find a minimum of a 1d function.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00469">mqc_linesearch.hpp:469</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html_ac96ddf166af524e8bcbd8811eee24dd3"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#ac96ddf166af524e8bcbd8811eee24dd3">FEAT::Solver::MQCLinesearch::VectorType</a></div><div class="ttdeci">Functional_::VectorTypeR VectorType</div><div class="ttdoc">Input vector type for the functional's gradient.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00058">mqc_linesearch.hpp:58</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html_ad555e8822e9cfafd2439892f03096242"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#ad555e8822e9cfafd2439892f03096242">FEAT::Solver::MQCLinesearch::_clamp_step</a></div><div class="ttdeci">void _clamp_step(DataType &amp;alpha_new) const</div><div class="ttdoc">Enforces hard and soft step limits, adjusting the soft limits if necessary.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00610">mqc_linesearch.hpp:610</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html_af17bd5807f12d7e83137a18b07247af7"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#af17bd5807f12d7e83137a18b07247af7">FEAT::Solver::MQCLinesearch::_apply_intern</a></div><div class="ttdeci">virtual Status _apply_intern(VectorType &amp;vec_sol, const VectorType &amp;vec_dir)</div><div class="ttdoc">Internal function: Applies the solver.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00203">mqc_linesearch.hpp:203</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch_html_afc7ec16c39fc3217c6f1a9dd38b3c3e8"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_m_q_c_linesearch.html#afc7ec16c39fc3217c6f1a9dd38b3c3e8">FEAT::Solver::MQCLinesearch::reset</a></div><div class="ttdeci">virtual void reset() override</div><div class="ttdoc">Resets various member variables in case the solver is reused.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00135">mqc_linesearch.hpp:135</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_string_html"><div class="ttname"><a href="class_f_e_a_t_1_1_string.html">FEAT::String</a></div><div class="ttdoc">String class implementation.</div><div class="ttdef"><b>Definition:</b> <a href="string_8hpp_source.html#l00045">string.hpp:47</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_math_html_a00029dad195a1d46d7baa2c66595b0b5"><div class="ttname"><a href="namespace_f_e_a_t_1_1_math.html#a00029dad195a1d46d7baa2c66595b0b5">FEAT::Math::sqrt</a></div><div class="ttdeci">T_ sqrt(T_ x)</div><div class="ttdoc">Returns the square-root of a value.</div><div class="ttdef"><b>Definition:</b> <a href="math_8hpp_source.html#l00297">math.hpp:297</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_math_html_a286aac96ac3f73267cf1cca71bd79c27"><div class="ttname"><a href="namespace_f_e_a_t_1_1_math.html#a286aac96ac3f73267cf1cca71bd79c27">FEAT::Math::abs</a></div><div class="ttdeci">T_ abs(T_ x)</div><div class="ttdoc">Returns the absolute value.</div><div class="ttdef"><b>Definition:</b> <a href="math_8hpp_source.html#l00272">math.hpp:272</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_math_html_a564d69313ee91de438926de491613096"><div class="ttname"><a href="namespace_f_e_a_t_1_1_math.html#a564d69313ee91de438926de491613096">FEAT::Math::pow</a></div><div class="ttdeci">T_ pow(T_ x, T_ y)</div><div class="ttdoc">Returns x raised to the power of y.</div><div class="ttdef"><b>Definition:</b> <a href="math_8hpp_source.html#l00593">math.hpp:593</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_math_html_a6af449baf67aa23022a99f019ddb1053"><div class="ttname"><a href="namespace_f_e_a_t_1_1_math.html#a6af449baf67aa23022a99f019ddb1053">FEAT::Math::sqr</a></div><div class="ttdeci">T_ sqr(T_ x)</div><div class="ttdoc">Returns the square of a value.</div><div class="ttdef"><b>Definition:</b> <a href="math_8hpp_source.html#l00092">math.hpp:92</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_math_html_a737d301e1e32f502778181d09b408407"><div class="ttname"><a href="namespace_f_e_a_t_1_1_math.html#a737d301e1e32f502778181d09b408407">FEAT::Math::min</a></div><div class="ttdeci">T_ min(T_ a, T_ b)</div><div class="ttdoc">Returns the minimum of two values.</div><div class="ttdef"><b>Definition:</b> <a href="math_8hpp_source.html#l00120">math.hpp:120</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_math_html_aa4f403e0b9b13250f24ef2e0119dc038"><div class="ttname"><a href="namespace_f_e_a_t_1_1_math.html#aa4f403e0b9b13250f24ef2e0119dc038">FEAT::Math::signum</a></div><div class="ttdeci">T_ signum(T_ x)</div><div class="ttdoc">Returns the sign of a value.</div><div class="ttdef"><b>Definition:</b> <a href="math_8hpp_source.html#l00247">math.hpp:247</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_math_html_ae63636287332e32875ca28780966a810"><div class="ttname"><a href="namespace_f_e_a_t_1_1_math.html#ae63636287332e32875ca28780966a810">FEAT::Math::max</a></div><div class="ttdeci">T_ max(T_ a, T_ b)</div><div class="ttdoc">Returns the maximum of two values.</div><div class="ttdef"><b>Definition:</b> <a href="math_8hpp_source.html#l00134">math.hpp:134</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_solver_html_ab1c941bc4fb3a678ef08e84cd3fa35ed"><div class="ttname"><a href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35ed">FEAT::Solver::Status</a></div><div class="ttdeci">Status</div><div class="ttdoc">Solver status return codes enumeration.</div><div class="ttdef"><b>Definition:</b> <a href="kernel_2solver_2base_8hpp_source.html#l00048">base.hpp:49</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_solver_html_ab1c941bc4fb3a678ef08e84cd3fa35eda260ca9dd8a4577fc00b7bd5810298076"><div class="ttname"><a href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35eda260ca9dd8a4577fc00b7bd5810298076">FEAT::Solver::Status::success</a></div><div class="ttdeci">@ success</div><div class="ttdoc">solving successful (convergence criterion fulfilled)</div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_solver_html_ab1c941bc4fb3a678ef08e84cd3fa35eda3c709b10a5d47ba33d85337dd9110917"><div class="ttname"><a href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35eda3c709b10a5d47ba33d85337dd9110917">FEAT::Solver::Status::progress</a></div><div class="ttdeci">@ progress</div><div class="ttdoc">continue iteration (internal use only)</div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_solver_html_ab1c941bc4fb3a678ef08e84cd3fa35edaa3d1e0a7dd736bc430ba471d9dfdf3a2"><div class="ttname"><a href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35edaa3d1e0a7dd736bc430ba471d9dfdf3a2">FEAT::Solver::Status::stagnated</a></div><div class="ttdeci">@ stagnated</div><div class="ttdoc">solver stagnated (stagnation criterion fulfilled)</div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_solver_html_ac11a88375825f798d11e58403c40379f"><div class="ttname"><a href="namespace_f_e_a_t_1_1_solver.html#ac11a88375825f798d11e58403c40379f">FEAT::Solver::new_mqc_linesearch</a></div><div class="ttdeci">std::shared_ptr&lt; MQCLinesearch&lt; Functional_, Filter_ &gt; &gt; new_mqc_linesearch(Functional_ &amp;functional, Filter_ &amp;filter, bool keep_iterates=false)</div><div class="ttdoc">Creates a new MQCLinesearch object.</div><div class="ttdef"><b>Definition:</b> <a href="mqc__linesearch_8hpp_source.html#l00815">mqc_linesearch.hpp:815</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_html"><div class="ttname"><a href="namespace_f_e_a_t.html">FEAT</a></div><div class="ttdoc">FEAT namespace.</div><div class="ttdef"><b>Definition:</b> <a href="adjactor_8hpp_source.html#l00013">adjactor.hpp:14</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_dc43877d82dd332f9fb2071fcca799d6.html">kernel</a></li><li class="navelem"><a class="el" href="dir_58759e03702cf5d3134868f6de633189.html">solver</a></li><li class="navelem"><b>mqc_linesearch.hpp</b></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FEAT: FEAT::Assembly::TraceAssemblyJob::Task Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">FEAT<span id="projectnumber">&#160;3</span>
   </div>
   <div id="projectbrief">Finite Element Analysis Toolbox</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">FEAT::Assembly::TraceAssemblyJob::Task Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Trace assembly task class.  
 <a href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="trace__assembler_8hpp_source.html">trace_assembler.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1e0014a4d2e03af4b6dfd21368f50646"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#a1e0014a4d2e03af4b6dfd21368f50646">Task</a> (<a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job.html">TraceAssemblyJob</a> &amp;job)</td></tr>
<tr class="memdesc:a1e0014a4d2e03af4b6dfd21368f50646"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mandatory Constructor.  <a href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#a1e0014a4d2e03af4b6dfd21368f50646">More...</a><br /></td></tr>
<tr class="separator:a1e0014a4d2e03af4b6dfd21368f50646"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab11afa40851d81f23099734093a182e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ab11afa40851d81f23099734093a182e5">assemble</a> ()</td></tr>
<tr class="memdesc:ab11afa40851d81f23099734093a182e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the local assembly on the current facet.  <a href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ab11afa40851d81f23099734093a182e5">More...</a><br /></td></tr>
<tr class="separator:ab11afa40851d81f23099734093a182e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae832603dfd7f8f78dcc42d4aa0ba673c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ae832603dfd7f8f78dcc42d4aa0ba673c">combine</a> ()</td></tr>
<tr class="memdesc:ae832603dfd7f8f78dcc42d4aa0ba673c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finishes the overall assembly and combines all local results.  <a href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ae832603dfd7f8f78dcc42d4aa0ba673c">More...</a><br /></td></tr>
<tr class="separator:ae832603dfd7f8f78dcc42d4aa0ba673c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdb31d49a6d7e16e37eb55fe599aa886"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#afdb31d49a6d7e16e37eb55fe599aa886">finish</a> ()</td></tr>
<tr class="memdesc:afdb31d49a6d7e16e37eb55fe599aa886"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finishes the task on the current cell.  <a href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#afdb31d49a6d7e16e37eb55fe599aa886">More...</a><br /></td></tr>
<tr class="separator:afdb31d49a6d7e16e37eb55fe599aa886"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8aa125b7fcb9c47d64f858600c43e6dc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#a8aa125b7fcb9c47d64f858600c43e6dc">prepare</a> (<a class="el" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> facet, <a class="el" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> cell, int local_facet, int facet_ori)</td></tr>
<tr class="memdesc:a8aa125b7fcb9c47d64f858600c43e6dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepares the task for assembly for a facet on a single one of its adjacent elements.  <a href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#a8aa125b7fcb9c47d64f858600c43e6dc">More...</a><br /></td></tr>
<tr class="separator:a8aa125b7fcb9c47d64f858600c43e6dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56499647b6f967601885772f479606a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#a56499647b6f967601885772f479606a4">prepare</a> (<a class="el" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> facet, <a class="el" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> cell_a, <a class="el" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a> cell_b, int local_facet_a, int local_facet_b, int facet_ori_a, int facet_ori_b)</td></tr>
<tr class="memdesc:a56499647b6f967601885772f479606a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepares the task for assembly for a facet on both of its adjacent elements.  <a href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#a56499647b6f967601885772f479606a4">More...</a><br /></td></tr>
<tr class="separator:a56499647b6f967601885772f479606a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab58efee20ef7bc636d902e5acb917f8f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ab58efee20ef7bc636d902e5acb917f8f">scatter</a> ()</td></tr>
<tr class="memdesc:ab58efee20ef7bc636d902e5acb917f8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scatters the local assembly into the global system.  <a href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ab58efee20ef7bc636d902e5acb917f8f">More...</a><br /></td></tr>
<tr class="separator:ab58efee20ef7bc636d902e5acb917f8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-attribs" name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a9c33f58ea80d8dd40f57184ebd7a2274"><td class="memItemLeft" align="right" valign="top">static constexpr bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#a9c33f58ea80d8dd40f57184ebd7a2274">assemble_pairwise</a> = true or false</td></tr>
<tr class="memdesc:a9c33f58ea80d8dd40f57184ebd7a2274"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specifies whether this task assembles element pairs on inner facets simultaenously.  <a href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#a9c33f58ea80d8dd40f57184ebd7a2274">More...</a><br /></td></tr>
<tr class="separator:a9c33f58ea80d8dd40f57184ebd7a2274"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a592fb29033c6b7032edf53e9be8aa913"><td class="memItemLeft" align="right" valign="top">static constexpr bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#a592fb29033c6b7032edf53e9be8aa913">need_combine</a> = true or false</td></tr>
<tr class="memdesc:a592fb29033c6b7032edf53e9be8aa913"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specifies whether this task fas a <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ae832603dfd7f8f78dcc42d4aa0ba673c" title="Finishes the overall assembly and combines all local results.">combine()</a> function, which is required to be called from within a critical section after the overall assembly is finished.  <a href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#a592fb29033c6b7032edf53e9be8aa913">More...</a><br /></td></tr>
<tr class="separator:a592fb29033c6b7032edf53e9be8aa913"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7590eb501918af7d0a5e547e55fdb0f"><td class="memItemLeft" align="right" valign="top">static constexpr bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ac7590eb501918af7d0a5e547e55fdb0f">need_scatter</a> = true or false</td></tr>
<tr class="memdesc:ac7590eb501918af7d0a5e547e55fdb0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specifies whether this task has a <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ab58efee20ef7bc636d902e5acb917f8f" title="Scatters the local assembly into the global system.">scatter()</a> function, which is required to be called from within a critical section after the local assembly on each facet.  <a href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ac7590eb501918af7d0a5e547e55fdb0f">More...</a><br /></td></tr>
<tr class="separator:ac7590eb501918af7d0a5e547e55fdb0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Trace assembly task class. </p>
<dl class="section attention"><dt>Attention</dt><dd>This class is only defined for the doxygen documentation, because it only serves as a duck-type class interface documentation.</dd></dl>
<p>An instance of this <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html" title="Trace assembly task class.">Task</a> class is created by each worker thread at the beginning of the assembly process and is used to perform the assembly on the set of the elements that are assigned to that particular worker thread.</p>
<p >At the very least, this class contains a mandatory constructor, the five member functions <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#a8aa125b7fcb9c47d64f858600c43e6dc" title="Prepares the task for assembly for a facet on a single one of its adjacent elements.">prepare()</a>, <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ab11afa40851d81f23099734093a182e5" title="Performs the local assembly on the current facet.">assemble()</a>, <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ab58efee20ef7bc636d902e5acb917f8f" title="Scatters the local assembly into the global system.">scatter()</a>, <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#afdb31d49a6d7e16e37eb55fe599aa886" title="Finishes the task on the current cell.">finish()</a> and <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ae832603dfd7f8f78dcc42d4aa0ba673c" title="Finishes the overall assembly and combines all local results.">combine()</a> as well as three constexpr members <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#a9c33f58ea80d8dd40f57184ebd7a2274" title="Specifies whether this task assembles element pairs on inner facets simultaenously.">assemble_pairwise</a>, <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ac7590eb501918af7d0a5e547e55fdb0f" title="Specifies whether this task has a scatter() function, which is required to be called from within a cr...">need_scatter</a> and <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#a592fb29033c6b7032edf53e9be8aa913" title="Specifies whether this task fas a combine() function, which is required to be called from within a cr...">need_combine</a>, which determine whether the assembly tasks supports cell-pairwise assembly (see below for details) and whether the scatter and combine functions have to be called by the trace assembler at all. All member functions except for <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ab58efee20ef7bc636d902e5acb917f8f" title="Scatters the local assembly into the global system.">scatter()</a> and <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ae832603dfd7f8f78dcc42d4aa0ba673c" title="Finishes the overall assembly and combines all local results.">combine()</a> are silently assumed to be thread-safe.</p>
<p >Because the trace assembler assembles surface integrals over facets which may be shared by two neighboring cells (unless the facet is a boundary or halo facet), there are two ways how the assembler may proceed in this case: it may either assemble the trace integral on both adjacent cells separately or it may assemble both cells at the same time. If the task's <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#a9c33f58ea80d8dd40f57184ebd7a2274" title="Specifies whether this task assembles element pairs on inner facets simultaenously.">assemble_pairwise</a> member is set to true and the assembler processes a facet that is shared by two neighboring cells, then the assembler will call the task's prepare function overload with 7 function parameters indicating that the task shall assemble on that pair of neighboring cells at the same time, otherwise the assembler will process the two neighboring cells successively and it will call the task's prepare function overload with 4 function parameters for each of the two cells.</p>
<p >In the case of boundary (or halo) facets, the assembler will always call the task's prepare function overload with 4 parameters, independently of whether <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#a9c33f58ea80d8dd40f57184ebd7a2274" title="Specifies whether this task assembles element pairs on inner facets simultaenously.">assemble_pairwise</a> is set to true or false.</p>
<dl class="section note"><dt>Note</dt><dd>Currently, the <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembler.html" title="Trace Integral Assembler class template.">TraceAssembler</a> does not perform any sort of multi-threading and so it does not employ any worker threads, but this may change in future.</dd></dl>
<p><b><u>Basic Job <a class="el" href="namespace_f_e_a_t_1_1_assembly.html" title="Assembly namespace.">Assembly</a> work flow:</u></b><br  />
 Each worker thread employed by the trace assembler will perform the following (simplified) steps (pseudo-code): </p><div class="fragment"><div class="line"><span class="comment">// create a Task object for this worker thread</span></div>
<div class="line">Job::Task task(job);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// loop over all facets of this worker thread</span></div>
<div class="line"><span class="keywordflow">for</span>(<span class="keyword">auto</span> facet : this_workers_facet_list)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// is this an inner facet and do we assemble pairwise?</span></div>
<div class="line">  <span class="keywordflow">if</span>(facet.is_inner &amp;&amp; task.assemble_pairwise)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// prepare task for assembly on a pair of neighboring cells sharing a facet</span></div>
<div class="line">    task.prepare(facet, cell_a, cell_b, ...);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// assemble on current cell pair</span></div>
<div class="line">    task.assemble();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// does the task need to scatter?</span></div>
<div class="line">    <span class="keywordflow">if</span>(task.need_scatter)</div>
<div class="line">    {</div>
<div class="line">      <span class="comment">// scatter local data</span></div>
<div class="line">      neighbor_mutex.lock();</div>
<div class="line">      task.scatter();</div>
<div class="line">      neighbor_mutex.unlock();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// finish assembly on current cell pair</span></div>
<div class="line">    task.finish();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// continue with next facet</span></div>
<div class="line">    <span class="keywordflow">continue</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// no pairwise assembly</span></div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keyword">auto</span> cell : facet.adjacent_cells)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// prepare task for assembly on one cell adjacent to the facet</span></div>
<div class="line">    task.prepare(facet, cell, ...);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// assemble on current cell pair</span></div>
<div class="line">    task.assemble();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// does the task need to scatter?</span></div>
<div class="line">    <span class="keywordflow">if</span>(task.need_scatter)</div>
<div class="line">    {</div>
<div class="line">      <span class="comment">// scatter local data</span></div>
<div class="line">      neighbor_mutex.lock();</div>
<div class="line">      task.scatter();</div>
<div class="line">      neighbor_mutex.unlock();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// finish assembly on current cell pair</span></div>
<div class="line">    task.finish();</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// does the task need to combine?</span></div>
<div class="line"><span class="keywordflow">if</span>(task.need_combine)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// combine local data</span></div>
<div class="line">  domain_mutex.lock();</div>
<div class="line">  task.combine();</div>
<div class="line">  domain_mutex.unlock();</div>
<div class="line">}</div>
</div><!-- fragment --><p> In the pseudo-code above, the code lines between <code>neighbor_mutex.lock()</code> and <code>neighbor_mutex.unlock()</code> are executed in a neighbor-mutually exclusive fashion, i.e. it is guaranteed that this code (<code>task.scatter()</code>) is never executed by two threads, which are active on two neighbor elements, at the same time. However, the code may be executed by two threads simultaneously if the cells, that the two threads are currently active on, are not adjacent to each other.<br  />
 Furthermore, the code lines between <code>domain_mutex.lock()</code> and <code>domain_mutex.unlock()</code> are executed in a (domain-) mutually exclusive fashion, i.e. it is guaranteed that this code (<code>task.combine()</code>) is never executed by two threads at the same time.</p>
<dl class="section author"><dt>Author</dt><dd>Peter Zajac </dd></dl>

<p class="definition">Definition at line <a class="el" href="trace__assembler_8hpp_source.html#l00180">180</a> of file <a class="el" href="trace__assembler_8hpp_source.html">trace_assembler.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a1e0014a4d2e03af4b6dfd21368f50646" name="a1e0014a4d2e03af4b6dfd21368f50646"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e0014a4d2e03af4b6dfd21368f50646">&#9670;&#160;</a></span>Task()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">FEAT::Assembly::TraceAssemblyJob::Task::Task </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job.html">TraceAssemblyJob</a> &amp;&#160;</td>
          <td class="paramname"><em>job</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mandatory Constructor. </p>
<p >This constructor is used by each of the trace assemblers worker threads to create its own task object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">job</td><td>A <a class="el" href="resident_vs_transient.html#res_vs_tran_resident">resident</a> reference to the encapsulating job class object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section attention"><dt>Attention</dt><dd>This constructor is silently assumed to be thread-safe, i.e. no thread may try to write to a common shared resource inside this function (without manual mutexing). </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ab11afa40851d81f23099734093a182e5" name="ab11afa40851d81f23099734093a182e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab11afa40851d81f23099734093a182e5">&#9670;&#160;</a></span>assemble()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FEAT::Assembly::TraceAssemblyJob::Task::assemble </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs the local assembly on the current facet. </p>
<p >This function is called by the assembly worker thread directly after the <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#a8aa125b7fcb9c47d64f858600c43e6dc" title="Prepares the task for assembly for a facet on a single one of its adjacent elements.">prepare()</a> function and is typically used to perform the actual local assembly, i.e. this is where most of the magic happens.</p>
<dl class="section attention"><dt>Attention</dt><dd>This function is silently assumed to be thread-safe, i.e. no thread may try to write to a common shared resource inside this function (without manual mutexing). </dd></dl>

</div>
</div>
<a id="ae832603dfd7f8f78dcc42d4aa0ba673c" name="ae832603dfd7f8f78dcc42d4aa0ba673c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae832603dfd7f8f78dcc42d4aa0ba673c">&#9670;&#160;</a></span>combine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FEAT::Assembly::TraceAssemblyJob::Task::combine </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finishes the overall assembly and combines all local results. </p>
<p >This function is called once per assembly run after the worker thread has finished assembling all its cells. This function can be used to collect (or reduce) the information assembled in each task into a combined result in the job object.</p>
<dl class="section note"><dt>Note</dt><dd>This function is called by the worker threads in a mutually exclusive fashion, i.e. this function is never called by two threads at the same time, so accessing a common resource shared by all threads is safe inside this function.</dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>This function is only called by the assembler if <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#a592fb29033c6b7032edf53e9be8aa913" title="Specifies whether this task fas a combine() function, which is required to be called from within a cr...">need_combine</a> is true, however, it must always exist even if <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#a592fb29033c6b7032edf53e9be8aa913" title="Specifies whether this task fas a combine() function, which is required to be called from within a cr...">need_combine</a> is false to prevent linker errors. </dd></dl>

</div>
</div>
<a id="afdb31d49a6d7e16e37eb55fe599aa886" name="afdb31d49a6d7e16e37eb55fe599aa886"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdb31d49a6d7e16e37eb55fe599aa886">&#9670;&#160;</a></span>finish()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FEAT::Assembly::TraceAssemblyJob::Task::finish </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finishes the task on the current cell. </p>
<p >This function is called by the assembly worker thread after the <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ab58efee20ef7bc636d902e5acb917f8f" title="Scatters the local assembly into the global system.">scatter()</a> function and is typically only used to call the finish member functions of all corresponding member functions like e.g. evaluators.</p>
<dl class="section attention"><dt>Attention</dt><dd>This function is silently assumed to be thread-safe, i.e. no thread may try to write to a common shared resource inside this function (without manual mutexing). </dd></dl>

</div>
</div>
<a id="a8aa125b7fcb9c47d64f858600c43e6dc" name="a8aa125b7fcb9c47d64f858600c43e6dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8aa125b7fcb9c47d64f858600c43e6dc">&#9670;&#160;</a></span>prepare() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FEAT::Assembly::TraceAssemblyJob::Task::prepare </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>&#160;</td>
          <td class="paramname"><em>facet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>local_facet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>facet_ori</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepares the task for assembly for a facet on a single one of its adjacent elements. </p>
<p >This function is called by the assembly worker thread each time the assembly on a new element begins. This function is called for boundary facets as well as for each inner facet and one of its adjacent elements if assemble_pairwise is false, otherwise the 7-parameter overload of this function is called. This function is typically used to gather various local data from the mesh and/or linear algebra containers prior to the actual local assembly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">facet</td><td>The index of the mesh facet that the following assembly is going to take place on.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cell</td><td>The index of the mesh element that the following assembly is going to take place on.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">local_facet</td><td>The index of the local facet on the element that the global facet corresponds to.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">facet_ori</td><td>The facet orientation code that encodes the orientation between the local reference facet and the global facet.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section attention"><dt>Attention</dt><dd>This function is silently assumed to be thread-safe, i.e. no thread may try to write to a common shared resource inside this function (without manual mutexing). </dd></dl>

</div>
</div>
<a id="a56499647b6f967601885772f479606a4" name="a56499647b6f967601885772f479606a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56499647b6f967601885772f479606a4">&#9670;&#160;</a></span>prepare() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FEAT::Assembly::TraceAssemblyJob::Task::prepare </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>&#160;</td>
          <td class="paramname"><em>facet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>&#160;</td>
          <td class="paramname"><em>cell_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespace_f_e_a_t.html#aea15318a59381180ea8b771242a3bbe1">Index</a>&#160;</td>
          <td class="paramname"><em>cell_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>local_facet_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>local_facet_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>facet_ori_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>facet_ori_b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepares the task for assembly for a facet on both of its adjacent elements. </p>
<p >This function is called by the assembly worker thread each time the assembly on a new inner facet begins, but only if <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#a9c33f58ea80d8dd40f57184ebd7a2274" title="Specifies whether this task assembles element pairs on inner facets simultaenously.">assemble_pairwise</a> is true, otherwise the assembler will call the 4-parameter overload of this function when assembling both adjacent elements successively. This function is typically used to gather various local data from the mesh and/or linear algebra containers prior to the actual local assembly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">facet</td><td>The index of the mesh facet that the following assembly is going to take place on.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cell_a,cell_b</td><td>The indices of the two mesh elements that share the common facet that the following assembly is going to take place on.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">local_facet_a,local_facet_b</td><td>The indices of the local facets on the two elements that the global facet corresponds to.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">facet_ori_a,facet_ori_b</td><td>The facet orientation codes that encodes the orientation between the local reference facets of both elements and the global facet.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section attention"><dt>Attention</dt><dd>This function is silently assumed to be thread-safe, i.e. no thread may try to write to a common shared resource inside this function (without manual mutexing). </dd></dl>

</div>
</div>
<a id="ab58efee20ef7bc636d902e5acb917f8f" name="ab58efee20ef7bc636d902e5acb917f8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab58efee20ef7bc636d902e5acb917f8f">&#9670;&#160;</a></span>scatter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FEAT::Assembly::TraceAssemblyJob::Task::scatter </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Scatters the local assembly into the global system. </p>
<p >This function is called by the assembly worker thread after the <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ab11afa40851d81f23099734093a182e5" title="Performs the local assembly on the current facet.">assemble()</a> function and is typically used to scatter the local (i.e. element-wise) assembled data into a global (i.e. mesh/patch-wise) container.</p>
<dl class="section note"><dt>Note</dt><dd>This function is called by the worker threads in a neighbor-mutually exclusive fashion, i.e. this function is never called by two (or more) threads at the same time, which are active on vertex-adjacent elements. This ensures that no race condition can appear when scattering a local matrix/vector into a global matrix/vector.</dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>This function is only called by the assembler if <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ac7590eb501918af7d0a5e547e55fdb0f" title="Specifies whether this task has a scatter() function, which is required to be called from within a cr...">need_scatter</a> is true, however, it must always exist even if <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ac7590eb501918af7d0a5e547e55fdb0f" title="Specifies whether this task has a scatter() function, which is required to be called from within a cr...">need_scatter</a> is false to prevent linker errors. </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a9c33f58ea80d8dd40f57184ebd7a2274" name="a9c33f58ea80d8dd40f57184ebd7a2274"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c33f58ea80d8dd40f57184ebd7a2274">&#9670;&#160;</a></span>assemble_pairwise</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr bool FEAT::Assembly::TraceAssemblyJob::Task::assemble_pairwise = true or false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Specifies whether this task assembles element pairs on inner facets simultaenously. </p>

<p class="definition">Definition at line <a class="el" href="trace__assembler_8hpp_source.html#l00186">186</a> of file <a class="el" href="trace__assembler_8hpp_source.html">trace_assembler.hpp</a>.</p>

</div>
</div>
<a id="a592fb29033c6b7032edf53e9be8aa913" name="a592fb29033c6b7032edf53e9be8aa913"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a592fb29033c6b7032edf53e9be8aa913">&#9670;&#160;</a></span>need_combine</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr bool FEAT::Assembly::TraceAssemblyJob::Task::need_combine = true or false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Specifies whether this task fas a <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ae832603dfd7f8f78dcc42d4aa0ba673c" title="Finishes the overall assembly and combines all local results.">combine()</a> function, which is required to be called from within a critical section after the overall assembly is finished. </p>

<p class="definition">Definition at line <a class="el" href="trace__assembler_8hpp_source.html#l00198">198</a> of file <a class="el" href="trace__assembler_8hpp_source.html">trace_assembler.hpp</a>.</p>

</div>
</div>
<a id="ac7590eb501918af7d0a5e547e55fdb0f" name="ac7590eb501918af7d0a5e547e55fdb0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7590eb501918af7d0a5e547e55fdb0f">&#9670;&#160;</a></span>need_scatter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr bool FEAT::Assembly::TraceAssemblyJob::Task::need_scatter = true or false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Specifies whether this task has a <a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html#ab58efee20ef7bc636d902e5acb917f8f" title="Scatters the local assembly into the global system.">scatter()</a> function, which is required to be called from within a critical section after the local assembly on each facet. </p>

<p class="definition">Definition at line <a class="el" href="trace__assembler_8hpp_source.html#l00192">192</a> of file <a class="el" href="trace__assembler_8hpp_source.html">trace_assembler.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>kernel/assembly/<a class="el" href="trace__assembler_8hpp_source.html">trace_assembler.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_f_e_a_t.html">FEAT</a></li><li class="navelem"><a class="el" href="namespace_f_e_a_t_1_1_assembly.html">Assembly</a></li><li class="navelem"><a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job.html">TraceAssemblyJob</a></li><li class="navelem"><a class="el" href="class_f_e_a_t_1_1_assembly_1_1_trace_assembly_job_1_1_task.html">Task</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FEAT: FEAT::Meshopt::RumpfFunctional&lt; DataType_, TrafoType_ &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">FEAT<span id="projectnumber">&#160;3</span>
   </div>
   <div id="projectbrief">Finite Element Analysis Toolbox</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">FEAT::Meshopt::RumpfFunctional&lt; DataType_, TrafoType_ &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Functionals for measuring and optimising mesh quality.  
 <a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="rumpf__functional_8hpp_source.html">rumpf_functional.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:aea0601b86bd9772d0ee62e0f0952cb7c"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional_base.html">RumpfFunctionalBase</a>&lt; DataType_ &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#aea0601b86bd9772d0ee62e0f0952cb7c">BaseClass</a></td></tr>
<tr class="memdesc:aea0601b86bd9772d0ee62e0f0952cb7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Our baseclass.  <a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#aea0601b86bd9772d0ee62e0f0952cb7c">More...</a><br /></td></tr>
<tr class="separator:aea0601b86bd9772d0ee62e0f0952cb7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8587f679534f6e8966a614764311a669"><td class="memItemLeft" align="right" valign="top">typedef DataType_&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8587f679534f6e8966a614764311a669">DataType</a></td></tr>
<tr class="memdesc:a8587f679534f6e8966a614764311a669"><td class="mdescLeft">&#160;</td><td class="mdescRight">Our data type.  <a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8587f679534f6e8966a614764311a669">More...</a><br /></td></tr>
<tr class="separator:a8587f679534f6e8966a614764311a669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9a4e977445858ff51e04d86c1aeaf2b"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="struct_f_e_a_t_1_1_shape_1_1_hypercube.html">Shape::Hypercube</a>&lt; shape_dim_ &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#ac9a4e977445858ff51e04d86c1aeaf2b">ShapeType</a></td></tr>
<tr class="memdesc:ac9a4e977445858ff51e04d86c1aeaf2b"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="namespace_f_e_a_t_1_1_shape.html" title="Shape namespace.">Shape</a> type of the underlying transformation.  <a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#ac9a4e977445858ff51e04d86c1aeaf2b">More...</a><br /></td></tr>
<tr class="separator:ac9a4e977445858ff51e04d86c1aeaf2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bb179113cb5f4c3a86fc67c71cd7134"><td class="memItemLeft" align="right" valign="top">typedef SpaceEvaluator::template ConfigTraits&lt; <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#aaa427ba78532c396a439baea8467e6ba">space_config</a> &gt;::EvalDataType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a2bb179113cb5f4c3a86fc67c71cd7134">SpaceEvalData</a></td></tr>
<tr class="memdesc:a2bb179113cb5f4c3a86fc67c71cd7134"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data from evaluating FE spaces.  <a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a2bb179113cb5f4c3a86fc67c71cd7134">More...</a><br /></td></tr>
<tr class="separator:a2bb179113cb5f4c3a86fc67c71cd7134"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfc7fca75e2c67410b614d47cd16af52"><td class="memItemLeft" align="right" valign="top">typedef TrafoSpace::template Evaluator&lt; <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a6c08c1a7d5b0681c279753a51d9c1470">TrafoEvaluator</a> &gt;::Type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#acfc7fca75e2c67410b614d47cd16af52">SpaceEvaluator</a></td></tr>
<tr class="memdesc:acfc7fca75e2c67410b614d47cd16af52"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="namespace_f_e_a_t_1_1_type.html" title="Type namespace.">Type</a> for evaluating the FE functions.  <a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#acfc7fca75e2c67410b614d47cd16af52">More...</a><br /></td></tr>
<tr class="separator:acfc7fca75e2c67410b614d47cd16af52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcb022ad375ebab78011e806e5aea616"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="class_f_e_a_t_1_1_tiny_1_1_vector.html">Tiny::Vector</a>&lt; DataType_, <a class="el" href="struct_f_e_a_t_1_1_shape_1_1_face_traits.html">Shape::FaceTraits</a>&lt; <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#ac9a4e977445858ff51e04d86c1aeaf2b">ShapeType</a>, 0 &gt;::count *<a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8f808b7214b6a1cab135242dd3662a7c">world_dim</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#abcb022ad375ebab78011e806e5aea616">Tgradh</a></td></tr>
<tr class="memdesc:abcb022ad375ebab78011e806e5aea616"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="namespace_f_e_a_t_1_1_type.html" title="Type namespace.">Type</a> for the gradient of the local cell sizes.  <a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#abcb022ad375ebab78011e806e5aea616">More...</a><br /></td></tr>
<tr class="separator:abcb022ad375ebab78011e806e5aea616"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6decfabe26926dc3500fedbc77d16469"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="class_f_e_a_t_1_1_tiny_1_1_matrix.html">Tiny::Matrix</a>&lt; DataType_, <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a9ab188e1d1d0d6126eaaabd15cf396be">shape_dim</a>, <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8f808b7214b6a1cab135242dd3662a7c">world_dim</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a6decfabe26926dc3500fedbc77d16469">TgradR</a></td></tr>
<tr class="memdesc:a6decfabe26926dc3500fedbc77d16469"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="namespace_f_e_a_t_1_1_type.html" title="Type namespace.">Type</a> for the gradient of the local reference mapping.  <a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a6decfabe26926dc3500fedbc77d16469">More...</a><br /></td></tr>
<tr class="separator:a6decfabe26926dc3500fedbc77d16469"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4bb870bf24fadc45531eedaadd4abee"><td class="memItemLeft" align="right" valign="top">typedef TrafoEvaluator::template ConfigTraits&lt; <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#aeb515f5238128e1c317fda1e933d65a0">trafo_config</a> &gt;::EvalDataType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#af4bb870bf24fadc45531eedaadd4abee">TrafoEvalData</a></td></tr>
<tr class="memdesc:af4bb870bf24fadc45531eedaadd4abee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data from evaluating the transformation.  <a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#af4bb870bf24fadc45531eedaadd4abee">More...</a><br /></td></tr>
<tr class="separator:af4bb870bf24fadc45531eedaadd4abee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c08c1a7d5b0681c279753a51d9c1470"><td class="memItemLeft" align="right" valign="top">typedef TrafoType::template Evaluator&lt; <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#ac9a4e977445858ff51e04d86c1aeaf2b">ShapeType</a>, <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8587f679534f6e8966a614764311a669">DataType</a> &gt;::Type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a6c08c1a7d5b0681c279753a51d9c1470">TrafoEvaluator</a></td></tr>
<tr class="memdesc:a6c08c1a7d5b0681c279753a51d9c1470"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="namespace_f_e_a_t_1_1_type.html" title="Type namespace.">Type</a> for evaluating the transformation.  <a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a6c08c1a7d5b0681c279753a51d9c1470">More...</a><br /></td></tr>
<tr class="separator:a6c08c1a7d5b0681c279753a51d9c1470"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afea2dc3185bc94c4cfc2706d138dec7f"><td class="memItemLeft" align="right" valign="top">typedef Intern::TrafoFE&lt; <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#ab4410967f76a2e14977aa403ce4e25fa">TrafoType</a> &gt;::Space&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#afea2dc3185bc94c4cfc2706d138dec7f">TrafoSpace</a></td></tr>
<tr class="memdesc:afea2dc3185bc94c4cfc2706d138dec7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The FE space associated with the transformation.  <a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#afea2dc3185bc94c4cfc2706d138dec7f">More...</a><br /></td></tr>
<tr class="separator:afea2dc3185bc94c4cfc2706d138dec7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4410967f76a2e14977aa403ce4e25fa"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="class_f_e_a_t_1_1_trafo_1_1_standard_1_1_mapping.html">Trafo::Standard::Mapping</a>&lt; <a class="el" href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html">Geometry::ConformalMesh</a>&lt; <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#ac9a4e977445858ff51e04d86c1aeaf2b">ShapeType</a>, <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8f808b7214b6a1cab135242dd3662a7c">world_dim</a>, DataType_ &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#ab4410967f76a2e14977aa403ce4e25fa">TrafoType</a></td></tr>
<tr class="memdesc:ab4410967f76a2e14977aa403ce4e25fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">The transformation this functional works on.  <a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#ab4410967f76a2e14977aa403ce4e25fa">More...</a><br /></td></tr>
<tr class="separator:ab4410967f76a2e14977aa403ce4e25fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a104ad968090323ac21dc7e7678dcd5"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="class_f_e_a_t_1_1_tiny_1_1_matrix.html">Tiny::Matrix</a>&lt; DataType_, <a class="el" href="struct_f_e_a_t_1_1_shape_1_1_face_traits.html">Shape::FaceTraits</a>&lt; <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#ac9a4e977445858ff51e04d86c1aeaf2b">ShapeType</a>, 0 &gt;::count, <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8f808b7214b6a1cab135242dd3662a7c">world_dim</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a9a104ad968090323ac21dc7e7678dcd5">Tx</a></td></tr>
<tr class="memdesc:a9a104ad968090323ac21dc7e7678dcd5"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="namespace_f_e_a_t_1_1_type.html" title="Type namespace.">Type</a> for a pack of local vertex coordinates.  <a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a9a104ad968090323ac21dc7e7678dcd5">More...</a><br /></td></tr>
<tr class="separator:a9a104ad968090323ac21dc7e7678dcd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a975b1ae2fca5f984ec0a8b6434adab69"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a975b1ae2fca5f984ec0a8b6434adab69">RumpfFunctional</a> (const DataType_ fac_frobenius_, const DataType_ fac_det_, const DataType_ fac_cof_, const DataType_ fac_reg_, const int exponent_det_)</td></tr>
<tr class="memdesc:a975b1ae2fca5f984ec0a8b6434adab69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a975b1ae2fca5f984ec0a8b6434adab69">More...</a><br /></td></tr>
<tr class="separator:a975b1ae2fca5f984ec0a8b6434adab69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae65ba8cc82103985484f53644825af68"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#ae65ba8cc82103985484f53644825af68">add_grad_h_part</a> (<a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a9a104ad968090323ac21dc7e7678dcd5">Tx</a> &amp;<a class="el" href="namespace_f_e_a_t.html#ad574925e947c823619c356d5d12b0815ae37b6e74a3bd476dfde7e0577b9e81d6">grad</a>, const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a6decfabe26926dc3500fedbc77d16469">TgradR</a> &amp;mat_tensor, const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a6c08c1a7d5b0681c279753a51d9c1470">TrafoEvaluator</a> &amp;trafo_eval, const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#acfc7fca75e2c67410b614d47cd16af52">SpaceEvaluator</a> &amp;space_eval, const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a9a104ad968090323ac21dc7e7678dcd5">Tx</a> &amp;x, const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8587f679534f6e8966a614764311a669">DataType</a> &amp;h, const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#abcb022ad375ebab78011e806e5aea616">Tgradh</a> &amp;grad_h)</td></tr>
<tr class="memdesc:ae65ba8cc82103985484f53644825af68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds the gradient h part to the local gradient.  <a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#ae65ba8cc82103985484f53644825af68">More...</a><br /></td></tr>
<tr class="separator:ae65ba8cc82103985484f53644825af68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a538c4d109878e1e8a6f000af8bf3530b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a538c4d109878e1e8a6f000af8bf3530b">eval_fval_cellwise</a> (<a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8587f679534f6e8966a614764311a669">DataType</a> &amp;fval, const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a6decfabe26926dc3500fedbc77d16469">TgradR</a> &amp;mat_tensor, const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a6c08c1a7d5b0681c279753a51d9c1470">TrafoEvaluator</a> &amp;trafo_eval, const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#acfc7fca75e2c67410b614d47cd16af52">SpaceEvaluator</a> &amp;space_eval, const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a9a104ad968090323ac21dc7e7678dcd5">Tx</a> &amp;x, const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8587f679534f6e8966a614764311a669">DataType</a> &amp;h, <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8587f679534f6e8966a614764311a669">DataType</a> &amp;fval_frobenius, <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8587f679534f6e8966a614764311a669">DataType</a> &amp;fval_cof, <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8587f679534f6e8966a614764311a669">DataType</a> &amp;fval_det)</td></tr>
<tr class="memdesc:a538c4d109878e1e8a6f000af8bf3530b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the different contributions to the functional's value on one cell.  <a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a538c4d109878e1e8a6f000af8bf3530b">More...</a><br /></td></tr>
<tr class="separator:a538c4d109878e1e8a6f000af8bf3530b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a800ba01856798ca8df8de933c42464c9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a800ba01856798ca8df8de933c42464c9">eval_fval_grad</a> (<a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8587f679534f6e8966a614764311a669">DataType</a> &amp;fval, <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a9a104ad968090323ac21dc7e7678dcd5">Tx</a> &amp;<a class="el" href="namespace_f_e_a_t.html#ad574925e947c823619c356d5d12b0815ae37b6e74a3bd476dfde7e0577b9e81d6">grad</a>, const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a6decfabe26926dc3500fedbc77d16469">TgradR</a> &amp;mat_tensor, const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a6c08c1a7d5b0681c279753a51d9c1470">TrafoEvaluator</a> &amp;trafo_eval, const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#acfc7fca75e2c67410b614d47cd16af52">SpaceEvaluator</a> &amp;space_eval, const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a9a104ad968090323ac21dc7e7678dcd5">Tx</a> &amp;x, const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8587f679534f6e8966a614764311a669">DataType</a> &amp;h)</td></tr>
<tr class="memdesc:a800ba01856798ca8df8de933c42464c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the functional's value and gradient on one cell.  <a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a800ba01856798ca8df8de933c42464c9">More...</a><br /></td></tr>
<tr class="separator:a800ba01856798ca8df8de933c42464c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-attribs" name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a9ab188e1d1d0d6126eaaabd15cf396be"><td class="memItemLeft" align="right" valign="top">static constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a9ab188e1d1d0d6126eaaabd15cf396be">shape_dim</a> = shape_dim_</td></tr>
<tr class="memdesc:a9ab188e1d1d0d6126eaaabd15cf396be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Our shape dimension.  <a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a9ab188e1d1d0d6126eaaabd15cf396be">More...</a><br /></td></tr>
<tr class="separator:a9ab188e1d1d0d6126eaaabd15cf396be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa427ba78532c396a439baea8467e6ba"><td class="memItemLeft" align="right" valign="top">static constexpr <a class="el" href="namespace_f_e_a_t.html#ad574925e947c823619c356d5d12b0815">SpaceTags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#aaa427ba78532c396a439baea8467e6ba">space_config</a> = <a class="el" href="namespace_f_e_a_t.html#ad574925e947c823619c356d5d12b0815ae28b67cfe4caf580ac626a141f19062a">SpaceTags::ref_grad</a></td></tr>
<tr class="memdesc:aaa427ba78532c396a439baea8467e6ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">For the FE space, we only need the gradients on the reference cell.  <a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#aaa427ba78532c396a439baea8467e6ba">More...</a><br /></td></tr>
<tr class="separator:aaa427ba78532c396a439baea8467e6ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb515f5238128e1c317fda1e933d65a0"><td class="memItemLeft" align="right" valign="top">static constexpr <a class="el" href="namespace_f_e_a_t.html#aeeeaf7afcb3a42f69b57031db04b2428">TrafoTags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#aeb515f5238128e1c317fda1e933d65a0">trafo_config</a> = <a class="el" href="namespace_f_e_a_t.html#aeeeaf7afcb3a42f69b57031db04b2428a2d68fb400ac4ae954f3e3120f03b17e3">TrafoTags::img_point</a> | <a class="el" href="namespace_f_e_a_t.html#aeeeaf7afcb3a42f69b57031db04b2428aaaff6440f63c38bcfdc6816c4d85411b">TrafoTags::jac_mat</a> | <a class="el" href="namespace_f_e_a_t.html#aeeeaf7afcb3a42f69b57031db04b2428abeec8d89f2e70c451ea6229f64290d74">TrafoTags::jac_det</a></td></tr>
<tr class="memdesc:aeb515f5238128e1c317fda1e933d65a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">We need the <a class="el" href="namespace_f_e_a_t_1_1_trafo.html" title="Transformation namespace.">Trafo</a> to evaluate the image point, the Jacobian and its determinant.  <a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#aeb515f5238128e1c317fda1e933d65a0">More...</a><br /></td></tr>
<tr class="separator:aeb515f5238128e1c317fda1e933d65a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f808b7214b6a1cab135242dd3662a7c"><td class="memItemLeft" align="right" valign="top">static constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8f808b7214b6a1cab135242dd3662a7c">world_dim</a> = <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a9ab188e1d1d0d6126eaaabd15cf396be">shape_dim</a></td></tr>
<tr class="memdesc:a8f808b7214b6a1cab135242dd3662a7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Our world dimension - only world_dim == shape_dim is supported.  <a href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8f808b7214b6a1cab135242dd3662a7c">More...</a><br /></td></tr>
<tr class="separator:a8f808b7214b6a1cab135242dd3662a7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename DataType_, typename TrafoType_&gt;<br />
class FEAT::Meshopt::RumpfFunctional&lt; DataType_, TrafoType_ &gt;</div><p >Functionals for measuring and optimising mesh quality. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">DataType_</td><td>Our data type</td></tr>
    <tr><td class="paramname">TrafoType_</td><td>The transformation mapping reference cells to the mesh</td></tr>
  </table>
  </dd>
</dl>
<p>The actual implementation has to be supplied by the specializations in TrafoType_.</p>
<p >A <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html" title="Functionals for measuring and optimising mesh quality.">RumpfFunctional</a> computes the cell local contribution to the local functional value and its gradient. The basic archetype is of the form</p>
<p class="formulaDsp">
<img class="formulaDsp light-mode-visible" alt="\[
  L( \nabla R_K ) = \int_K fac\_norm (\| \nabla R_K \|^2_F - d)^2
                         + fac\_cof (\| \mathrm{Cof}(\nabla R_K) \|^2_F - d)^2
                         + fac\_det (\det(\nabla R_K))^{p_d}
  + \frac{fac\_rec\_det}{\det(\nabla R_K) + \sqrt{(\mathrm{fac\_reg}^2 + \det(\nabla R_K)^2)}}
\]" src="form_242.png"/><img class="formulaDsp dark-mode-visible" alt="\[
  L( \nabla R_K ) = \int_K fac\_norm (\| \nabla R_K \|^2_F - d)^2
                         + fac\_cof (\| \mathrm{Cof}(\nabla R_K) \|^2_F - d)^2
                         + fac\_det (\det(\nabla R_K))^{p_d}
  + \frac{fac\_rec\_det}{\det(\nabla R_K) + \sqrt{(\mathrm{fac\_reg}^2 + \det(\nabla R_K)^2)}}
\]" src="form_242_dark.png"/>
</p>
<p >For the computation of the gradient of <img class="formulaInl light-mode-visible" alt="$ L $" src="form_243.png"/><img class="formulaInl dark-mode-visible" alt="$ L $" src="form_243_dark.png"/>, we need to calculate some directional derivatives wrt. matrices.</p>
<p >Let <img class="formulaInl light-mode-visible" alt="$ M: \mathbb{R} \to \mathbb{R}^{d \times d} $" src="form_244.png"/><img class="formulaInl dark-mode-visible" alt="$ M: \mathbb{R} \to \mathbb{R}^{d \times d} $" src="form_244_dark.png"/> be a matrix valued mapping. Then we have the following identities:  </p><p class="formulaDsp">
<img class="formulaDsp light-mode-visible" alt="\begin{align*}
   \frac{d}{dt} M(t)^{-1} &amp;= - M^{-1}(t) \frac{d M}{d t}(t) M^{-1}(t) \\
   \frac{d}{dt} \| M(t) \|_F^2 &amp;=  M(t) : \frac{d M}{d t}(t)\\
   \frac{d}{dt} \mathrm{Cof}( M(t) ) &amp;=  M(t)^{-T} : \frac{d M}{d t}(t) \mathrm{Cof}(M(t))
   - M^{-T} \left(\frac{d M}{d t}(t) \right)^T \mathrm{Cof}(M(t)) \\
   \frac{d}{dt} \mathrm{det}( M(t) ) &amp;=  \mathrm{det}(M(t)) \left( M^{-1}(t) : \frac{d M}{d t}(t) \right)
\end{align*}" src="form_245.png"/><img class="formulaDsp dark-mode-visible" alt="\begin{align*}
   \frac{d}{dt} M(t)^{-1} &amp;= - M^{-1}(t) \frac{d M}{d t}(t) M^{-1}(t) \\
   \frac{d}{dt} \| M(t) \|_F^2 &amp;=  M(t) : \frac{d M}{d t}(t)\\
   \frac{d}{dt} \mathrm{Cof}( M(t) ) &amp;=  M(t)^{-T} : \frac{d M}{d t}(t) \mathrm{Cof}(M(t))
   - M^{-T} \left(\frac{d M}{d t}(t) \right)^T \mathrm{Cof}(M(t)) \\
   \frac{d}{dt} \mathrm{det}( M(t) ) &amp;=  \mathrm{det}(M(t)) \left( M^{-1}(t) : \frac{d M}{d t}(t) \right)
\end{align*}" src="form_245_dark.png"/>
</p>
<p> With this, we can compute directional derivatives of a function <img class="formulaInl light-mode-visible" alt="$ f: \mathbb{R}^{d \times d} \to V $" src="form_246.png"/><img class="formulaInl dark-mode-visible" alt="$ f: \mathbb{R}^{d \times d} \to V $" src="form_246_dark.png"/> with e.g. <img class="formulaInl light-mode-visible" alt="$ V = \mathbb{R} $" src="form_247.png"/><img class="formulaInl dark-mode-visible" alt="$ V = \mathbb{R} $" src="form_247_dark.png"/> or <img class="formulaInl light-mode-visible" alt="$ V = \mathbb{R}^{d \times d} $" src="form_248.png"/><img class="formulaInl dark-mode-visible" alt="$ V = \mathbb{R}^{d \times d} $" src="form_248_dark.png"/> with regard to matrices according to  </p><p class="formulaDsp">
<img class="formulaDsp light-mode-visible" alt="\[
  M(t) = A + tB, \quad f'(A)B = \left. \frac{d f(M(t))}{dt}\right|_{t = 0}.
\]" src="form_249.png"/><img class="formulaDsp dark-mode-visible" alt="\[
  M(t) = A + tB, \quad f'(A)B = \left. \frac{d f(M(t))}{dt}\right|_{t = 0}.
\]" src="form_249_dark.png"/>
</p>
<p> Here, <img class="formulaInl light-mode-visible" alt="$ M(0) = A $" src="form_250.png"/><img class="formulaInl dark-mode-visible" alt="$ M(0) = A $" src="form_250_dark.png"/> and <img class="formulaInl light-mode-visible" alt="$ \frac{d M}{d t}(t) = B $" src="form_251.png"/><img class="formulaInl dark-mode-visible" alt="$ \frac{d M}{d t}(t) = B $" src="form_251_dark.png"/>. For computing the directional derivatives of this <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html" title="Functionals for measuring and optimising mesh quality.">RumpfFunctional</a>, set <img class="formulaInl light-mode-visible" alt="$ A = \nabla R_K $" src="form_252.png"/><img class="formulaInl dark-mode-visible" alt="$ A = \nabla R_K $" src="form_252_dark.png"/> (the current FE function) and <img class="formulaInl light-mode-visible" alt="$ B = \nabla \eta $" src="form_253.png"/><img class="formulaInl dark-mode-visible" alt="$ B = \nabla \eta $" src="form_253_dark.png"/> (test function). Because the form is nonlinear, it cannot be represented as a matrix where the columns are associated with the trial functions.</p>
<p >So we get  </p><p class="formulaDsp">
<img class="formulaDsp light-mode-visible" alt="\begin{align*}
  \frac{d}{dt} \left( (\| \nabla R_K \|_F^2 - d)^2\right)' \eta &amp;= 4(\| \nabla R_K \|_F^2 - d)
  \nabla R_K : \nabla \eta \\
  \frac{d}{dt} \left( (\| \mathrm{Cof}(\nabla R_K) \|_F^2 - d)^2\right)' \eta &amp; =
    4(\| \mathrm{Cof}(\nabla R_K) \|_F^2 - d) ~ \mathrm{Cof}(\nabla R_K) :
     \left( \left( \left( (\nabla R_K)^{-1} :\nabla \eta ~ I_d - (\nabla R_K)^{-1} \nabla \eta \right) \right) \mathrm{Cof}(\nabla R_K) \right) \\
  \frac{d}{dt} \left( \mathrm{det}(\nabla R_K)^p \right)' \eta &amp; = p~\mathrm{det}(\nabla R_K )^p
  (\nabla R_K)^{-1} : \nabla \eta.
\end{align*}" src="form_254.png"/><img class="formulaDsp dark-mode-visible" alt="\begin{align*}
  \frac{d}{dt} \left( (\| \nabla R_K \|_F^2 - d)^2\right)' \eta &amp;= 4(\| \nabla R_K \|_F^2 - d)
  \nabla R_K : \nabla \eta \\
  \frac{d}{dt} \left( (\| \mathrm{Cof}(\nabla R_K) \|_F^2 - d)^2\right)' \eta &amp; =
    4(\| \mathrm{Cof}(\nabla R_K) \|_F^2 - d) ~ \mathrm{Cof}(\nabla R_K) :
     \left( \left( \left( (\nabla R_K)^{-1} :\nabla \eta ~ I_d - (\nabla R_K)^{-1} \nabla \eta \right) \right) \mathrm{Cof}(\nabla R_K) \right) \\
  \frac{d}{dt} \left( \mathrm{det}(\nabla R_K)^p \right)' \eta &amp; = p~\mathrm{det}(\nabla R_K )^p
  (\nabla R_K)^{-1} : \nabla \eta.
\end{align*}" src="form_254_dark.png"/>
</p>
<p >Note that the test function <img class="formulaInl light-mode-visible" alt="$ \eta $" src="form_255.png"/><img class="formulaInl dark-mode-visible" alt="$ \eta $" src="form_255_dark.png"/> might not be the standard FE basis functions as defined by the FE space used (call those <img class="formulaInl light-mode-visible" alt="$ \hat{\eta} $" src="form_256.png"/><img class="formulaInl dark-mode-visible" alt="$ \hat{\eta} $" src="form_256_dark.png"/>). They might be with regard to a different reference cell, so a transformation is involved, which is realized by passing the [c] material tensor [/c] <img class="formulaInl light-mode-visible" alt="$ M $" src="form_257.png"/><img class="formulaInl dark-mode-visible" alt="$ M $" src="form_257_dark.png"/> (which can be identified with a matrix in this case) to corresponding functions and using the relation  </p><p class="formulaDsp">
<img class="formulaDsp light-mode-visible" alt="\[
  \nabla \eta = M^T \nabla \hat{\eta},
\]" src="form_258.png"/><img class="formulaDsp dark-mode-visible" alt="\[
  \nabla \eta = M^T \nabla \hat{\eta},
\]" src="form_258_dark.png"/>
</p>
<p> which is nothing but the chain rule applied to <img class="formulaInl light-mode-visible" alt="$ \eta := \hat{\eta} \circ M$" src="form_259.png"/><img class="formulaInl dark-mode-visible" alt="$ \eta := \hat{\eta} \circ M$" src="form_259_dark.png"/>. </p>

<p class="definition">Definition at line <a class="el" href="rumpf__functional_8hpp_source.html#l00188">188</a> of file <a class="el" href="rumpf__functional_8hpp_source.html">rumpf_functional.hpp</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="aea0601b86bd9772d0ee62e0f0952cb7c" name="aea0601b86bd9772d0ee62e0f0952cb7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea0601b86bd9772d0ee62e0f0952cb7c">&#9670;&#160;</a></span>BaseClass</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType_ , typename TrafoType_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional_base.html">RumpfFunctionalBase</a>&lt;DataType_&gt; <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html">FEAT::Meshopt::RumpfFunctional</a>&lt; DataType_, TrafoType_ &gt;::BaseClass</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Our baseclass. </p>

<p class="definition">Definition at line <a class="el" href="rumpf__functional_8hpp_source.html#l00192">192</a> of file <a class="el" href="rumpf__functional_8hpp_source.html">rumpf_functional.hpp</a>.</p>

</div>
</div>
<a id="a8587f679534f6e8966a614764311a669" name="a8587f679534f6e8966a614764311a669"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8587f679534f6e8966a614764311a669">&#9670;&#160;</a></span>DataType</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType_ , typename TrafoType_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">typedef DataType_ <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html">FEAT::Meshopt::RumpfFunctional</a>&lt; DataType_, TrafoType_ &gt;::DataType</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Our data type. </p>

<p class="definition">Definition at line <a class="el" href="rumpf__functional_8hpp_source.html#l00195">195</a> of file <a class="el" href="rumpf__functional_8hpp_source.html">rumpf_functional.hpp</a>.</p>

</div>
</div>
<a id="ac9a4e977445858ff51e04d86c1aeaf2b" name="ac9a4e977445858ff51e04d86c1aeaf2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9a4e977445858ff51e04d86c1aeaf2b">&#9670;&#160;</a></span>ShapeType</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType_ , typename TrafoType_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="struct_f_e_a_t_1_1_shape_1_1_hypercube.html">Shape::Hypercube</a>&lt;shape_dim_&gt; <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html">FEAT::Meshopt::RumpfFunctional</a>&lt; DataType_, TrafoType_ &gt;::ShapeType</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="namespace_f_e_a_t_1_1_shape.html" title="Shape namespace.">Shape</a> type of the underlying transformation. </p>

<p class="definition">Definition at line <a class="el" href="rumpf__functional_8hpp_source.html#l00201">201</a> of file <a class="el" href="rumpf__functional_8hpp_source.html">rumpf_functional.hpp</a>.</p>

</div>
</div>
<a id="a2bb179113cb5f4c3a86fc67c71cd7134" name="a2bb179113cb5f4c3a86fc67c71cd7134"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bb179113cb5f4c3a86fc67c71cd7134">&#9670;&#160;</a></span>SpaceEvalData</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType_ , typename TrafoType_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">typedef SpaceEvaluator::template ConfigTraits&lt;<a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#aaa427ba78532c396a439baea8467e6ba">space_config</a>&gt;::EvalDataType <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html">FEAT::Meshopt::RumpfFunctional</a>&lt; DataType_, TrafoType_ &gt;::SpaceEvalData</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Data from evaluating FE spaces. </p>

<p class="definition">Definition at line <a class="el" href="rumpf__functional_8hpp_source.html#l00228">228</a> of file <a class="el" href="rumpf__functional_8hpp_source.html">rumpf_functional.hpp</a>.</p>

</div>
</div>
<a id="acfc7fca75e2c67410b614d47cd16af52" name="acfc7fca75e2c67410b614d47cd16af52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfc7fca75e2c67410b614d47cd16af52">&#9670;&#160;</a></span>SpaceEvaluator</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType_ , typename TrafoType_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">typedef TrafoSpace::template Evaluator&lt;<a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a6c08c1a7d5b0681c279753a51d9c1470">TrafoEvaluator</a>&gt;::Type <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html">FEAT::Meshopt::RumpfFunctional</a>&lt; DataType_, TrafoType_ &gt;::SpaceEvaluator</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="namespace_f_e_a_t_1_1_type.html" title="Type namespace.">Type</a> for evaluating the FE functions. </p>

<p class="definition">Definition at line <a class="el" href="rumpf__functional_8hpp_source.html#l00218">218</a> of file <a class="el" href="rumpf__functional_8hpp_source.html">rumpf_functional.hpp</a>.</p>

</div>
</div>
<a id="abcb022ad375ebab78011e806e5aea616" name="abcb022ad375ebab78011e806e5aea616"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcb022ad375ebab78011e806e5aea616">&#9670;&#160;</a></span>Tgradh</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType_ , typename TrafoType_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="class_f_e_a_t_1_1_tiny_1_1_vector.html">Tiny::Vector</a>&lt;DataType_, <a class="el" href="struct_f_e_a_t_1_1_shape_1_1_face_traits.html">Shape::FaceTraits</a>&lt;<a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#ac9a4e977445858ff51e04d86c1aeaf2b">ShapeType</a>,0&gt;::count*<a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8f808b7214b6a1cab135242dd3662a7c">world_dim</a>&gt; <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html">FEAT::Meshopt::RumpfFunctional</a>&lt; DataType_, TrafoType_ &gt;::Tgradh</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="namespace_f_e_a_t_1_1_type.html" title="Type namespace.">Type</a> for the gradient of the local cell sizes. </p>

<p class="definition">Definition at line <a class="el" href="rumpf__functional_8hpp_source.html#l00210">210</a> of file <a class="el" href="rumpf__functional_8hpp_source.html">rumpf_functional.hpp</a>.</p>

</div>
</div>
<a id="a6decfabe26926dc3500fedbc77d16469" name="a6decfabe26926dc3500fedbc77d16469"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6decfabe26926dc3500fedbc77d16469">&#9670;&#160;</a></span>TgradR</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType_ , typename TrafoType_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="class_f_e_a_t_1_1_tiny_1_1_matrix.html">Tiny::Matrix</a>&lt;DataType_, <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a9ab188e1d1d0d6126eaaabd15cf396be">shape_dim</a>, <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8f808b7214b6a1cab135242dd3662a7c">world_dim</a>&gt; <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html">FEAT::Meshopt::RumpfFunctional</a>&lt; DataType_, TrafoType_ &gt;::TgradR</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="namespace_f_e_a_t_1_1_type.html" title="Type namespace.">Type</a> for the gradient of the local reference mapping. </p>

<p class="definition">Definition at line <a class="el" href="rumpf__functional_8hpp_source.html#l00213">213</a> of file <a class="el" href="rumpf__functional_8hpp_source.html">rumpf_functional.hpp</a>.</p>

</div>
</div>
<a id="af4bb870bf24fadc45531eedaadd4abee" name="af4bb870bf24fadc45531eedaadd4abee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4bb870bf24fadc45531eedaadd4abee">&#9670;&#160;</a></span>TrafoEvalData</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType_ , typename TrafoType_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">typedef TrafoEvaluator::template ConfigTraits&lt;<a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#aeb515f5238128e1c317fda1e933d65a0">trafo_config</a>&gt;::EvalDataType <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html">FEAT::Meshopt::RumpfFunctional</a>&lt; DataType_, TrafoType_ &gt;::TrafoEvalData</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Data from evaluating the transformation. </p>

<p class="definition">Definition at line <a class="el" href="rumpf__functional_8hpp_source.html#l00226">226</a> of file <a class="el" href="rumpf__functional_8hpp_source.html">rumpf_functional.hpp</a>.</p>

</div>
</div>
<a id="a6c08c1a7d5b0681c279753a51d9c1470" name="a6c08c1a7d5b0681c279753a51d9c1470"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c08c1a7d5b0681c279753a51d9c1470">&#9670;&#160;</a></span>TrafoEvaluator</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType_ , typename TrafoType_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">typedef TrafoType::template Evaluator&lt;<a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#ac9a4e977445858ff51e04d86c1aeaf2b">ShapeType</a>,<a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8587f679534f6e8966a614764311a669">DataType</a>&gt;::Type <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html">FEAT::Meshopt::RumpfFunctional</a>&lt; DataType_, TrafoType_ &gt;::TrafoEvaluator</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="namespace_f_e_a_t_1_1_type.html" title="Type namespace.">Type</a> for evaluating the transformation. </p>

<p class="definition">Definition at line <a class="el" href="rumpf__functional_8hpp_source.html#l00216">216</a> of file <a class="el" href="rumpf__functional_8hpp_source.html">rumpf_functional.hpp</a>.</p>

</div>
</div>
<a id="afea2dc3185bc94c4cfc2706d138dec7f" name="afea2dc3185bc94c4cfc2706d138dec7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afea2dc3185bc94c4cfc2706d138dec7f">&#9670;&#160;</a></span>TrafoSpace</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType_ , typename TrafoType_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">typedef Intern::TrafoFE&lt;<a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#ab4410967f76a2e14977aa403ce4e25fa">TrafoType</a>&gt;::Space <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html">FEAT::Meshopt::RumpfFunctional</a>&lt; DataType_, TrafoType_ &gt;::TrafoSpace</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The FE space associated with the transformation. </p>

<p class="definition">Definition at line <a class="el" href="rumpf__functional_8hpp_source.html#l00205">205</a> of file <a class="el" href="rumpf__functional_8hpp_source.html">rumpf_functional.hpp</a>.</p>

</div>
</div>
<a id="ab4410967f76a2e14977aa403ce4e25fa" name="ab4410967f76a2e14977aa403ce4e25fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4410967f76a2e14977aa403ce4e25fa">&#9670;&#160;</a></span>TrafoType</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType_ , typename TrafoType_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="class_f_e_a_t_1_1_trafo_1_1_standard_1_1_mapping.html">Trafo::Standard::Mapping</a>&lt;<a class="el" href="class_f_e_a_t_1_1_geometry_1_1_conformal_mesh.html">Geometry::ConformalMesh</a>&lt;<a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#ac9a4e977445858ff51e04d86c1aeaf2b">ShapeType</a>, <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8f808b7214b6a1cab135242dd3662a7c">world_dim</a>, DataType_&gt; &gt; <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html">FEAT::Meshopt::RumpfFunctional</a>&lt; DataType_, TrafoType_ &gt;::TrafoType</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The transformation this functional works on. </p>

<p class="definition">Definition at line <a class="el" href="rumpf__functional_8hpp_source.html#l00203">203</a> of file <a class="el" href="rumpf__functional_8hpp_source.html">rumpf_functional.hpp</a>.</p>

</div>
</div>
<a id="a9a104ad968090323ac21dc7e7678dcd5" name="a9a104ad968090323ac21dc7e7678dcd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a104ad968090323ac21dc7e7678dcd5">&#9670;&#160;</a></span>Tx</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType_ , typename TrafoType_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="class_f_e_a_t_1_1_tiny_1_1_matrix.html">Tiny::Matrix</a>&lt;DataType_, <a class="el" href="struct_f_e_a_t_1_1_shape_1_1_face_traits.html">Shape::FaceTraits</a>&lt;<a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#ac9a4e977445858ff51e04d86c1aeaf2b">ShapeType</a>,0&gt;::count, <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8f808b7214b6a1cab135242dd3662a7c">world_dim</a>&gt; <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html">FEAT::Meshopt::RumpfFunctional</a>&lt; DataType_, TrafoType_ &gt;::Tx</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="namespace_f_e_a_t_1_1_type.html" title="Type namespace.">Type</a> for a pack of local vertex coordinates. </p>

<p class="definition">Definition at line <a class="el" href="rumpf__functional_8hpp_source.html#l00208">208</a> of file <a class="el" href="rumpf__functional_8hpp_source.html">rumpf_functional.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a975b1ae2fca5f984ec0a8b6434adab69" name="a975b1ae2fca5f984ec0a8b6434adab69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a975b1ae2fca5f984ec0a8b6434adab69">&#9670;&#160;</a></span>RumpfFunctional()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType_ , typename TrafoType_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html">FEAT::Meshopt::RumpfFunctional</a>&lt; DataType_, TrafoType_ &gt;::RumpfFunctional </td>
          <td>(</td>
          <td class="paramtype">const DataType_&#160;</td>
          <td class="paramname"><em>fac_frobenius_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const DataType_&#160;</td>
          <td class="paramname"><em>fac_det_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const DataType_&#160;</td>
          <td class="paramname"><em>fac_cof_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const DataType_&#160;</td>
          <td class="paramname"><em>fac_reg_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>exponent_det_</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fac_frobenius_</td><td>Factor for the Rumpf functional</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fac_det_</td><td>Factor for the Rumpf functional</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fac_cof_</td><td>Factor for the Rumpf functional</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fac_reg_</td><td>Regularization factor for the Rumpf functional</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">exponent_det_</td><td>The exponent for the det term, called <img class="formulaInl light-mode-visible" alt="$ p_d $" src="form_260.png"/><img class="formulaInl dark-mode-visible" alt="$ p_d $" src="form_260_dark.png"/> above.</td></tr>
  </table>
  </dd>
</dl>
<p>Because we want the functional to have a minimum if the mesh consists of correctly scaled versions of the optimal element (that is, every local transformation is the identity modulo translation), fac_det and fac_rec_det are now coupled.</p>
<p ><img class="formulaInl light-mode-visible" alt="$ f(d) = c_s d^p + \frac{1}{d + \sqrt{ \mathrm{fac\_reg}^2 + d^2}} $" src="form_261.png"/><img class="formulaInl dark-mode-visible" alt="$ f(d) = c_s d^p + \frac{1}{d + \sqrt{ \mathrm{fac\_reg}^2 + d^2}} $" src="form_261_dark.png"/> We want to have <img class="formulaInl light-mode-visible" alt="$ f'(1) = 0 \Leftrightarrow c_s = \frac{1}{d \sqrt{ \mathrm{fac\_reg}^2 + d^2} +
\mathrm{fac\_reg}^2 + d^2} $" src="form_262.png"/><img class="formulaInl dark-mode-visible" alt="$ f'(1) = 0 \Leftrightarrow c_s = \frac{1}{d \sqrt{ \mathrm{fac\_reg}^2 + d^2} +
\mathrm{fac\_reg}^2 + d^2} $" src="form_262_dark.png"/> for <img class="formulaInl light-mode-visible" alt="$ p = 1 $" src="form_263.png"/><img class="formulaInl dark-mode-visible" alt="$ p = 1 $" src="form_263_dark.png"/> or <img class="formulaInl light-mode-visible" alt="$ c_s = \frac{1}{2d (d \sqrt{ \mathrm{fac\_reg}^2 + d^2} + \mathrm{fac\_reg}^2 + d^2)} $" src="form_264.png"/><img class="formulaInl dark-mode-visible" alt="$ c_s = \frac{1}{2d (d \sqrt{ \mathrm{fac\_reg}^2 + d^2} + \mathrm{fac\_reg}^2 + d^2)} $" src="form_264_dark.png"/> for <img class="formulaInl light-mode-visible" alt="$ d = 1 $" src="form_265.png"/><img class="formulaInl dark-mode-visible" alt="$ d = 1 $" src="form_265_dark.png"/> for p = 2. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ae65ba8cc82103985484f53644825af68" name="ae65ba8cc82103985484f53644825af68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae65ba8cc82103985484f53644825af68">&#9670;&#160;</a></span>add_grad_h_part()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType_ , typename TrafoType_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html">FEAT::Meshopt::RumpfFunctional</a>&lt; DataType_, TrafoType_ &gt;::add_grad_h_part </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a9a104ad968090323ac21dc7e7678dcd5">Tx</a> &amp;&#160;</td>
          <td class="paramname"><em>grad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a6decfabe26926dc3500fedbc77d16469">TgradR</a> &amp;&#160;</td>
          <td class="paramname"><em>mat_tensor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a6c08c1a7d5b0681c279753a51d9c1470">TrafoEvaluator</a> &amp;&#160;</td>
          <td class="paramname"><em>trafo_eval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#acfc7fca75e2c67410b614d47cd16af52">SpaceEvaluator</a> &amp;&#160;</td>
          <td class="paramname"><em>space_eval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a9a104ad968090323ac21dc7e7678dcd5">Tx</a> &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8587f679534f6e8966a614764311a669">DataType</a> &amp;&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#abcb022ad375ebab78011e806e5aea616">Tgradh</a> &amp;&#160;</td>
          <td class="paramname"><em>grad_h</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds the gradient h part to the local gradient. </p>
<p >Due to the chain rule, the derivatives of h wrt. the vertex coordinates x have been computed and contribute to the local gradient.</p>
<p >The optimal scales <img class="formulaInl light-mode-visible" alt="$ h $" src="form_228.png"/><img class="formulaInl dark-mode-visible" alt="$ h $" src="form_228_dark.png"/> depend on the concentration <img class="formulaInl light-mode-visible" alt="$ c $" src="form_229.png"/><img class="formulaInl dark-mode-visible" alt="$ c $" src="form_229_dark.png"/> by the relation  </p><p class="formulaDsp">
<img class="formulaDsp light-mode-visible" alt="\[
  \forall K_k \in \mathcal{T}_h: h_k = \left( \frac{c (K_k)}{\sum_{l=1}^N c(K_l) \sum_{l=1}^N
  \mathrm{det} \nabla R_{T,l}(\phi)} \right)^{\frac{1}{d}}
\]" src="form_230.png"/><img class="formulaDsp dark-mode-visible" alt="\[
  \forall K_k \in \mathcal{T}_h: h_k = \left( \frac{c (K_k)}{\sum_{l=1}^N c(K_l) \sum_{l=1}^N
  \mathrm{det} \nabla R_{T,l}(\phi)} \right)^{\frac{1}{d}}
\]" src="form_230_dark.png"/>
</p>
<p >The concentration function in turn indirectly depends on the vertex locations <img class="formulaInl light-mode-visible" alt="$ \{ x_i : i=1, \dots, n \} $" src="form_231.png"/><img class="formulaInl dark-mode-visible" alt="$ \{ x_i : i=1, \dots, n \} $" src="form_231_dark.png"/> via </p><p class="formulaDsp">
<img class="formulaDsp light-mode-visible" alt="\[ c(K_k) = (\alpha + \sum_{x_j \in K_k} \varphi(x_j))^\beta, \]" src="form_232.png"/><img class="formulaDsp dark-mode-visible" alt="\[ c(K_k) = (\alpha + \sum_{x_j \in K_k} \varphi(x_j))^\beta, \]" src="form_232_dark.png"/>
</p>
<p> so that we have to take this dependency into account for the full gradient. Define  </p><p class="formulaDsp">
<img class="formulaDsp light-mode-visible" alt="\[
  s_d := \sum_{l=1}^N \det(\nabla R_{T,l}(\Phi)), \quad s_c :=  \frac{c (K_k)}{\sum_{l=1}^N c(K_l)}.
\]" src="form_271.png"/><img class="formulaDsp dark-mode-visible" alt="\[
  s_d := \sum_{l=1}^N \det(\nabla R_{T,l}(\Phi)), \quad s_c :=  \frac{c (K_k)}{\sum_{l=1}^N c(K_l)}.
\]" src="form_271_dark.png"/>
</p>
<p> So for each <img class="formulaInl light-mode-visible" alt="$ x_j $" src="form_234.png"/><img class="formulaInl dark-mode-visible" alt="$ x_j $" src="form_234_dark.png"/> we arrive at  </p><p class="formulaDsp">
<img class="formulaDsp light-mode-visible" alt="\begin{align*}
  \frac{\partial h(K_k)}{\partial x_j} &amp; = \frac{1}{d} \left( \frac{c(K_k)}{s_d s_c} \right)^
  {\frac{1}{d}-1} \left[ c(K_k) ( \frac{\partial s_d}{\partial x_j} s_c + s_d
  \frac{\partial s_c}{\partial x_j} ) + \frac{\partial c(K_k)}{\partial x_j} s_d s_c \right]
  (s_d s_c)^{-2}
\end{align*}" src="form_272.png"/><img class="formulaDsp dark-mode-visible" alt="\begin{align*}
  \frac{\partial h(K_k)}{\partial x_j} &amp; = \frac{1}{d} \left( \frac{c(K_k)}{s_d s_c} \right)^
  {\frac{1}{d}-1} \left[ c(K_k) ( \frac{\partial s_d}{\partial x_j} s_c + s_d
  \frac{\partial s_c}{\partial x_j} ) + \frac{\partial c(K_k)}{\partial x_j} s_d s_c \right]
  (s_d s_c)^{-2}
\end{align*}" src="form_272_dark.png"/>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">grad</td><td>The local gradient of the functional to which the contribution is added.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mat_tensor</td><td>The material function.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trafo_eval</td><td>Evaluator for the transformation.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">space_eval</td><td>Evaluator for the FE spaces.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>(number of vertices per cell) <img class="formulaInl light-mode-visible" alt="$ \times $" src="form_266.png"/><img class="formulaInl dark-mode-visible" alt="$ \times $" src="form_266_dark.png"/> (world_dim) - matrix that holds the local coordinates that define the cell <img class="formulaInl light-mode-visible" alt="$ K $" src="form_267.png"/><img class="formulaInl dark-mode-visible" alt="$ K $" src="form_267_dark.png"/>. These are the coefficients for the FE function representing the transformation.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>The local optimal scale</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">grad_h</td><td>The gradient of h wrt. the local vertex coordinates </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a538c4d109878e1e8a6f000af8bf3530b" name="a538c4d109878e1e8a6f000af8bf3530b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a538c4d109878e1e8a6f000af8bf3530b">&#9670;&#160;</a></span>eval_fval_cellwise()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType_ , typename TrafoType_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html">FEAT::Meshopt::RumpfFunctional</a>&lt; DataType_, TrafoType_ &gt;::eval_fval_cellwise </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8587f679534f6e8966a614764311a669">DataType</a> &amp;&#160;</td>
          <td class="paramname"><em>fval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a6decfabe26926dc3500fedbc77d16469">TgradR</a> &amp;&#160;</td>
          <td class="paramname"><em>mat_tensor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a6c08c1a7d5b0681c279753a51d9c1470">TrafoEvaluator</a> &amp;&#160;</td>
          <td class="paramname"><em>trafo_eval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#acfc7fca75e2c67410b614d47cd16af52">SpaceEvaluator</a> &amp;&#160;</td>
          <td class="paramname"><em>space_eval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a9a104ad968090323ac21dc7e7678dcd5">Tx</a> &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8587f679534f6e8966a614764311a669">DataType</a> &amp;&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8587f679534f6e8966a614764311a669">DataType</a> &amp;&#160;</td>
          <td class="paramname"><em>fval_frobenius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8587f679534f6e8966a614764311a669">DataType</a> &amp;&#160;</td>
          <td class="paramname"><em>fval_cof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8587f679534f6e8966a614764311a669">DataType</a> &amp;&#160;</td>
          <td class="paramname"><em>fval_det</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the different contributions to the functional's value on one cell. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">fval</td><td>The functional value on this cell.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mat_tensor</td><td>The material function.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trafo_eval</td><td>Evaluator for the transformation.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">space_eval</td><td>Evaluator for the FE spaces.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>(number of vertices per cell) <img class="formulaInl light-mode-visible" alt="$ \times $" src="form_266.png"/><img class="formulaInl dark-mode-visible" alt="$ \times $" src="form_266_dark.png"/> (world_dim) - matrix that holds the local coordinates that define the cell <img class="formulaInl light-mode-visible" alt="$ K $" src="form_267.png"/><img class="formulaInl dark-mode-visible" alt="$ K $" src="form_267_dark.png"/>. These are the coefficients for the FE function representing the transformation.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>The local optimal scale.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fval_frobenius</td><td>Contribution of <img class="formulaInl light-mode-visible" alt="$ \| \nabla R_K \|_F^2 $" src="form_268.png"/><img class="formulaInl dark-mode-visible" alt="$ \| \nabla R_K \|_F^2 $" src="form_268_dark.png"/>.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fval_cof</td><td>Contribution of <img class="formulaInl light-mode-visible" alt="$ \| \mathrm{Cof}(\nabla R_K) \|_F^2 $" src="form_269.png"/><img class="formulaInl dark-mode-visible" alt="$ \| \mathrm{Cof}(\nabla R_K) \|_F^2 $" src="form_269_dark.png"/>.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fval_det</td><td>Contribution of <img class="formulaInl light-mode-visible" alt="$ \mathrm{det}(\nabla R_K)$" src="form_270.png"/><img class="formulaInl dark-mode-visible" alt="$ \mathrm{det}(\nabla R_K)$" src="form_270_dark.png"/>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>: This is for debugging and visualization purposes and does not compute the local gradient. </dd></dl>

</div>
</div>
<a id="a800ba01856798ca8df8de933c42464c9" name="a800ba01856798ca8df8de933c42464c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a800ba01856798ca8df8de933c42464c9">&#9670;&#160;</a></span>eval_fval_grad()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType_ , typename TrafoType_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html">FEAT::Meshopt::RumpfFunctional</a>&lt; DataType_, TrafoType_ &gt;::eval_fval_grad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8587f679534f6e8966a614764311a669">DataType</a> &amp;&#160;</td>
          <td class="paramname"><em>fval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a9a104ad968090323ac21dc7e7678dcd5">Tx</a> &amp;&#160;</td>
          <td class="paramname"><em>grad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a6decfabe26926dc3500fedbc77d16469">TgradR</a> &amp;&#160;</td>
          <td class="paramname"><em>mat_tensor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a6c08c1a7d5b0681c279753a51d9c1470">TrafoEvaluator</a> &amp;&#160;</td>
          <td class="paramname"><em>trafo_eval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#acfc7fca75e2c67410b614d47cd16af52">SpaceEvaluator</a> &amp;&#160;</td>
          <td class="paramname"><em>space_eval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a9a104ad968090323ac21dc7e7678dcd5">Tx</a> &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a8587f679534f6e8966a614764311a669">DataType</a> &amp;&#160;</td>
          <td class="paramname"><em>h</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the functional's value and gradient on one cell. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">fval</td><td>The functional value on this cell.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">grad</td><td>The contribution of this cell to the global gradient.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mat_tensor</td><td>The material function.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trafo_eval</td><td>Evaluator for the transformation.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">space_eval</td><td>Evaluator for the FE spaces.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>(number of vertices per cell) <img class="formulaInl light-mode-visible" alt="$ \times $" src="form_266.png"/><img class="formulaInl dark-mode-visible" alt="$ \times $" src="form_266_dark.png"/> (world_dim) - matrix that holds the local coordinates that define the cell <img class="formulaInl light-mode-visible" alt="$ K $" src="form_267.png"/><img class="formulaInl dark-mode-visible" alt="$ K $" src="form_267_dark.png"/>. These are the coefficients for the FE function representing the transformation.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>(world_dim) - vector that holds the dimensions of the target reference cell</td></tr>
  </table>
  </dd>
</dl>
<p>Computes the local functional value for one cell defined by the coordinates x with regard to the reference cell which depends on the shape type. </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a9ab188e1d1d0d6126eaaabd15cf396be" name="a9ab188e1d1d0d6126eaaabd15cf396be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ab188e1d1d0d6126eaaabd15cf396be">&#9670;&#160;</a></span>shape_dim</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType_ , typename TrafoType_ &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html">FEAT::Meshopt::RumpfFunctional</a>&lt; DataType_, TrafoType_ &gt;::shape_dim = shape_dim_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Our shape dimension. </p>

<p class="definition">Definition at line <a class="el" href="rumpf__functional_8hpp_source.html#l00197">197</a> of file <a class="el" href="rumpf__functional_8hpp_source.html">rumpf_functional.hpp</a>.</p>

</div>
</div>
<a id="aaa427ba78532c396a439baea8467e6ba" name="aaa427ba78532c396a439baea8467e6ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa427ba78532c396a439baea8467e6ba">&#9670;&#160;</a></span>space_config</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType_ , typename TrafoType_ &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr <a class="el" href="namespace_f_e_a_t.html#ad574925e947c823619c356d5d12b0815">SpaceTags</a> <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html">FEAT::Meshopt::RumpfFunctional</a>&lt; DataType_, TrafoType_ &gt;::space_config = <a class="el" href="namespace_f_e_a_t.html#ad574925e947c823619c356d5d12b0815ae28b67cfe4caf580ac626a141f19062a">SpaceTags::ref_grad</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>For the FE space, we only need the gradients on the reference cell. </p>

<p class="definition">Definition at line <a class="el" href="rumpf__functional_8hpp_source.html#l00223">223</a> of file <a class="el" href="rumpf__functional_8hpp_source.html">rumpf_functional.hpp</a>.</p>

</div>
</div>
<a id="aeb515f5238128e1c317fda1e933d65a0" name="aeb515f5238128e1c317fda1e933d65a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb515f5238128e1c317fda1e933d65a0">&#9670;&#160;</a></span>trafo_config</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType_ , typename TrafoType_ &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr <a class="el" href="namespace_f_e_a_t.html#aeeeaf7afcb3a42f69b57031db04b2428">TrafoTags</a> <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html">FEAT::Meshopt::RumpfFunctional</a>&lt; DataType_, TrafoType_ &gt;::trafo_config = <a class="el" href="namespace_f_e_a_t.html#aeeeaf7afcb3a42f69b57031db04b2428a2d68fb400ac4ae954f3e3120f03b17e3">TrafoTags::img_point</a> | <a class="el" href="namespace_f_e_a_t.html#aeeeaf7afcb3a42f69b57031db04b2428aaaff6440f63c38bcfdc6816c4d85411b">TrafoTags::jac_mat</a> | <a class="el" href="namespace_f_e_a_t.html#aeeeaf7afcb3a42f69b57031db04b2428abeec8d89f2e70c451ea6229f64290d74">TrafoTags::jac_det</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>We need the <a class="el" href="namespace_f_e_a_t_1_1_trafo.html" title="Transformation namespace.">Trafo</a> to evaluate the image point, the Jacobian and its determinant. </p>

<p class="definition">Definition at line <a class="el" href="rumpf__functional_8hpp_source.html#l00221">221</a> of file <a class="el" href="rumpf__functional_8hpp_source.html">rumpf_functional.hpp</a>.</p>

</div>
</div>
<a id="a8f808b7214b6a1cab135242dd3662a7c" name="a8f808b7214b6a1cab135242dd3662a7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f808b7214b6a1cab135242dd3662a7c">&#9670;&#160;</a></span>world_dim</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType_ , typename TrafoType_ &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html">FEAT::Meshopt::RumpfFunctional</a>&lt; DataType_, TrafoType_ &gt;::world_dim = <a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html#a9ab188e1d1d0d6126eaaabd15cf396be">shape_dim</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Our world dimension - only world_dim == shape_dim is supported. </p>

<p class="definition">Definition at line <a class="el" href="rumpf__functional_8hpp_source.html#l00199">199</a> of file <a class="el" href="rumpf__functional_8hpp_source.html">rumpf_functional.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>kernel/meshopt/<a class="el" href="rumpf__functional_8hpp_source.html">rumpf_functional.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_f_e_a_t.html">FEAT</a></li><li class="navelem"><a class="el" href="namespace_f_e_a_t_1_1_meshopt.html">Meshopt</a></li><li class="navelem"><a class="el" href="class_f_e_a_t_1_1_meshopt_1_1_rumpf_functional.html">RumpfFunctional</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>

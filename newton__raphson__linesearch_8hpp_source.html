<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FEAT: kernel/solver/newton_raphson_linesearch.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">FEAT<span id="projectnumber">&#160;3</span>
   </div>
   <div id="projectbrief">Finite Element Analysis Toolbox</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('newton__raphson__linesearch_8hpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">newton_raphson_linesearch.hpp</div></div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// FEAT3: Finite Element Analysis Toolbox, Version 3</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">// Copyright (C) 2010 by Stefan Turek &amp; the FEAT group</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">// FEAT3 is released under the GNU General Public License version 3,</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">// see the file &#39;copyright.txt&#39; in the top level directory for details.</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span> </div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#pragma once</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#include &lt;<a class="code" href="base__header_8hpp.html">kernel/base_header.hpp</a>&gt;</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#include &lt;kernel/solver/linesearch.hpp&gt;</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span> </div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_f_e_a_t.html">FEAT</a></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span>{</div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span>  <span class="keyword">namespace </span>Solver</div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span>  {</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Functional_, <span class="keyword">typename</span> Filter_&gt;</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html">   31</a></span>    <span class="keyword">class </span><a class="code hl_class" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html">NewtonRaphsonLinesearch</a> : <span class="keyword">public</span> <a class="code hl_class" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html">Linesearch</a>&lt;Functional_, Filter_&gt;</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>    {</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>      <span class="keyword">public</span>:</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a47dc82f4e577cc35b45ff83fa4d0f747">   35</a></span>        <span class="keyword">typedef</span> Filter_ <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a47dc82f4e577cc35b45ff83fa4d0f747">FilterType</a>;</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a0cf78aba96f42aaff45139a73eb393d5">   37</a></span>        <span class="keyword">typedef</span> <span class="keyword">typename</span> Functional_::VectorTypeR <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a0cf78aba96f42aaff45139a73eb393d5">VectorType</a>;</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#ab5db28a9edb4a4feacdd563d3608918c">   39</a></span>        <span class="keyword">typedef</span> <span class="keyword">typename</span> Functional_::DataType <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#ab5db28a9edb4a4feacdd563d3608918c">DataType</a>;</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#af79edb0c42bb9eb8cbded190aeeda6d2">   41</a></span>        <span class="keyword">typedef</span> <a class="code hl_class" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html">Linesearch&lt;Functional_, Filter_&gt;</a> <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#af79edb0c42bb9eb8cbded190aeeda6d2">BaseClass</a>;</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span> </div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>      <span class="keyword">public</span>:</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a1d5a356daafe717316ccaf4a6bdf0b6c">   57</a></span>        <span class="keyword">explicit</span> <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a1d5a356daafe717316ccaf4a6bdf0b6c">NewtonRaphsonLinesearch</a>(Functional_&amp; functional, Filter_&amp; filter, <span class="keywordtype">bool</span> keep_iterates = <span class="keyword">false</span>) :</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>          <a class="code hl_class" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html">BaseClass</a>(<span class="stringliteral">&quot;NR-LS&quot;</span>, functional, filter, keep_iterates)</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>          {</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>          }</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span> </div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a04ddafbe7b38ae13d68d9ca5de11048b">   80</a></span>        <span class="keyword">explicit</span> <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a04ddafbe7b38ae13d68d9ca5de11048b">NewtonRaphsonLinesearch</a>(<span class="keyword">const</span> <a class="code hl_class" href="class_f_e_a_t_1_1_string.html">String</a>&amp; section_name, <span class="keyword">const</span> <a class="code hl_class" href="class_f_e_a_t_1_1_property_map.html">PropertyMap</a>* section,</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>        Functional_&amp; functional, Filter_&amp; filter) :</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>          <a class="code hl_class" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html">BaseClass</a>(<span class="stringliteral">&quot;NR-LS&quot;</span>, section_name, section, functional, filter)</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>          {</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>          }</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span> </div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a95d7d2e1517efd2e4c3d1c2941649a2a">   87</a></span>        <span class="keyword">virtual</span> <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a95d7d2e1517efd2e4c3d1c2941649a2a">~NewtonRaphsonLinesearch</a>()</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>        {</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>        }</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span> </div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#ac02848dd60681bea54ded7b365d5d5f9">   92</a></span>        <span class="keyword">virtual</span> <a class="code hl_class" href="class_f_e_a_t_1_1_string.html">String</a> <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#ac02848dd60681bea54ded7b365d5d5f9">name</a>()<span class="keyword"> const override</span></div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span><span class="keyword">        </span>{</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>          <span class="keywordflow">return</span> <span class="stringliteral">&quot;Newton-Raphson-Linesearch&quot;</span>;</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>        }</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a619597726e49e1c4a0cc5db922b342ae">  108</a></span>        <span class="keyword">virtual</span> <a class="code hl_enumeration" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35ed">Status</a> <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a619597726e49e1c4a0cc5db922b342ae">apply</a>(<a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a0cf78aba96f42aaff45139a73eb393d5">VectorType</a>&amp; vec_cor, <span class="keyword">const</span> <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a0cf78aba96f42aaff45139a73eb393d5">VectorType</a>&amp; vec_dir)<span class="keyword"> override</span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span><span class="keyword">        </span>{</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>          <span class="comment">// clear solution vector</span></div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>          vec_cor.format();</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>          this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a1678798c09d463bd121bf52812719ba9">_functional</a>.prepare(vec_cor, this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac2ed9d06b8fc5632e175864d6b0aec6c">_filter</a>);</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span> </div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>          <span class="comment">// apply</span></div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>          this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#a575442c5edf8721e18db2a49717f45a5">_status</a> = <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#ac14d65cceebc2f527483c81b6f8c6a3f">_apply_intern</a>(vec_cor, vec_dir);</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>          this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#abb072260d9458116ae6aa240d5685fb3">plot_summary</a>();</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>          <span class="keywordflow">return</span> this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#a575442c5edf8721e18db2a49717f45a5">_status</a>;</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>        }</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span> </div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a3a018a9fb70c9a5cb45047206c5f4d06">  131</a></span>        <span class="keyword">virtual</span> <a class="code hl_enumeration" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35ed">Status</a> <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a3a018a9fb70c9a5cb45047206c5f4d06">correct</a>(<a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a0cf78aba96f42aaff45139a73eb393d5">VectorType</a>&amp; vec_sol, <span class="keyword">const</span> <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a0cf78aba96f42aaff45139a73eb393d5">VectorType</a>&amp; vec_dir)<span class="keyword"> override</span></div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span><span class="keyword">        </span>{</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>          this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a1678798c09d463bd121bf52812719ba9">_functional</a>.prepare(vec_sol, this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac2ed9d06b8fc5632e175864d6b0aec6c">_filter</a>);</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>          <span class="comment">// apply</span></div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>          this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#a575442c5edf8721e18db2a49717f45a5">_status</a> = <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#ac14d65cceebc2f527483c81b6f8c6a3f">_apply_intern</a>(vec_sol, vec_dir);</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>          this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#abb072260d9458116ae6aa240d5685fb3">plot_summary</a>();</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>          <span class="keywordflow">return</span> this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#a575442c5edf8721e18db2a49717f45a5">_status</a>;</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>        }</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span> </div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>      <span class="keyword">protected</span>:</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno"><a class="line" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#ac14d65cceebc2f527483c81b6f8c6a3f">  155</a></span>        <span class="keyword">virtual</span> <a class="code hl_enumeration" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35ed">Status</a> <a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#ac14d65cceebc2f527483c81b6f8c6a3f">_apply_intern</a>(<a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a0cf78aba96f42aaff45139a73eb393d5">VectorType</a>&amp; vec_sol, <span class="keyword">const</span> <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a0cf78aba96f42aaff45139a73eb393d5">VectorType</a>&amp; vec_dir)</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>        {</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>          Statistics::add_solver_expression(std::make_shared&lt;ExpressionStartSolve&gt;(this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#ac02848dd60681bea54ded7b365d5d5f9">name</a>()));</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span> </div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>          <span class="comment">// The step length wrt. to the NORMALISED search direction</span></div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>          DataType alpha(0);</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>          <span class="comment">// The functional value</span></div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#ab5db28a9edb4a4feacdd563d3608918c">DataType</a> fval(0);</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>          <a class="code hl_typedef" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#ab5db28a9edb4a4feacdd563d3608918c">DataType</a> df(0);</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span> </div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>          <span class="comment">// Perform initializations and checks</span></div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>          <a class="code hl_enumeration" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35ed">Status</a> st = this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a903b89f07e60974b07e6348291fc6741">_startup</a>(alpha, fval, df, vec_sol, vec_dir);</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>          <span class="comment">//  Because of the Newton-Raphson update x[k+1] = x[k] + alpha[k+1] d and alpha[k+1] = alpha[k] - &lt; g[k], d &gt; / &lt; d, H[k] d &gt;,</span></div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>          <span class="comment">// || d ||_2 does not matter and the relative update is invariant</span></div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span> </div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>          <span class="comment">// Compute new _alpha &lt;- _alpha - grad.dot(vec_dir) / vec_dir.dot(Hess*vec_dir)</span></div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>          this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a1678798c09d463bd121bf52812719ba9">_functional</a>.apply_hess(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ae856346c0f498690e441ceefe6edd212">_vec_tmp</a>, this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a92961d837ffc56d85cff3b820340eb2a">_vec_pn</a>);</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>          this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac2ed9d06b8fc5632e175864d6b0aec6c">_filter</a>.filter_def(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ae856346c0f498690e441ceefe6edd212">_vec_tmp</a>);</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span> </div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>          alpha = -this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a0d4201e4324ec13233def993318e44f2">_vec_grad</a>.dot(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a92961d837ffc56d85cff3b820340eb2a">_vec_pn</a>)/this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a92961d837ffc56d85cff3b820340eb2a">_vec_pn</a>.dot(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ae856346c0f498690e441ceefe6edd212">_vec_tmp</a>);</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span> </div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>          <span class="comment">// start iterating</span></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>          <span class="keywordflow">while</span>(st == <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35eda3c709b10a5d47ba33d85337dd9110917">Status::progress</a>)</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>          {</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>            <a class="code hl_class" href="class_f_e_a_t_1_1_solver_1_1_iteration_stats.html">IterationStats</a> stat(*<span class="keyword">this</span>);</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span> </div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>            <span class="comment">// Increase iteration count</span></div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>            ++this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#aa5524e82d3d153e57af1787421c0ec90">_num_iter</a>;</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span> </div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>            this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a1678798c09d463bd121bf52812719ba9">_functional</a>.prepare(vec_sol, this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac2ed9d06b8fc5632e175864d6b0aec6c">_filter</a>);</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>            this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a1678798c09d463bd121bf52812719ba9">_functional</a>.eval_fval_grad(fval, this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a0d4201e4324ec13233def993318e44f2">_vec_grad</a>);</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>            <span class="comment">// DO NOT call trim() here, as this simple linesearch accepts bad steps too, which would then be trimmed</span></div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>            <span class="comment">// and used.</span></div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>            <span class="comment">//this-&gt;trim_func_grad(fval);</span></div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>            this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac2ed9d06b8fc5632e175864d6b0aec6c">_filter</a>.filter_def(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a0d4201e4324ec13233def993318e44f2">_vec_grad</a>);</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span> </div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>            df = this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a92961d837ffc56d85cff3b820340eb2a">_vec_pn</a>.dot(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a0d4201e4324ec13233def993318e44f2">_vec_grad</a>);</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span> </div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>            <span class="keywordflow">if</span>(fval &lt;= this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#aab60dec26fb66c0cd2faeac189467f8f">_fval_min</a>)</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>            {</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>              this-&gt;_fval_min = fval;</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>              this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ad8716d5245471de11330a2f693d6f4f2">_alpha_min</a> = alpha;</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>            }</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span> </div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>            st = this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#aeb397e3e98d6e2edb5e4ee5cb8f73082">_check_convergence</a>(fval, df, alpha);</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span> </div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>            <span class="keywordflow">if</span>(st != <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35eda3c709b10a5d47ba33d85337dd9110917">Status::progress</a>)</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>            {</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>            }</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span> </div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>            <span class="comment">// Compute new _alpha &lt;- _alpha - grad.dot(this-&gt;_vec_pn) / this-&gt;_vec_pn.dot(Hess*this-&gt;_vec_pn)</span></div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>            this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a1678798c09d463bd121bf52812719ba9">_functional</a>.apply_hess(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ae856346c0f498690e441ceefe6edd212">_vec_tmp</a>, this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a92961d837ffc56d85cff3b820340eb2a">_vec_pn</a>);</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>            this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac2ed9d06b8fc5632e175864d6b0aec6c">_filter</a>.filter_def(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ae856346c0f498690e441ceefe6edd212">_vec_tmp</a>);</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span> </div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>            alpha -= this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a0d4201e4324ec13233def993318e44f2">_vec_grad</a>.dot(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a92961d837ffc56d85cff3b820340eb2a">_vec_pn</a>)/this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a92961d837ffc56d85cff3b820340eb2a">_vec_pn</a>.dot(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ae856346c0f498690e441ceefe6edd212">_vec_tmp</a>);</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span> </div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>            <span class="comment">// Update solution</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>            vec_sol.copy(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a27ba39cc738b9a4fa6208feb779ca42d">_vec_initial_sol</a>);</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>            vec_sol.axpy(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a92961d837ffc56d85cff3b820340eb2a">_vec_pn</a>, alpha);</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span> </div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>          }</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span> </div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>          <span class="comment">// If we are not successful, we update the best step length and need to re-evaluate everything for that</span></div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>          <span class="comment">// step</span></div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>          <span class="keywordflow">if</span>(st != <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35eda260ca9dd8a4577fc00b7bd5810298076">Status::success</a>)</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>          {</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>            vec_sol.copy(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a27ba39cc738b9a4fa6208feb779ca42d">_vec_initial_sol</a>);</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>            vec_sol.axpy(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a92961d837ffc56d85cff3b820340eb2a">_vec_pn</a>, this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ad8716d5245471de11330a2f693d6f4f2">_alpha_min</a>);</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span> </div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>            <span class="comment">// Prepare and evaluate</span></div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>            this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a1678798c09d463bd121bf52812719ba9">_functional</a>.prepare(vec_sol, this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac2ed9d06b8fc5632e175864d6b0aec6c">_filter</a>);</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>            this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a1678798c09d463bd121bf52812719ba9">_functional</a>.eval_fval_grad(fval, this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a0d4201e4324ec13233def993318e44f2">_vec_grad</a>);</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>            <span class="comment">// DO NOT call trim() here, as this simple linesearch accepts bad steps too, which would then be trimmed</span></div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>            <span class="comment">// and used.</span></div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>            this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a4274068c4e97f9636c48f4c932bfe7b1">trim_func_grad</a>(fval);</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>            this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac2ed9d06b8fc5632e175864d6b0aec6c">_filter</a>.filter_def(this-&gt;<a class="code hl_variable" href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a0d4201e4324ec13233def993318e44f2">_vec_grad</a>);</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>          }</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span> </div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>          Statistics::add_solver_expression(std::make_shared&lt;ExpressionEndSolve&gt;(this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#ac02848dd60681bea54ded7b365d5d5f9">name</a>(), <a class="code hl_enumvalue" href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35eda5e543256c480ac577d30f76f9120eb74">Status::undefined</a>, this-&gt;<a class="code hl_function" href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#a4d6b6c7809c161f59cbaf7cb01149178">get_num_iter</a>()));</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>          <span class="keywordflow">return</span> st;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>        }</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span> </div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    }; <span class="comment">// class NewtonRaphsonLinesearch</span></div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span> </div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Functional_, <span class="keyword">typename</span> Filter_&gt;</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno"><a class="line" href="namespace_f_e_a_t_1_1_solver.html#a5986f726755329cf6107b63294902fb3">  257</a></span>    <span class="keyword">inline</span> std::shared_ptr&lt;NewtonRaphsonLinesearch&lt;Functional_, Filter_&gt;&gt; <a class="code hl_function" href="namespace_f_e_a_t_1_1_solver.html#a5986f726755329cf6107b63294902fb3">new_newton_raphson_linesearch</a>(</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>      Functional_&amp; functional, Filter_&amp; filter, <span class="keywordtype">bool</span> keep_iterates = <span class="keyword">false</span>)</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>      {</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>        <span class="keywordflow">return</span> std::make_shared&lt;NewtonRaphsonLinesearch&lt;Functional_, Filter_&gt;&gt;(functional, filter, keep_iterates);</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>      }</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span> </div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Functional_, <span class="keyword">typename</span> Filter_&gt;</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno"><a class="line" href="namespace_f_e_a_t_1_1_solver.html#adc5c4135af54910b4d4229b8be795210">  282</a></span>    <span class="keyword">inline</span> std::shared_ptr&lt;NewtonRaphsonLinesearch&lt;Functional_, Filter_&gt;&gt; <a class="code hl_function" href="namespace_f_e_a_t_1_1_solver.html#a5986f726755329cf6107b63294902fb3">new_newton_raphson_linesearch</a>(</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>      <span class="keyword">const</span> <a class="code hl_class" href="class_f_e_a_t_1_1_string.html">String</a>&amp; section_name, <span class="keyword">const</span> <a class="code hl_class" href="class_f_e_a_t_1_1_property_map.html">PropertyMap</a>* section,</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>      Functional_&amp; functional, Filter_&amp; filter)</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>      {</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>        <span class="keywordflow">return</span> std::make_shared&lt;NewtonRaphsonLinesearch&lt;Functional_, Filter_&gt;&gt;(section_name, section, functional, filter);</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>      }</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>  } <span class="comment">// namespace Solver</span></div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>} <span class="comment">// namespace FEAT</span></div>
<div class="ttc" id="abase__header_8hpp_html"><div class="ttname"><a href="base__header_8hpp.html">base_header.hpp</a></div><div class="ttdoc">FEAT Kernel base header.</div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_property_map_html"><div class="ttname"><a href="class_f_e_a_t_1_1_property_map.html">FEAT::PropertyMap</a></div><div class="ttdoc">A class organizing a tree of key-value pairs.</div><div class="ttdef"><b>Definition:</b> <a href="property__map_8hpp_source.html#l00047">property_map.hpp:48</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_iteration_stats_html"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_iteration_stats.html">FEAT::Solver::IterationStats</a></div><div class="ttdoc">Helper class for iteration statistics collection.</div><div class="ttdef"><b>Definition:</b> <a href="kernel_2solver_2base_8hpp_source.html#l00391">base.hpp:392</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_iterative_solver_html_a4d6b6c7809c161f59cbaf7cb01149178"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#a4d6b6c7809c161f59cbaf7cb01149178">FEAT::Solver::IterativeSolver&lt; Functional_::VectorTypeR &gt;::get_num_iter</a></div><div class="ttdeci">Index get_num_iter() const</div><div class="ttdoc">Returns number of performed iterations.</div><div class="ttdef"><b>Definition:</b> <a href="iterative_8hpp_source.html#l00462">iterative.hpp:462</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_iterative_solver_html_a575442c5edf8721e18db2a49717f45a5"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#a575442c5edf8721e18db2a49717f45a5">FEAT::Solver::IterativeSolver&lt; Functional_::VectorTypeR &gt;::_status</a></div><div class="ttdeci">Status _status</div><div class="ttdoc">current status of the solver</div><div class="ttdef"><b>Definition:</b> <a href="iterative_8hpp_source.html#l00213">iterative.hpp:213</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_iterative_solver_html_aa5524e82d3d153e57af1787421c0ec90"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#aa5524e82d3d153e57af1787421c0ec90">FEAT::Solver::IterativeSolver&lt; Functional_::VectorTypeR &gt;::_num_iter</a></div><div class="ttdeci">Index _num_iter</div><div class="ttdoc">number of performed iterations</div><div class="ttdef"><b>Definition:</b> <a href="iterative_8hpp_source.html#l00231">iterative.hpp:231</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_iterative_solver_html_abb072260d9458116ae6aa240d5685fb3"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_iterative_solver.html#abb072260d9458116ae6aa240d5685fb3">FEAT::Solver::IterativeSolver&lt; Functional_::VectorTypeR &gt;::plot_summary</a></div><div class="ttdeci">virtual void plot_summary() const</div><div class="ttdoc">Plot a summary of the last solver run.</div><div class="ttdef"><b>Definition:</b> <a href="iterative_8hpp_source.html#l00627">iterative.hpp:627</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html">FEAT::Solver::Linesearch</a></div><div class="ttdoc">Linesearch base class.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00033">linesearch.hpp:34</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_a0d4201e4324ec13233def993318e44f2"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a0d4201e4324ec13233def993318e44f2">FEAT::Solver::Linesearch::_vec_grad</a></div><div class="ttdeci">VectorType _vec_grad</div><div class="ttdoc">Gradient vector.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00053">linesearch.hpp:53</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_a1678798c09d463bd121bf52812719ba9"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a1678798c09d463bd121bf52812719ba9">FEAT::Solver::Linesearch::_functional</a></div><div class="ttdeci">Functional_ &amp; _functional</div><div class="ttdoc">The (nonlinear) functional.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00048">linesearch.hpp:48</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_a27ba39cc738b9a4fa6208feb779ca42d"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a27ba39cc738b9a4fa6208feb779ca42d">FEAT::Solver::Linesearch::_vec_initial_sol</a></div><div class="ttdeci">VectorType _vec_initial_sol</div><div class="ttdoc">Initial solution.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00055">linesearch.hpp:55</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_a4274068c4e97f9636c48f4c932bfe7b1"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a4274068c4e97f9636c48f4c932bfe7b1">FEAT::Solver::Linesearch::trim_func_grad</a></div><div class="ttdeci">virtual void trim_func_grad(DataType &amp;func)</div><div class="ttdoc">Trims the function value and gradient according to some threshold.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00430">linesearch.hpp:430</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_a903b89f07e60974b07e6348291fc6741"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a903b89f07e60974b07e6348291fc6741">FEAT::Solver::Linesearch::_startup</a></div><div class="ttdeci">virtual Status _startup(DataType &amp;alpha, DataType &amp;fval, DataType &amp;delta, const VectorType &amp;vec_sol, const VectorType &amp;vec_dir)</div><div class="ttdoc">Performs the startup of the iteration.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00464">linesearch.hpp:464</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_a92961d837ffc56d85cff3b820340eb2a"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#a92961d837ffc56d85cff3b820340eb2a">FEAT::Solver::Linesearch::_vec_pn</a></div><div class="ttdeci">VectorType _vec_pn</div><div class="ttdoc">descend direction vector, normalized for better numerical stability</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00059">linesearch.hpp:59</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_aab60dec26fb66c0cd2faeac189467f8f"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#aab60dec26fb66c0cd2faeac189467f8f">FEAT::Solver::Linesearch::_fval_min</a></div><div class="ttdeci">DataType _fval_min</div><div class="ttdoc">Functional functional value.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00062">linesearch.hpp:62</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_ac2ed9d06b8fc5632e175864d6b0aec6c"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ac2ed9d06b8fc5632e175864d6b0aec6c">FEAT::Solver::Linesearch::_filter</a></div><div class="ttdeci">Filter_ &amp; _filter</div><div class="ttdoc">The filter to be applied to the functional's gradient.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00050">linesearch.hpp:50</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_ad8716d5245471de11330a2f693d6f4f2"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ad8716d5245471de11330a2f693d6f4f2">FEAT::Solver::Linesearch::_alpha_min</a></div><div class="ttdeci">DataType _alpha_min</div><div class="ttdoc">Line search parameter.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00071">linesearch.hpp:71</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_ae856346c0f498690e441ceefe6edd212"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#ae856346c0f498690e441ceefe6edd212">FEAT::Solver::Linesearch::_vec_tmp</a></div><div class="ttdeci">VectorType _vec_tmp</div><div class="ttdoc">temporary vector</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00057">linesearch.hpp:57</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_linesearch_html_aeb397e3e98d6e2edb5e4ee5cb8f73082"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_linesearch.html#aeb397e3e98d6e2edb5e4ee5cb8f73082">FEAT::Solver::Linesearch::_check_convergence</a></div><div class="ttdeci">virtual Status _check_convergence(const DataType fval, const DataType df, const DataType alpha)</div><div class="ttdoc">Performs the line search convergence checks using the strong Wolfe conditions.</div><div class="ttdef"><b>Definition:</b> <a href="linesearch_8hpp_source.html#l00543">linesearch.hpp:543</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch_html"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html">FEAT::Solver::NewtonRaphsonLinesearch</a></div><div class="ttdoc">Newton Raphson linesearch.</div><div class="ttdef"><b>Definition:</b> <a href="newton__raphson__linesearch_8hpp_source.html#l00031">newton_raphson_linesearch.hpp:32</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch_html_a04ddafbe7b38ae13d68d9ca5de11048b"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a04ddafbe7b38ae13d68d9ca5de11048b">FEAT::Solver::NewtonRaphsonLinesearch::NewtonRaphsonLinesearch</a></div><div class="ttdeci">NewtonRaphsonLinesearch(const String &amp;section_name, const PropertyMap *section, Functional_ &amp;functional, Filter_ &amp;filter)</div><div class="ttdoc">Constructor using a PropertyMap.</div><div class="ttdef"><b>Definition:</b> <a href="newton__raphson__linesearch_8hpp_source.html#l00080">newton_raphson_linesearch.hpp:80</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch_html_a0cf78aba96f42aaff45139a73eb393d5"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a0cf78aba96f42aaff45139a73eb393d5">FEAT::Solver::NewtonRaphsonLinesearch::VectorType</a></div><div class="ttdeci">Functional_::VectorTypeR VectorType</div><div class="ttdoc">Input vector type for the functional's gradient.</div><div class="ttdef"><b>Definition:</b> <a href="newton__raphson__linesearch_8hpp_source.html#l00037">newton_raphson_linesearch.hpp:37</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch_html_a1d5a356daafe717316ccaf4a6bdf0b6c"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a1d5a356daafe717316ccaf4a6bdf0b6c">FEAT::Solver::NewtonRaphsonLinesearch::NewtonRaphsonLinesearch</a></div><div class="ttdeci">NewtonRaphsonLinesearch(Functional_ &amp;functional, Filter_ &amp;filter, bool keep_iterates=false)</div><div class="ttdoc">Standard constructor.</div><div class="ttdef"><b>Definition:</b> <a href="newton__raphson__linesearch_8hpp_source.html#l00057">newton_raphson_linesearch.hpp:57</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch_html_a3a018a9fb70c9a5cb45047206c5f4d06"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a3a018a9fb70c9a5cb45047206c5f4d06">FEAT::Solver::NewtonRaphsonLinesearch::correct</a></div><div class="ttdeci">virtual Status correct(VectorType &amp;vec_sol, const VectorType &amp;vec_dir) override</div><div class="ttdoc">Applies the solver, making use of an initial guess.</div><div class="ttdef"><b>Definition:</b> <a href="newton__raphson__linesearch_8hpp_source.html#l00131">newton_raphson_linesearch.hpp:131</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch_html_a47dc82f4e577cc35b45ff83fa4d0f747"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a47dc82f4e577cc35b45ff83fa4d0f747">FEAT::Solver::NewtonRaphsonLinesearch::FilterType</a></div><div class="ttdeci">Filter_ FilterType</div><div class="ttdoc">Filter type to be applied to the gradient of the functional.</div><div class="ttdef"><b>Definition:</b> <a href="newton__raphson__linesearch_8hpp_source.html#l00035">newton_raphson_linesearch.hpp:35</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch_html_a619597726e49e1c4a0cc5db922b342ae"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a619597726e49e1c4a0cc5db922b342ae">FEAT::Solver::NewtonRaphsonLinesearch::apply</a></div><div class="ttdeci">virtual Status apply(VectorType &amp;vec_cor, const VectorType &amp;vec_dir) override</div><div class="ttdoc">Applies the solver, setting the initial guess to zero.</div><div class="ttdef"><b>Definition:</b> <a href="newton__raphson__linesearch_8hpp_source.html#l00108">newton_raphson_linesearch.hpp:108</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch_html_a95d7d2e1517efd2e4c3d1c2941649a2a"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#a95d7d2e1517efd2e4c3d1c2941649a2a">FEAT::Solver::NewtonRaphsonLinesearch::~NewtonRaphsonLinesearch</a></div><div class="ttdeci">virtual ~NewtonRaphsonLinesearch()</div><div class="ttdef"><b>Definition:</b> <a href="newton__raphson__linesearch_8hpp_source.html#l00087">newton_raphson_linesearch.hpp:87</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch_html_ab5db28a9edb4a4feacdd563d3608918c"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#ab5db28a9edb4a4feacdd563d3608918c">FEAT::Solver::NewtonRaphsonLinesearch::DataType</a></div><div class="ttdeci">Functional_::DataType DataType</div><div class="ttdoc">Underlying floating point type.</div><div class="ttdef"><b>Definition:</b> <a href="newton__raphson__linesearch_8hpp_source.html#l00039">newton_raphson_linesearch.hpp:39</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch_html_ac02848dd60681bea54ded7b365d5d5f9"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#ac02848dd60681bea54ded7b365d5d5f9">FEAT::Solver::NewtonRaphsonLinesearch::name</a></div><div class="ttdeci">virtual String name() const override</div><div class="ttdoc">Returns a descriptive string.</div><div class="ttdef"><b>Definition:</b> <a href="newton__raphson__linesearch_8hpp_source.html#l00092">newton_raphson_linesearch.hpp:92</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch_html_ac14d65cceebc2f527483c81b6f8c6a3f"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#ac14d65cceebc2f527483c81b6f8c6a3f">FEAT::Solver::NewtonRaphsonLinesearch::_apply_intern</a></div><div class="ttdeci">virtual Status _apply_intern(VectorType &amp;vec_sol, const VectorType &amp;vec_dir)</div><div class="ttdoc">Internal function: Applies the solver.</div><div class="ttdef"><b>Definition:</b> <a href="newton__raphson__linesearch_8hpp_source.html#l00155">newton_raphson_linesearch.hpp:155</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch_html_af79edb0c42bb9eb8cbded190aeeda6d2"><div class="ttname"><a href="class_f_e_a_t_1_1_solver_1_1_newton_raphson_linesearch.html#af79edb0c42bb9eb8cbded190aeeda6d2">FEAT::Solver::NewtonRaphsonLinesearch::BaseClass</a></div><div class="ttdeci">Linesearch&lt; Functional_, Filter_ &gt; BaseClass</div><div class="ttdoc">Our base class.</div><div class="ttdef"><b>Definition:</b> <a href="newton__raphson__linesearch_8hpp_source.html#l00041">newton_raphson_linesearch.hpp:41</a></div></div>
<div class="ttc" id="aclass_f_e_a_t_1_1_string_html"><div class="ttname"><a href="class_f_e_a_t_1_1_string.html">FEAT::String</a></div><div class="ttdoc">String class implementation.</div><div class="ttdef"><b>Definition:</b> <a href="string_8hpp_source.html#l00044">string.hpp:46</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_solver_html_a5986f726755329cf6107b63294902fb3"><div class="ttname"><a href="namespace_f_e_a_t_1_1_solver.html#a5986f726755329cf6107b63294902fb3">FEAT::Solver::new_newton_raphson_linesearch</a></div><div class="ttdeci">std::shared_ptr&lt; NewtonRaphsonLinesearch&lt; Functional_, Filter_ &gt; &gt; new_newton_raphson_linesearch(Functional_ &amp;functional, Filter_ &amp;filter, bool keep_iterates=false)</div><div class="ttdoc">Creates a new NewtonRaphsonLinesearch object.</div><div class="ttdef"><b>Definition:</b> <a href="newton__raphson__linesearch_8hpp_source.html#l00257">newton_raphson_linesearch.hpp:257</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_solver_html_ab1c941bc4fb3a678ef08e84cd3fa35ed"><div class="ttname"><a href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35ed">FEAT::Solver::Status</a></div><div class="ttdeci">Status</div><div class="ttdoc">Solver status return codes enumeration.</div><div class="ttdef"><b>Definition:</b> <a href="kernel_2solver_2base_8hpp_source.html#l00046">base.hpp:47</a></div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_solver_html_ab1c941bc4fb3a678ef08e84cd3fa35eda260ca9dd8a4577fc00b7bd5810298076"><div class="ttname"><a href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35eda260ca9dd8a4577fc00b7bd5810298076">FEAT::Solver::Status::success</a></div><div class="ttdeci">@ success</div><div class="ttdoc">solving successful (convergence criterion fulfilled)</div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_solver_html_ab1c941bc4fb3a678ef08e84cd3fa35eda3c709b10a5d47ba33d85337dd9110917"><div class="ttname"><a href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35eda3c709b10a5d47ba33d85337dd9110917">FEAT::Solver::Status::progress</a></div><div class="ttdeci">@ progress</div><div class="ttdoc">continue iteration (internal use only)</div></div>
<div class="ttc" id="anamespace_f_e_a_t_1_1_solver_html_ab1c941bc4fb3a678ef08e84cd3fa35eda5e543256c480ac577d30f76f9120eb74"><div class="ttname"><a href="namespace_f_e_a_t_1_1_solver.html#ab1c941bc4fb3a678ef08e84cd3fa35eda5e543256c480ac577d30f76f9120eb74">FEAT::Solver::Status::undefined</a></div><div class="ttdeci">@ undefined</div><div class="ttdoc">undefined status</div></div>
<div class="ttc" id="anamespace_f_e_a_t_html"><div class="ttname"><a href="namespace_f_e_a_t.html">FEAT</a></div><div class="ttdoc">FEAT namespace.</div><div class="ttdef"><b>Definition:</b> <a href="adjactor_8hpp_source.html#l00011">adjactor.hpp:12</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_dc43877d82dd332f9fb2071fcca799d6.html">kernel</a></li><li class="navelem"><a class="el" href="dir_58759e03702cf5d3134868f6de633189.html">solver</a></li><li class="navelem"><b>newton_raphson_linesearch.hpp</b></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FEAT: Algebraic Multigrid</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">FEAT<span id="projectnumber">&#160;3</span>
   </div>
   <div id="projectbrief">Finite Element Analysis Toolbox</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('amg.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Algebraic Multigrid </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="amg_introduction"></a>
AMG Introduction</h1>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000059">Todo:</a></b></dt><dd>verbose description</dd></dl>
<ul>
<li>parallel coarse grid solver</li>
<li>various submethods possible</li>
<li>only rudimentary optimization on numerical and executing performance</li>
</ul>
<h1><a class="anchor" id="amg_integration"></a>
Integrating AMG in your application</h1>
<p >As FEAT3 is initially centered on geometric multigrids and thus asumes an existing grid hierarchy, the application has to inject the algebraically generated levels into the given hierarchy.</p>
<p >Obviously, one needs to assemble, at least, the finest level(s) first, before one can generate coarser levels with the AMGFactory. The common use case is to have a complete hierarchy of geometrically created grids and then to add some coarser levels between them.</p>
<p >Let's say we have a given level hierarchy and want to add some coarser levels, until the ranks have in average less than 16 rows on the most coarse level. The following code snippet uses the types and objects from the poisson_dirichlet.cpp application. Note that the transfer object always resides on the fine level of the two affected levels; thus the transfer object of the previous level has to be provided. </p><div class="fragment"><div class="line"> </div>
<div class="line">   <a class="code hl_define" href="assertion_8hpp.html#af5c647b0786db55f57452bfc26726bde">XASSERT</a>(system_levels.size() &gt; 0);</div>
<div class="line">   <span class="keywordflow">while</span> (system_levels.back()-&gt;matrix_sys.rows() / (Index)comm.size() &gt; 16)</div>
<div class="line">   {</div>
<div class="line">     system_levels.push_back(std::make_shared&lt;SystemLevelType&gt;());</div>
<div class="line">     <span class="keyword">auto</span>&amp; previous_level = system_levels[system_levels.size() - 2];</div>
<div class="line">     Solver::AMGFactory&lt;typename SystemLevelType::GlobalSystemMatrix, typename SystemLevelType::GlobalSystemFilter, typename SystemLevelType::GlobalSystemTransfer&gt;</div>
<div class="line">       ::new_coarse_level(previous_level-&gt;matrix_sys, previous_level-&gt;filter_sys, 0.8,</div>
<div class="line">         system_levels.back()-&gt;matrix_sys, system_levels.back()-&gt;filter_sys, previous_level-&gt;transfer_sys, &amp;comm, &amp;system_levels.back()-&gt;gate_sys);</div>
<div class="line">   }</div>
<div class="ttc" id="aassertion_8hpp_html_af5c647b0786db55f57452bfc26726bde"><div class="ttname"><a href="assertion_8hpp.html#af5c647b0786db55f57452bfc26726bde">XASSERT</a></div><div class="ttdeci">#define XASSERT(expr)</div><div class="ttdoc">Assertion macro definition.</div><div class="ttdef"><b>Definition:</b> <a href="assertion_8hpp_source.html#l00183">assertion.hpp:183</a></div></div>
</div><!-- fragment --><p >If your application has created some algebraic levels once and needs to update the numerical values of the matrices, it is possible to only update the numerical values of the coarser matrices and to skip the coupling/interpolation steps. This can greatly speed up the update, but may result in suboptimal transfer operations, if the non zero entries of the first system matrix and the follow up matrices differ to much. </p><div class="fragment"><div class="line">Solver::AMGFactory&lt;typename SystemLevelType::GlobalSystemMatrix, typename SystemLevelType::GlobalSystemFilter, typename SystemLevelType::GlobalSystemTransfer&gt;</div>
<div class="line">  ::update_coarse_level(system_levels[system_levels.size() - 2]-&gt;matrix_sys, system_levels[system_levels.size() - 2]-&gt;transfer_sys,</div>
<div class="line">      system_levels[system_levels.size() - 1]-&gt;matrix_sys);</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
